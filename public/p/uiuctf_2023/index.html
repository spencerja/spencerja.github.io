<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="Participated in UIUCTF 2023, from July 1 to July 3. The team placed 124th and in a combined effort cleared the entire OSINT category!">
<title>UIUCTF_2023</title>

<link rel='canonical' href='http://localhost:1313/p/uiuctf_2023/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="UIUCTF_2023">
<meta property='og:description' content="Participated in UIUCTF 2023, from July 1 to July 3. The team placed 124th and in a combined effort cleared the entire OSINT category!">
<meta property='og:url' content='http://localhost:1313/p/uiuctf_2023/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Misc' /><meta property='article:tag' content='OSINT' /><meta property='article:published_time' content='2023-07-03T11:37:04-05:00'/><meta property='article:modified_time' content='2023-07-03T11:37:04-05:00'/>
<meta name="twitter:title" content="UIUCTF_2023">
<meta name="twitter:description" content="Participated in UIUCTF 2023, from July 1 to July 3. The team placed 124th and in a combined effort cleared the entire OSINT category!">
    <link rel="shortcut icon" href="/favicon.png" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu897059592634026878.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/CaiJimmy/hugo-theme-stack'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#misc">Misc</a>
      <ol>
        <li><a href="#corny-kernel">Corny Kernel</a></li>
        <li><a href="#vimjail1">vimjail1</a></li>
        <li><a href="#vimjail2">vimjail2</a></li>
      </ol>
    </li>
    <li><a href="#osint">OSINT</a>
      <ol>
        <li><a href="#whats-for-dinner">What&rsquo;s for Dinner?</a></li>
        <li><a href="#finding-jonah">Finding Jonah?</a></li>
        <li><a href="#jonahs-journal">Jonah&rsquo;s Journal</a></li>
        <li><a href="#first-class-mail">First class mail</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/uiuctf_2023/">UIUCTF_2023</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Participated in UIUCTF 2023, from July 1 to July 3. The team placed 124th and in a combined effort cleared the entire OSINT category!
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jul 03, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    7 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="misc">Misc
</h2><h3 id="corny-kernel">Corny Kernel
</h3><blockquote>
<p>Use our corny little driver to mess with the Linux kernel at runtime!</p>
</blockquote>
<hr>
<p>Checking the attached file:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="c1">// SPDX-License-Identifier: GPL-2.0-only  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  
</span></span><span class="line"><span class="cl"><span class="cp">#define pr_fmt(fmt) KBUILD_MODNAME &#34;: &#34; fmt  
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  
</span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/module.h&gt;  </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/init.h&gt;  </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/kernel.h&gt;  </span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>  
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">flag1</span><span class="p">,</span> <span class="o">*</span><span class="n">flag2</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">int</span> <span class="n">__init</span> <span class="nf">pwny_init</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">¬†¬†¬†¬†¬†¬†¬†<span class="nf">pr_alert</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">flag1</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">¬†¬†¬†¬†¬†¬†¬†<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="k">static</span> <span class="kt">void</span> <span class="n">__exit</span> <span class="nf">pwny_exit</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>  
</span></span><span class="line"><span class="cl"><span class="p">{</span>  
</span></span><span class="line"><span class="cl">¬†¬†¬†¬†¬†¬†¬†<span class="nf">pr_info</span><span class="p">(</span><span class="s">&#34;%s</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">,</span> <span class="n">flag2</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="p">}</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="nf">module_init</span><span class="p">(</span><span class="n">pwny_init</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="nf">module_exit</span><span class="p">(</span><span class="n">pwny_exit</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="nf">MODULE_AUTHOR</span><span class="p">(</span><span class="s">&#34;Nitya&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="nf">MODULE_DESCRIPTION</span><span class="p">(</span><span class="s">&#34;UIUCTF23&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="nf">MODULE_LICENSE</span><span class="p">(</span><span class="s">&#34;GPL&#34;</span><span class="p">);</span>  
</span></span><span class="line"><span class="cl"><span class="nf">MODULE_VERSION</span><span class="p">(</span><span class="s">&#34;0.1&#34;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see this module produces two flag parts, <code>flag1</code> and <code>flag2</code>. One at init and one at exit. Entering the challenge terminal:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ socat file:<span class="k">$(</span>tty<span class="k">)</span>,raw,echo<span class="o">=</span><span class="m">0</span> tcp:corny-kernel.chal.uiuc.tf:1337  
</span></span><span class="line"><span class="cl"><span class="o">==</span> proof-of-work: <span class="nv">disabled</span> <span class="o">==</span>  
</span></span><span class="line"><span class="cl">¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†¬†+ mount -n -t proc -o nosuid,noexec,nodev proc /proc/  
</span></span><span class="line"><span class="cl">+ mkdir -p /dev /sys /etc  
</span></span><span class="line"><span class="cl">+ mount -n -t devtmpfs -o <span class="s1">&#39;mode=0755,nosuid,noexec&#39;</span> devtmpfs /dev  
</span></span><span class="line"><span class="cl">+ mount -n -t sysfs -o nosuid,noexec,nodev sys /sys  
</span></span><span class="line"><span class="cl">+ <span class="nb">cd</span> /root  
</span></span><span class="line"><span class="cl">+ <span class="nb">exec</span> setsid cttyhack ash -l  
</span></span><span class="line"><span class="cl">/root <span class="c1"># ls  </span>
</span></span><span class="line"><span class="cl">pwnymodule.ko.gz  
</span></span><span class="line"><span class="cl">/root <span class="c1">#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We find a <code>gzip</code> file in cwd. Interestingly, <code>file</code> is not on this system but it is an irrelevant check. When we unzip we are left with <a class="link" href="https://fileinfo.com/extension/ko"  target="_blank" rel="noopener"
    >.ko file, which is a kernel object.</a> We can interact with this using <code>modprobe</code> or <code>insmod</code>.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/root <span class="c1"># insmod pwnymodule.ko</span>
</span></span><span class="line"><span class="cl"><span class="o">[</span>   10.571676<span class="o">]</span> pwnymodule: uiuctf<span class="o">{</span>m4ster_
</span></span><span class="line"><span class="cl">/root <span class="c1"># rmmod pwnymodule.ko</span>
</span></span><span class="line"><span class="cl">/root <span class="c1">#</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Upon installing the module we see the first half of the flag. This makes sense considering <code>module_init</code> will produce the flag1 according to our source code. I thought that using <code>rmmod</code> to uninstall would produce the second half of the flag, but it did not go to terminal output.</p>
<p>Eventually I think to check <code>dmesg</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/root # dmesg
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">[   10.571676] pwnymodule: uiuctf{m4ster_
</span></span><span class="line"><span class="cl">[  112.877984] pwnymodule: k3rNE1_haCk3r}
</span></span></code></pre></td></tr></table>
</div>
</div><p>The difference seems to be primarily in that flag1 is produced with <code>pr_alert()</code> while flag2 is produced with <code>pr_info()</code>. Alert goes to stdout, while info goes to logs, perhaps?</p>
<p><code>uiuctf{m4ster_k3rNE1_haCk3r}</code></p>
<h3 id="vimjail1">vimjail1
</h3><blockquote>
<p>Connect with <code>socat file:$(tty),raw,echo=0 tcp:vimjail1.chal.uiuc.tf:1337</code>. You may need to install socat</p>
</blockquote>
<hr>
<p>Checking the vimrc:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ cat vimrc ¬†  
</span></span><span class="line"><span class="cl"><span class="nb">set</span> nocompatible  
</span></span><span class="line"><span class="cl"><span class="nb">set</span> insertmode  
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">inoremap &lt;c-o&gt; nope  
</span></span><span class="line"><span class="cl">inoremap &lt;c-l&gt; nope  
</span></span><span class="line"><span class="cl">inoremap &lt;c-z&gt; nope  
</span></span><span class="line"><span class="cl">inoremap &lt;c-<span class="se">\&gt;</span>&lt;c-n&gt; nope
</span></span></code></pre></td></tr></table>
</div>
</div><p>we can see the default is set to insert mode over normal mode. Additionally, several common escape keystrokes have been remapped to &ldquo;nope&rdquo;. However, looking carefully shows a small mistake. <code>&lt;c-\&gt;&lt;c-n&gt;</code> has been mapped to &ldquo;nope&rdquo;, but these keystrokes individually have not. And so, we can still use <code>&lt;c-\&gt;</code> to escape.</p>
<p>Using <code>&lt;c-\&gt;</code> followed by <code>&lt;c-n&gt;</code>, we see insert mode has changed and we are able to supply <code>:</code> commands. Trying :shell,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Shell commands and some functionality not allowed in rvim
</span></span></code></pre></td></tr></table>
</div>
</div><p>It looks like we cannot enter a regular shell being in rvim.. perhaps we can open a file named <code>flag.txt</code>?</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">uiuctf{n0_3sc4p3_f0r_y0u_8613a322d0eb0628}
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is worth noting that if you input <code>&lt;c-\&gt;</code> followed by <code>&lt;c-n&gt;</code> too quickly, then you still get an error. There must be a somewhat large delay for this to work.</p>
<h3 id="vimjail2">vimjail2
</h3><blockquote>
<p>Connect with <code>socat file:$(tty),raw,echo=0 tcp:vimjail2.chal.uiuc.tf:1337</code>. You may need to install socat</p>
</blockquote>
<hr>
<p>Checking the vimrc, we see the same remaps as vimjail1. Plus some additional remaps:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vim" data-lang="vim"><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">a</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">b</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">c</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">d</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">e</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">f</span> <span class="nx">_</span>  
</span></span><span class="line"><span class="cl"><span class="nx">cnoremap</span> <span class="nx">g</span> <span class="nx">_</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>and so on. All special characters and lowercase letters are substituted with <code>_</code>, with the exception of lowercase <code>q</code>. When we enter normal mode through the same method as vimjail1, we find that we are unable to input any commands. However, exiting with :q produces the flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-vim" data-lang="vim"><span class="line"><span class="cl"><span class="nx">E137</span>: <span class="nx">Viminfo</span> <span class="nx">file</span> <span class="nx">is</span> <span class="nx">not</span> <span class="nx">writable</span>: <span class="sr">/home/</span><span class="nx">user</span>/<span class="nx">viminfo</span>  
</span></span><span class="line"><span class="cl"><span class="nx">Press</span> <span class="nx">ENTER</span> <span class="nx">or</span> <span class="nx">type</span> <span class="nx">command</span> <span class="nx">to</span> <span class="nx">continue</span>  
</span></span><span class="line"><span class="cl"><span class="nx">uiuctf</span>{<span class="p">&lt;</span><span class="nx">left</span><span class="p">&gt;&lt;</span><span class="nx">left</span><span class="p">&gt;&lt;</span><span class="nx">left</span><span class="p">&gt;&lt;</span><span class="nx">left</span><span class="p">&gt;</span><span class="nx">_c364201e0d86171b</span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>It feels unintended, and based on the flag name, it looks like the intended solution involved sifting through something using left arrow keystrokes.</p>
<h2 id="osint">OSINT
</h2><p>The OSINT challenges involved a series of exercises related to one another. Though I did not personally solve all of them myself I will cover the related challenges solved by teammates as well.</p>
<h3 id="whats-for-dinner">What&rsquo;s for Dinner?
</h3><blockquote>
<p>Jonah Explorer, world renowned, recently landed in the city of Chicago, so you fly there to try and catch him. He was spotted at a joyful Italian restaurant in West Loop. You miss him narrowly but find out that he uses a well known social network and and loves documenting his travels and reviewing his food. Find his online profile.</p>
</blockquote>
<hr>
<p>With this prompt, we are informed of Jonah enjoying an italian dinner within a small subsection of Chicago. Given this information, I began sifting through all italian restaurants within that zone looking for a recent review or posting by our Jonah. After searching for hours, my fellow colleague managed to find a <a class="link" href="https://www.twitter.com/jonahexplorer"  target="_blank" rel="noopener"
    >twitter account belonging to him</a>. Surprisingly enough, Jonah had zero tweets announcing his dinner or even mentioning the place in Chicago. I still don&rsquo;t know where he ate. His only tweet is one containing the flag.
<code>uiuctf{i_like_spaghetti}</code></p>
<h3 id="finding-jonah">Finding Jonah?
</h3><blockquote>
<p>Jonah offered a reward to whoever can find out what hotel he is staying in. Based on the past information (chals), can you find out what the hotel he stayed at was? Flag should be uiuctf{hotel_name_inn}</p>
</blockquote>
<hr>
<p>Provided image:</p>
<p><img src="/p/uiuctf_2023/images/chicago.jpeg"
	width="4032"
	height="3024"
	srcset="/p/uiuctf_2023/images/chicago_hu8867760377871744853.jpeg 480w, /p/uiuctf_2023/images/chicago_hu18198296667976670140.jpeg 1024w"
	loading="lazy"
	
		alt="chicago.jpeg"
	
	
		class="gallery-image" 
		data-flex-grow="133"
		data-flex-basis="320px"
	
></p>
<p>We can see two rather tall buildings, with the left one having more identifiable features in a curved top shape. <a class="link" href="https://en.wikipedia.org/wiki/List_of_tallest_buildings_in_Chicago"  target="_blank" rel="noopener"
    >Perusing the tallest buildings in chicago</a> we can identify it fairly quickly as <a class="link" href="https://en.wikipedia.org/wiki/River_Point"  target="_blank" rel="noopener"
    >River Point</a>, located at 444 West Lake Street. We know we are looking at a hotel, so from here we can try to guess the hotel location based on the angle of the building, and the relative sizes of the nearby buildings. Eventually we land on a successful guess of <code>uiuctf{hampton_inn}</code>. The inn can be found at <a class="link" href="https://www.google.com/maps/place/Hampton&#43;Inn&#43;%26&#43;Suites&#43;Chicago-Downtown/@41.8903697,-87.6312605,396m/data=!3m1!1e3!4m13!1m3!2m2!1shotel!6e3!3m8!1s0x880e2cb21a4ff293:0xc2dacd58d2f3e1b9!5m2!4m1!1i2!8m2!3d41.8906367!4d-87.6292348!16s%2Fg%2F1vk6zth7!5m1!1e4?entry=ttu"  target="_blank" rel="noopener"
    >this location</a></p>
<h3 id="jonahs-journal">Jonah&rsquo;s Journal
</h3><blockquote>
<p>After dinner, Jonah took notes into an online notebook and pushed his changes there. His usernames have been relatively consistent but what country is he going to next? Flag should be in format uiuctf{country_name}</p>
</blockquote>
<hr>
<p>This challenge is dependent on solving <code>What's For Dinner?</code>, as this one contains the key info of account username. There are several online notetaking services, but the language here is a strong suggestion on where it might be. It states that jonah &ldquo;pushed his changes there&rdquo;. The reference here is likely to a <code>git push</code>, which is the method to submit changes on <code>git</code> based services such as github. Searching here we can see right away, <a class="link" href="https://github.com/jonahexplorer"  target="_blank" rel="noopener"
    >https://github.com/jonahexplorer</a>. There is exactly 1 public repo on this account, and in it he states the following:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">storing all my adventure codes
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">I think that the next place I wanna visit is the great wall of china, but not until I get off of flight UA5040
</span></span></code></pre></td></tr></table>
</div>
</div><p>And so, we have our answer. <code>uiuctf{china}</code>.</p>
<h3 id="first-class-mail">First class mail
</h3><blockquote>
<p>Jonah posted a picture online with random things on a table. Can you find out what zip code he is located in? Flag format should be uiuctf{zipcode}, ex: uiuctf{12345}.</p>
</blockquote>
<hr>
<p>Provided image:</p>
<p><img src="/p/uiuctf_2023/images/chal.jpg"
	width="3024"
	height="4032"
	srcset="/p/uiuctf_2023/images/chal_hu962314130818679427.jpg 480w, /p/uiuctf_2023/images/chal_hu1687258251584232499.jpg 1024w"
	loading="lazy"
	
		alt="chall.jpg"
	
	
		class="gallery-image" 
		data-flex-grow="75"
		data-flex-basis="180px"
	
></p>
<p>The image contains a lot of items, but only a couple stand out as interesting. The first being an insurance letter with the return address in plain sight. Trying <code>uiuctf{16530}</code> did not pass, so this address is not it. The other letter, however, has the mail address hidden but the mail barcode is shown in plain sight. <a class="link" href="https://postalpro.usps.com/mailing/intelligent-mail-barcode"  target="_blank" rel="noopener"
    >Intelligent Mail Barcodes</a> are used by the USPS to sort mail delivery quickly and easily. If we can decode this, we might be able to learn Jonah&rsquo;s zip code. We can convert the barcode using this decoder key, then submitting it to an online decoder tool:</p>
<p><img src="/p/uiuctf_2023/images/decoder_key.png"
	width="435"
	height="194"
	srcset="/p/uiuctf_2023/images/decoder_key_hu15881053902232403787.png 480w, /p/uiuctf_2023/images/decoder_key_hu1192639586211430208.png 1024w"
	loading="lazy"
	
		alt="decoder_key.png"
	
	
		class="gallery-image" 
		data-flex-grow="224"
		data-flex-basis="538px"
	
></p>
<p>Decoding our letter:
<code>FDFFDDFFDDDDFFDDDFFDDDDDFFDDDFFDDDFFDDFDFDDFFDDFDDFF</code></p>
<p>Using <a class="link" href="https://www.dcode.fr/barcode-postnet"  target="_blank" rel="noopener"
    >dcode.fr to decode</a>:</p>
<p><img src="/p/uiuctf_2023/images/decoded.png"
	width="1018"
	height="668"
	srcset="/p/uiuctf_2023/images/decoded_hu6886624712182865936.png 480w, /p/uiuctf_2023/images/decoded_hu6908746106404465087.png 1024w"
	loading="lazy"
	
		alt="decoded.png"
	
	
		class="gallery-image" 
		data-flex-grow="152"
		data-flex-basis="365px"
	
></p>
<p>We see the 9-digit zip as <code>606611234</code>. This is known as ZIP+4, as the last 4 digits are extra specifiers to pinpoint a subsection within a regular ZIP address. The flag is only asking for the zip address with an example of 5 digits, so we submit the ZIP without the +4 appended:
<code>uiuctf{60661}</code>.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/misc/">Misc</a>
        
            <a href="/tags/osint/">OSINT</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/nahamconctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">NahamConCTF_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/n00bzctf_2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">N00bzCTF_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/huntress-ctf-2024/">
        
        
            <div class="article-image">
                <img src="/p/huntress-ctf-2024/HuntressCTF_Banner.6181f047aa18073aac2b72b3a0aa3ba2_hu2497031440356620825.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Huntress CTF 2024"
                        
                        data-hash="md5-YYHwR6oYBzqsK3KzoKo7og==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Huntress CTF 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/hackthebox-cyber-apocalypse-2024/">
        
        
            <div class="article-image">
                <img src="/p/hackthebox-cyber-apocalypse-2024/ca-2024-ctf-background.d1ff26ab7326bd1a79b6d1e0a52f6aa6_hu13886050347455417942.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Cyber Apocalypse: 2024"
                        
                        data-hash="md5-0f8mq3MmvRp5ttHgpS9qpg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Cyber Apocalypse: 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/1337up-ctf/">
        
        

        <div class="article-details">
            <h2 class="article-title">1337UP CTF</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2024 Spencer&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.799eb5847effe83ae252baf7b2236f0c3752b0188dd0985faa7efc75ea805b29.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
